10 - 2 - preconditioning -- 1
2018-06-28 01:38:47.156989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 01:38:47.443714: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x50767f0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 01:38:47.444590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 01:38:47.729210: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x507acd0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 01:38:47.730144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 01:38:47.998595: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x507f1b0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 01:38:47.999481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 01:38:47.999782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 01:38:47.999806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 01:38:47.999841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 01:38:47.999857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 01:38:47.999872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 01:38:47.999886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 01:38:48.000119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 01:38:48.000140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 01:38:48.000233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 01:38:48.000244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 01:38:48.000251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 01:38:48.000257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 01:38:48.000264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 01:38:48.000281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 01:38:48.000289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 01:38:48.000296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 01:38:48.000303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
10 - 2 - preconditioning -- 1
2018-06-28 02:09:47.171948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 02:09:47.431045: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40a81c0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 02:09:47.431882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 02:09:47.693372: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40ac6a0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 02:09:47.694230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 02:09:47.967460: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40d0c10 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 02:09:47.968391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 02:09:47.968720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 02:09:47.968747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 02:09:47.968782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 02:09:47.968796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 02:09:47.968810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 02:09:47.968824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 02:09:47.969068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 02:09:47.969087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 02:09:47.969181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 02:09:47.969192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 02:09:47.969199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 02:09:47.969205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 02:09:47.969210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 02:09:47.969227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 02:09:47.969234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 02:09:47.969240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 02:09:47.969246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3698, test: 2.3723
ACCURACY - train: 0.0999, test: 0.0984
norm of g = 0.8357
Backtracking line search satisfied for alpha = 0.5314
initial gamma = 5.2809
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3394, test: 2.3380
ACCURACY - train: 0.1275, test: 0.1303
norm of g = 0.9429
gamma = 1.2536
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2773, test: 2.2763
ACCURACY - train: 0.1707, test: 0.1716
norm of g = 0.3545
gamma = 0.3692
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.2307, test: 2.2312
ACCURACY - train: 0.1628, test: 0.1670
norm of g = 0.6650
no need for safe gaurding
gamma = 5.5958
weights are updated
------------------------------------------------------------
iteration: 3
LOSS     - train: 1.6903, test: 1.6824
ACCURACY - train: 0.4321, test: 0.4273
norm of g = 5.7916
shrinking trust region radius
no need for safe gaurding
gamma = 1.1138
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.6903, test: 1.6824
ACCURACY - train: 0.4321, test: 0.4273
norm of g = 5.7916
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.6903, test: 1.6824
ACCURACY - train: 0.4321, test: 0.4273
norm of g = 5.7916
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.3091, test: 1.2887
ACCURACY - train: 0.6163, test: 0.6294
norm of g = 2.4806
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.2047, test: 1.1765
ACCURACY - train: 0.6906, test: 0.7100
norm of g = 2.8020
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 0.9942, test: 0.9689
ACCURACY - train: 0.7717, test: 0.7799
norm of g = 1.4443
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.9942, test: 0.9689
ACCURACY - train: 0.7717, test: 0.7799
norm of g = 1.4443
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.9514, test: 0.9248
ACCURACY - train: 0.7759, test: 0.7882
norm of g = 1.1197
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.9152, test: 0.8879
ACCURACY - train: 0.7822, test: 0.7953
norm of g = 1.0151
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.8525, test: 0.8231
ACCURACY - train: 0.7887, test: 0.8032
norm of g = 1.0579
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.7913, test: 0.7617
ACCURACY - train: 0.8002, test: 0.8132
norm of g = 0.9095
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.7298, test: 0.7023
ACCURACY - train: 0.8003, test: 0.8100
norm of g = 2.2161
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6444, test: 0.6137
ACCURACY - train: 0.8149, test: 0.8243
norm of g = 2.2584
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.6444, test: 0.6137
ACCURACY - train: 0.8149, test: 0.8243
norm of g = 2.2584
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.6025, test: 0.5731
ACCURACY - train: 0.8392, test: 0.8474
norm of g = 0.7365
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5873, test: 0.5560
ACCURACY - train: 0.8453, test: 0.8544
norm of g = 0.8914
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5677, test: 0.5379
ACCURACY - train: 0.8462, test: 0.8543
norm of g = 0.6422
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5507, test: 0.5206
ACCURACY - train: 0.8519, test: 0.8603
norm of g = 0.5962
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5282, test: 0.4994
ACCURACY - train: 0.8551, test: 0.8628
norm of g = 1.3060
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4931, test: 0.4635
ACCURACY - train: 0.8662, test: 0.8736
norm of g = 0.7579
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4931, test: 0.4635
ACCURACY - train: 0.8662, test: 0.8736
norm of g = 0.7579
gamma = 0.5271
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4774, test: 0.4485
ACCURACY - train: 0.8686, test: 0.8761
norm of g = 0.5364
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4668, test: 0.4392
ACCURACY - train: 0.8711, test: 0.8791
norm of g = 0.7204
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4527, test: 0.4246
ACCURACY - train: 0.8753, test: 0.8831
norm of g = 0.5081
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4527, test: 0.4246
ACCURACY - train: 0.8753, test: 0.8831
norm of g = 0.5081
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4458, test: 0.4179
ACCURACY - train: 0.8772, test: 0.8840
norm of g = 0.3861
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4365, test: 0.4090
ACCURACY - train: 0.8784, test: 0.8865
norm of g = 0.6118
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4229, test: 0.3954
ACCURACY - train: 0.8822, test: 0.8906
norm of g = 0.3604
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4149, test: 0.3873
ACCURACY - train: 0.8839, test: 0.8942
norm of g = 0.6987
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.4022, test: 0.3765
ACCURACY - train: 0.8877, test: 0.8958
norm of g = 0.3870
gamma = 0.2838
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3946, test: 0.3624
ACCURACY - train: 0.8876, test: 0.8976
norm of g = 0.9997
gamma = 0.2928
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3687, test: 0.3420
ACCURACY - train: 0.8943, test: 0.9042
norm of g = 0.6429
shrinking trust region radius
gamma = 0.1764
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3687, test: 0.3420
ACCURACY - train: 0.8943, test: 0.9042
norm of g = 0.6429
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3633, test: 0.3373
ACCURACY - train: 0.8968, test: 0.9058
norm of g = 0.4629
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3585, test: 0.3327
ACCURACY - train: 0.8985, test: 0.9080
norm of g = 0.3202
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3552, test: 0.3296
ACCURACY - train: 0.8988, test: 0.9081
norm of g = 0.4470
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3502, test: 0.3249
ACCURACY - train: 0.9003, test: 0.9079
norm of g = 0.2622
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3463, test: 0.3212
ACCURACY - train: 0.9016, test: 0.9105
norm of g = 0.3030
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3380, test: 0.3127
ACCURACY - train: 0.9039, test: 0.9117
norm of g = 0.3029
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3319, test: 0.3075
ACCURACY - train: 0.9048, test: 0.9148
norm of g = 0.5745
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3246, test: 0.3014
ACCURACY - train: 0.9067, test: 0.9154
norm of g = 0.5355
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3246, test: 0.3014
ACCURACY - train: 0.9067, test: 0.9154
norm of g = 0.5355
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3216, test: 0.2976
ACCURACY - train: 0.9081, test: 0.9167
norm of g = 0.2700
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3183, test: 0.2939
ACCURACY - train: 0.9092, test: 0.9177
norm of g = 0.3170
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3144, test: 0.2901
ACCURACY - train: 0.9103, test: 0.9187
norm of g = 0.2374
gamma = 0.1269
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3093, test: 0.2861
ACCURACY - train: 0.9106, test: 0.9193
norm of g = 0.4945
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3010, test: 0.2775
ACCURACY - train: 0.9134, test: 0.9235
norm of g = 0.2719
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3010, test: 0.2775
ACCURACY - train: 0.9134, test: 0.9235
norm of g = 0.2719
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2974, test: 0.2744
ACCURACY - train: 0.9147, test: 0.9226
norm of g = 0.2774
shrinking trust region radius
gamma = 0.1539
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2974, test: 0.2744
ACCURACY - train: 0.9147, test: 0.9226
norm of g = 0.2774
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2956, test: 0.2723
ACCURACY - train: 0.9154, test: 0.9240
norm of g = 0.2017
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2923, test: 0.2690
ACCURACY - train: 0.9168, test: 0.9253
norm of g = 0.2265
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2889, test: 0.2656
ACCURACY - train: 0.9176, test: 0.9260
norm of g = 0.2028
gamma = 0.1431
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2859, test: 0.2629
ACCURACY - train: 0.9184, test: 0.9259
norm of g = 0.2788
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2825, test: 0.2596
ACCURACY - train: 0.9194, test: 0.9276
norm of g = 0.1968
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2774, test: 0.2554
ACCURACY - train: 0.9205, test: 0.9272
norm of g = 0.4411
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2702, test: 0.2473
ACCURACY - train: 0.9230, test: 0.9304
norm of g = 0.1964
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2617, test: 0.2423
ACCURACY - train: 0.9254, test: 0.9311
norm of g = 0.5282
expanding trust region radius
gamma = 0.1348
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2498, test: 0.2289
ACCURACY - train: 0.9296, test: 0.9359
norm of g = 0.5019
shrinking trust region radius
gamma = 0.1344
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2498, test: 0.2289
ACCURACY - train: 0.9296, test: 0.9359
norm of g = 0.5019
shrinking trust region radius
gamma = 0.1338
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2498, test: 0.2289
ACCURACY - train: 0.9296, test: 0.9359
norm of g = 0.5019
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2475, test: 0.2267
ACCURACY - train: 0.9296, test: 0.9357
norm of g = 0.2343
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2461, test: 0.2248
ACCURACY - train: 0.9297, test: 0.9374
norm of g = 0.1926
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2450, test: 0.2235
ACCURACY - train: 0.9301, test: 0.9376
norm of g = 0.2243
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2435, test: 0.2223
ACCURACY - train: 0.9303, test: 0.9375
norm of g = 0.1696
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2415, test: 0.2203
ACCURACY - train: 0.9317, test: 0.9380
norm of g = 0.2768
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2385, test: 0.2176
ACCURACY - train: 0.9321, test: 0.9393
norm of g = 0.1589
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2353, test: 0.2129
ACCURACY - train: 0.9321, test: 0.9396
norm of g = 0.4471
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2289, test: 0.2084
ACCURACY - train: 0.9346, test: 0.9420
norm of g = 0.2173
shrinking trust region radius
gamma = 0.0996
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2289, test: 0.2084
ACCURACY - train: 0.9346, test: 0.9420
norm of g = 0.2173
expanding trust region radius
gamma = 0.1008
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2264, test: 0.2058
ACCURACY - train: 0.9355, test: 0.9426
norm of g = 0.1717
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2264, test: 0.2058
ACCURACY - train: 0.9355, test: 0.9426
norm of g = 0.1717
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2252, test: 0.2048
ACCURACY - train: 0.9359, test: 0.9432
norm of g = 0.1735
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2235, test: 0.2030
ACCURACY - train: 0.9364, test: 0.9422
norm of g = 0.3489
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2206, test: 0.2004
ACCURACY - train: 0.9370, test: 0.9439
norm of g = 0.1631
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2188, test: 0.1984
ACCURACY - train: 0.9375, test: 0.9455
norm of g = 0.5230
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2123, test: 0.1929
ACCURACY - train: 0.9397, test: 0.9458
norm of g = 0.2568
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2123, test: 0.1929
ACCURACY - train: 0.9397, test: 0.9458
norm of g = 0.2568
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2109, test: 0.1913
ACCURACY - train: 0.9395, test: 0.9464
norm of g = 0.1403
expanding trust region radius
gamma = 0.0761
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2099, test: 0.1903
ACCURACY - train: 0.9404, test: 0.9469
norm of g = 0.1539
gamma = 0.0839
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2077, test: 0.1880
ACCURACY - train: 0.9405, test: 0.9478
norm of g = 0.1481
expanding trust region radius
gamma = 0.0713
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2057, test: 0.1865
ACCURACY - train: 0.9409, test: 0.9477
norm of g = 0.2093
gamma = 0.0718
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2016, test: 0.1821
ACCURACY - train: 0.9423, test: 0.9490
norm of g = 0.2666
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2016, test: 0.1821
ACCURACY - train: 0.9423, test: 0.9490
norm of g = 0.2666
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2002, test: 0.1811
ACCURACY - train: 0.9428, test: 0.9496
norm of g = 0.1314
expanding trust region radius
gamma = 0.0743
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1992, test: 0.1803
ACCURACY - train: 0.9431, test: 0.9497
norm of g = 0.1405
gamma = 0.0757
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1973, test: 0.1782
ACCURACY - train: 0.9435, test: 0.9501
norm of g = 0.1924
gamma = 0.0753
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.1960, test: 0.1767
ACCURACY - train: 0.9442, test: 0.9495
norm of g = 0.3626
gamma = 0.0750
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.1943, test: 0.1759
ACCURACY - train: 0.9445, test: 0.9509
norm of g = 0.3793
shrinking trust region radius
gamma = 0.0750
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1943, test: 0.1759
ACCURACY - train: 0.9445, test: 0.9509
norm of g = 0.3793
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1933, test: 0.1746
ACCURACY - train: 0.9447, test: 0.9506
norm of g = 0.1740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.1927, test: 0.1741
ACCURACY - train: 0.9450, test: 0.9510
norm of g = 0.1219
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.1922, test: 0.1735
ACCURACY - train: 0.9450, test: 0.9514
norm of g = 0.1168
no need for safe gaurding
gamma = 2.3605
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.1912, test: 0.1727
ACCURACY - train: 0.9453, test: 0.9515
norm of g = 0.1166
no need for safe gaurding
gamma = 5.2156
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1902, test: 0.1717
ACCURACY - train: 0.9457, test: 0.9518
norm of g = 0.1143
expanding trust region radius
no need for safe gaurding
gamma = 7.8064
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1892, test: 0.1707
ACCURACY - train: 0.9460, test: 0.9518
norm of g = 0.1136
expanding trust region radius
no need for safe gaurding
gamma = 6.5323
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.1872, test: 0.1690
ACCURACY - train: 0.9465, test: 0.9525
norm of g = 0.1156
expanding trust region radius
no need for safe gaurding
gamma = 4.7489
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.1834, test: 0.1651
ACCURACY - train: 0.9477, test: 0.9548
norm of g = 0.1310
expanding trust region radius
gamma = 0.0695
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.1763, test: 0.1586
ACCURACY - train: 0.9500, test: 0.9548
norm of g = 0.2268
gamma = 0.0694
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.1709, test: 0.1572
ACCURACY - train: 0.9509, test: 0.9550
norm of g = 0.9682
shrinking trust region radius
gamma = 0.0692
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.1709, test: 0.1572
ACCURACY - train: 0.9509, test: 0.9550
norm of g = 0.9682
shrinking trust region radius
gamma = 0.0688
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.1709, test: 0.1572
ACCURACY - train: 0.9509, test: 0.9550
norm of g = 0.9682
gamma = 0.0700
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1647, test: 0.1501
ACCURACY - train: 0.9531, test: 0.9578
norm of g = 0.4848
gamma = 0.0703
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.1622, test: 0.1464
ACCURACY - train: 0.9537, test: 0.9594
norm of g = 0.2264
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.1622, test: 0.1464
ACCURACY - train: 0.9537, test: 0.9594
norm of g = 0.2264
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.1618, test: 0.1458
ACCURACY - train: 0.9540, test: 0.9601
norm of g = 0.1507
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1613, test: 0.1450
ACCURACY - train: 0.9538, test: 0.9598
norm of g = 0.1054
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1609, test: 0.1445
ACCURACY - train: 0.9541, test: 0.9605
norm of g = 0.0973
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1601, test: 0.1434
ACCURACY - train: 0.9539, test: 0.9605
norm of g = 0.1076
no need for safe gaurding
gamma = 1.2604
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1585, test: 0.1423
ACCURACY - train: 0.9546, test: 0.9609
norm of g = 0.1184
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1570, test: 0.1411
ACCURACY - train: 0.9548, test: 0.9604
norm of g = 0.1520
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.1560, test: 0.1402
ACCURACY - train: 0.9558, test: 0.9609
norm of g = 0.3091
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.1552, test: 0.1392
ACCURACY - train: 0.9557, test: 0.9610
norm of g = 0.3575
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1542, test: 0.1376
ACCURACY - train: 0.9552, test: 0.9619
norm of g = 0.3284
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.1530, test: 0.1381
ACCURACY - train: 0.9569, test: 0.9614
norm of g = 0.3222
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1530, test: 0.1381
ACCURACY - train: 0.9569, test: 0.9614
norm of g = 0.3222
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1520, test: 0.1368
ACCURACY - train: 0.9569, test: 0.9618
norm of g = 0.1629
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1515, test: 0.1359
ACCURACY - train: 0.9570, test: 0.9617
norm of g = 0.1032
expanding trust region radius
gamma = 0.0510
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1508, test: 0.1351
ACCURACY - train: 0.9570, test: 0.9623
norm of g = 0.1132
gamma = 0.0499
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1497, test: 0.1339
ACCURACY - train: 0.9573, test: 0.9626
norm of g = 0.2104
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.1485, test: 0.1329
ACCURACY - train: 0.9577, test: 0.9623
norm of g = 0.2772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1470, test: 0.1320
ACCURACY - train: 0.9579, test: 0.9627
norm of g = 0.2221
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1470, test: 0.1320
ACCURACY - train: 0.9579, test: 0.9627
norm of g = 0.2221
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1464, test: 0.1313
ACCURACY - train: 0.9583, test: 0.9627
norm of g = 0.1048
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1458, test: 0.1301
ACCURACY - train: 0.9584, test: 0.9636
norm of g = 0.1727
gamma = 0.0500
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1450, test: 0.1296
ACCURACY - train: 0.9588, test: 0.9637
norm of g = 0.1042
gamma = 0.0477
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1445, test: 0.1297
ACCURACY - train: 0.9587, test: 0.9631
norm of g = 0.1850
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1437, test: 0.1289
ACCURACY - train: 0.9590, test: 0.9635
norm of g = 0.1053
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1432, test: 0.1277
ACCURACY - train: 0.9591, test: 0.9642
norm of g = 0.1527
gamma = 0.0445
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1424, test: 0.1272
ACCURACY - train: 0.9593, test: 0.9646
norm of g = 0.1133
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1421, test: 0.1275
ACCURACY - train: 0.9594, test: 0.9647
norm of g = 0.1878
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1412, test: 0.1266
ACCURACY - train: 0.9598, test: 0.9644
norm of g = 0.0909
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1406, test: 0.1254
ACCURACY - train: 0.9597, test: 0.9655
norm of g = 0.1255
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.1399, test: 0.1248
ACCURACY - train: 0.9599, test: 0.9651
norm of g = 0.0988
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1392, test: 0.1256
ACCURACY - train: 0.9603, test: 0.9651
norm of g = 0.2384
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1375, test: 0.1235
ACCURACY - train: 0.9607, test: 0.9653
norm of g = 0.1280
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1375, test: 0.1235
ACCURACY - train: 0.9608, test: 0.9653
norm of g = 0.1280
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1370, test: 0.1228
ACCURACY - train: 0.9610, test: 0.9654
norm of g = 0.0877
expanding trust region radius
gamma = 0.0473
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1367, test: 0.1223
ACCURACY - train: 0.9611, test: 0.9656
norm of g = 0.0870
expanding trust region radius
gamma = 0.0468
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1361, test: 0.1215
ACCURACY - train: 0.9613, test: 0.9661
norm of g = 0.1181
gamma = 0.0468
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1352, test: 0.1208
ACCURACY - train: 0.9613, test: 0.9659
norm of g = 0.2262
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1338, test: 0.1201
ACCURACY - train: 0.9618, test: 0.9658
norm of g = 0.1490
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1338, test: 0.1201
ACCURACY - train: 0.9618, test: 0.9658
norm of g = 0.1490
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1333, test: 0.1193
ACCURACY - train: 0.9619, test: 0.9661
norm of g = 0.0867
expanding trust region radius
no need for safe gaurding
gamma = 1.0697
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1327, test: 0.1186
ACCURACY - train: 0.9621, test: 0.9661
norm of g = 0.0792
gamma = 0.0450
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1316, test: 0.1175
ACCURACY - train: 0.9620, test: 0.9672
norm of g = 0.1560
expanding trust region radius
gamma = 0.0460
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1303, test: 0.1159
ACCURACY - train: 0.9626, test: 0.9672
norm of g = 0.1420
shrinking trust region radius
gamma = 0.0448
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1303, test: 0.1159
ACCURACY - train: 0.9626, test: 0.9672
norm of g = 0.1420
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1300, test: 0.1160
ACCURACY - train: 0.9628, test: 0.9674
norm of g = 0.2260
gamma = 0.0422
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1291, test: 0.1153
ACCURACY - train: 0.9630, test: 0.9670
norm of g = 0.0882
gamma = 0.0415
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1288, test: 0.1150
ACCURACY - train: 0.9631, test: 0.9669
norm of g = 0.1667
gamma = 0.0418
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1281, test: 0.1144
ACCURACY - train: 0.9631, test: 0.9673
norm of g = 0.1428
shrinking trust region radius
gamma = 0.0418
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1281, test: 0.1144
ACCURACY - train: 0.9631, test: 0.9673
norm of g = 0.1428
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1278, test: 0.1142
ACCURACY - train: 0.9632, test: 0.9675
norm of g = 0.0818
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1275, test: 0.1140
ACCURACY - train: 0.9634, test: 0.9674
norm of g = 0.0780
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1270, test: 0.1132
ACCURACY - train: 0.9635, test: 0.9679
norm of g = 0.1017
no need for safe gaurding
gamma = 2.0712
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1257, test: 0.1122
ACCURACY - train: 0.9639, test: 0.9678
norm of g = 0.0769
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1248, test: 0.1116
ACCURACY - train: 0.9638, test: 0.9678
norm of g = 0.1508
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1234, test: 0.1105
ACCURACY - train: 0.9646, test: 0.9684
norm of g = 0.0867
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1234, test: 0.1105
ACCURACY - train: 0.9646, test: 0.9684
norm of g = 0.0867
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1228, test: 0.1095
ACCURACY - train: 0.9647, test: 0.9691
norm of g = 0.0757
gamma = 0.0392
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1219, test: 0.1088
ACCURACY - train: 0.9651, test: 0.9685
norm of g = 0.1833
expanding trust region radius
gamma = 0.0405
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1208, test: 0.1081
ACCURACY - train: 0.9652, test: 0.9692
norm of g = 0.1840
shrinking trust region radius
gamma = 0.0401
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1208, test: 0.1081
ACCURACY - train: 0.9652, test: 0.9692
norm of g = 0.1840
gamma = 0.0401
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1204, test: 0.1070
ACCURACY - train: 0.9652, test: 0.9693
norm of g = 0.1840
shrinking trust region radius
gamma = 0.0343
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1204, test: 0.1070
ACCURACY - train: 0.9652, test: 0.9693
norm of g = 0.1840
expanding trust region radius
gamma = 0.0372
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1201, test: 0.1071
ACCURACY - train: 0.9654, test: 0.9695
norm of g = 0.1047
gamma = 0.0380
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.1198, test: 0.1068
ACCURACY - train: 0.9656, test: 0.9697
norm of g = 0.0871
gamma = 0.0373
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1196, test: 0.1069
ACCURACY - train: 0.9657, test: 0.9692
norm of g = 0.0979
gamma = 0.0372
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1193, test: 0.1066
ACCURACY - train: 0.9655, test: 0.9695
norm of g = 0.1007
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.1191, test: 0.1061
ACCURACY - train: 0.9657, test: 0.9702
norm of g = 0.0985
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.1188, test: 0.1059
ACCURACY - train: 0.9659, test: 0.9700
norm of g = 0.0665
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1182, test: 0.1057
ACCURACY - train: 0.9660, test: 0.9699
norm of g = 0.0850
expanding trust region radius
gamma = 0.0366
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1176, test: 0.1051
ACCURACY - train: 0.9661, test: 0.9705
norm of g = 0.0668
gamma = 0.0364
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1168, test: 0.1041
ACCURACY - train: 0.9664, test: 0.9706
norm of g = 0.1631
expanding trust region radius
gamma = 0.0363
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1156, test: 0.1026
ACCURACY - train: 0.9667, test: 0.9707
norm of g = 0.1395
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1156, test: 0.1026
ACCURACY - train: 0.9667, test: 0.9707
norm of g = 0.1395
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1151, test: 0.1027
ACCURACY - train: 0.9669, test: 0.9703
norm of g = 0.1361
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1151, test: 0.1027
ACCURACY - train: 0.9669, test: 0.9703
norm of g = 0.1361
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1149, test: 0.1025
ACCURACY - train: 0.9670, test: 0.9714
norm of g = 0.0758
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1146, test: 0.1022
ACCURACY - train: 0.9668, test: 0.9716
norm of g = 0.0860
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1142, test: 0.1019
ACCURACY - train: 0.9672, test: 0.9712
norm of g = 0.1096
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1131, test: 0.1012
ACCURACY - train: 0.9677, test: 0.9713
norm of g = 0.0836
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1120, test: 0.0982
ACCURACY - train: 0.9676, test: 0.9716
norm of g = 0.2810
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1093, test: 0.0976
ACCURACY - train: 0.9686, test: 0.9722
norm of g = 0.1679
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1093, test: 0.0976
ACCURACY - train: 0.9686, test: 0.9722
norm of g = 0.1679
gamma = 0.0379
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1086, test: 0.0974
ACCURACY - train: 0.9687, test: 0.9724
norm of g = 0.1843
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1086, test: 0.0974
ACCURACY - train: 0.9687, test: 0.9724
norm of g = 0.1843
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1080, test: 0.0966
ACCURACY - train: 0.9691, test: 0.9724
norm of g = 0.0937
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1079, test: 0.0960
ACCURACY - train: 0.9690, test: 0.9722
norm of g = 0.1171
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1076, test: 0.0960
ACCURACY - train: 0.9692, test: 0.9720
norm of g = 0.0831
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1074, test: 0.0958
ACCURACY - train: 0.9690, test: 0.9728
norm of g = 0.1041
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1071, test: 0.0955
ACCURACY - train: 0.9693, test: 0.9727
norm of g = 0.0662
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1069, test: 0.0953
ACCURACY - train: 0.9693, test: 0.9724
norm of g = 0.0808
expanding trust region radius
no need for safe gaurding
gamma = 1.0251
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1064, test: 0.0949
ACCURACY - train: 0.9695, test: 0.9726
norm of g = 0.0635
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1058, test: 0.0945
ACCURACY - train: 0.9692, test: 0.9733
norm of g = 0.1880
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1046, test: 0.0932
ACCURACY - train: 0.9699, test: 0.9732
norm of g = 0.1016
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1046, test: 0.0932
ACCURACY - train: 0.9699, test: 0.9732
norm of g = 0.1016
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1041, test: 0.0930
ACCURACY - train: 0.9701, test: 0.9731
norm of g = 0.0748
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1041, test: 0.0930
ACCURACY - train: 0.9701, test: 0.9731
norm of g = 0.0748
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1038, test: 0.0926
ACCURACY - train: 0.9701, test: 0.9733
norm of g = 0.0603
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1035, test: 0.0923
ACCURACY - train: 0.9701, test: 0.9733
norm of g = 0.1096
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1029, test: 0.0918
ACCURACY - train: 0.9703, test: 0.9736
norm of g = 0.0567
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1023, test: 0.0914
ACCURACY - train: 0.9705, test: 0.9738
norm of g = 0.1941
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1011, test: 0.0903
ACCURACY - train: 0.9709, test: 0.9743
norm of g = 0.0636
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1011, test: 0.0903
ACCURACY - train: 0.9709, test: 0.9743
norm of g = 0.0636
no need for safe gaurding
gamma = 2.2046
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1006, test: 0.0898
ACCURACY - train: 0.9712, test: 0.9744
norm of g = 0.0547
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1002, test: 0.0893
ACCURACY - train: 0.9712, test: 0.9739
norm of g = 0.0951
expanding trust region radius
gamma = 0.0299
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0997, test: 0.0890
ACCURACY - train: 0.9712, test: 0.9744
norm of g = 0.0571
shrinking trust region radius
gamma = 0.0288
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0997, test: 0.0890
ACCURACY - train: 0.9712, test: 0.9744
norm of g = 0.0571
expanding trust region radius
gamma = 0.0281
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0995, test: 0.0888
ACCURACY - train: 0.9715, test: 0.9744
norm of g = 0.0521
no need for safe gaurding
gamma = 3.2696
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0991, test: 0.0883
ACCURACY - train: 0.9716, test: 0.9744
norm of g = 0.0573
no need for safe gaurding
gamma = 2.6828
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0986, test: 0.0880
ACCURACY - train: 0.9717, test: 0.9744
norm of g = 0.0553
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0982, test: 0.0877
ACCURACY - train: 0.9718, test: 0.9747
norm of g = 0.0703
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0977, test: 0.0872
ACCURACY - train: 0.9719, test: 0.9751
norm of g = 0.0641
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0975, test: 0.0870
ACCURACY - train: 0.9719, test: 0.9744
norm of g = 0.2498
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0963, test: 0.0862
ACCURACY - train: 0.9723, test: 0.9747
norm of g = 0.1481
shrinking trust region radius
gamma = 0.0188
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0963, test: 0.0862
ACCURACY - train: 0.9723, test: 0.9747
norm of g = 0.1481
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0961, test: 0.0859
ACCURACY - train: 0.9725, test: 0.9749
norm of g = 0.1416
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0958, test: 0.0855
ACCURACY - train: 0.9725, test: 0.9752
norm of g = 0.0634
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0958, test: 0.0855
ACCURACY - train: 0.9725, test: 0.9752
norm of g = 0.0634
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0956, test: 0.0854
ACCURACY - train: 0.9724, test: 0.9753
norm of g = 0.0517
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0954, test: 0.0852
ACCURACY - train: 0.9724, test: 0.9752
norm of g = 0.0537
no need for safe gaurding
gamma = 1.7107
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0950, test: 0.0849
ACCURACY - train: 0.9726, test: 0.9753
norm of g = 0.0558
no need for safe gaurding
gamma = 2.1230
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0946, test: 0.0845
ACCURACY - train: 0.9728, test: 0.9752
norm of g = 0.0547
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0942, test: 0.0841
ACCURACY - train: 0.9728, test: 0.9752
norm of g = 0.0706
no need for safe gaurding
gamma = 2.1002
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0934, test: 0.0835
ACCURACY - train: 0.9731, test: 0.9753
norm of g = 0.0769
gamma = 0.0285
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0928, test: 0.0830
ACCURACY - train: 0.9734, test: 0.9756
norm of g = 0.1649
gamma = 0.0281
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0919, test: 0.0820
ACCURACY - train: 0.9735, test: 0.9754
norm of g = 0.1225
shrinking trust region radius
gamma = 0.0277
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0919, test: 0.0820
ACCURACY - train: 0.9735, test: 0.9754
norm of g = 0.1225
expanding trust region radius
gamma = 0.0268
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0916, test: 0.0819
ACCURACY - train: 0.9736, test: 0.9753
norm of g = 0.0704
shrinking trust region radius
gamma = 0.0276
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0916, test: 0.0819
ACCURACY - train: 0.9736, test: 0.9753
norm of g = 0.0704
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0915, test: 0.0818
ACCURACY - train: 0.9735, test: 0.9757
norm of g = 0.0582
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0914, test: 0.0818
ACCURACY - train: 0.9736, test: 0.9754
norm of g = 0.0636
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0913, test: 0.0816
ACCURACY - train: 0.9736, test: 0.9757
norm of g = 0.0476
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0911, test: 0.0815
ACCURACY - train: 0.9737, test: 0.9756
norm of g = 0.0506
no need for safe gaurding
gamma = 1.9155
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0909, test: 0.0813
ACCURACY - train: 0.9737, test: 0.9756
norm of g = 0.0471
no need for safe gaurding
gamma = 1.1520
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0907, test: 0.0811
ACCURACY - train: 0.9738, test: 0.9756
norm of g = 0.0488
no need for safe gaurding
gamma = 3.4950
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0905, test: 0.0809
ACCURACY - train: 0.9739, test: 0.9757
norm of g = 0.0462
expanding trust region radius
no need for safe gaurding
gamma = 4.1611
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0903, test: 0.0808
ACCURACY - train: 0.9740, test: 0.9756
norm of g = 0.0467
expanding trust region radius
no need for safe gaurding
gamma = 14.4535
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0899, test: 0.0804
ACCURACY - train: 0.9740, test: 0.9756
norm of g = 0.0460
expanding trust region radius
no need for safe gaurding
gamma = 26.8313
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0891, test: 0.0797
ACCURACY - train: 0.9744, test: 0.9758
norm of g = 0.0454
expanding trust region radius
no need for safe gaurding
gamma = 30.9712
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0875, test: 0.0784
ACCURACY - train: 0.9749, test: 0.9763
norm of g = 0.0443
no need for safe gaurding
gamma = 33.2935
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0845, test: 0.0758
ACCURACY - train: 0.9757, test: 0.9772
norm of g = 0.0431
expanding trust region radius
no need for safe gaurding
gamma = 31.7576
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0817, test: 0.0734
ACCURACY - train: 0.9765, test: 0.9780
norm of g = 0.0421
no need for safe gaurding
gamma = 30.9360
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0764, test: 0.0690
ACCURACY - train: 0.9780, test: 0.9796
norm of g = 0.0448
expanding trust region radius
no need for safe gaurding
gamma = 28.7311
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0717, test: 0.0651
ACCURACY - train: 0.9789, test: 0.9801
norm of g = 0.0492
no need for safe gaurding
gamma = 29.4887
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0643, test: 0.0589
ACCURACY - train: 0.9810, test: 0.9810
norm of g = 0.0766
no need for safe gaurding
gamma = 26.3558
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0594, test: 0.0548
ACCURACY - train: 0.9822, test: 0.9818
norm of g = 0.1046
expanding trust region radius
no need for safe gaurding
gamma = 21.9679
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0571, test: 0.0538
ACCURACY - train: 0.9832, test: 0.9828
norm of g = 0.1663
no need for safe gaurding
gamma = 9.6693
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0567, test: 0.0528
ACCURACY - train: 0.9830, test: 0.9828
norm of g = 0.2077
gamma = 0.0246
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0561, test: 0.0527
ACCURACY - train: 0.9833, test: 0.9825
norm of g = 0.2638
shrinking trust region radius
gamma = 0.0214
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0561, test: 0.0527
ACCURACY - train: 0.9833, test: 0.9825
norm of g = 0.2638
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0561, test: 0.0527
ACCURACY - train: 0.9833, test: 0.9825
norm of g = 0.2638
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0544, test: 0.0520
ACCURACY - train: 0.9835, test: 0.9826
norm of g = 0.2778
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0544, test: 0.0520
ACCURACY - train: 0.9835, test: 0.9826
norm of g = 0.2778
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0534, test: 0.0503
ACCURACY - train: 0.9840, test: 0.9834
norm of g = 0.1017
gamma = 0.0019
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0532, test: 0.0507
ACCURACY - train: 0.9839, test: 0.9830
norm of g = 0.1531
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0532, test: 0.0507
ACCURACY - train: 0.9839, test: 0.9830
norm of g = 0.1531
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0529, test: 0.0501
ACCURACY - train: 0.9839, test: 0.9830
norm of g = 0.0787
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0528, test: 0.0498
ACCURACY - train: 0.9839, test: 0.9835
norm of g = 0.0515
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0526, test: 0.0495
ACCURACY - train: 0.9840, test: 0.9834
norm of g = 0.0466
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0523, test: 0.0493
ACCURACY - train: 0.9841, test: 0.9841
norm of g = 0.0798
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0518, test: 0.0492
ACCURACY - train: 0.9842, test: 0.9827
norm of g = 0.1446
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0518, test: 0.0492
ACCURACY - train: 0.9842, test: 0.9827
norm of g = 0.1446
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0516, test: 0.0489
ACCURACY - train: 0.9842, test: 0.9838
norm of g = 0.0978
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0516, test: 0.0489
ACCURACY - train: 0.9842, test: 0.9838
norm of g = 0.0978
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0515, test: 0.0487
ACCURACY - train: 0.9843, test: 0.9835
norm of g = 0.0546
expanding trust region radius
gamma = 0.1893
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0514, test: 0.0487
ACCURACY - train: 0.9843, test: 0.9835
norm of g = 0.0384
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0514, test: 0.0486
ACCURACY - train: 0.9843, test: 0.9832
norm of g = 0.0395
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0512, test: 0.0485
ACCURACY - train: 0.9842, test: 0.9832
norm of g = 0.0392
expanding trust region radius
gamma = 0.1174
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0510, test: 0.0483
ACCURACY - train: 0.9844, test: 0.9840
norm of g = 0.0747
gamma = 0.0896
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0505, test: 0.0481
ACCURACY - train: 0.9843, test: 0.9834
norm of g = 0.1122
shrinking trust region radius
gamma = 0.0790
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0505, test: 0.0481
ACCURACY - train: 0.9843, test: 0.9834
norm of g = 0.1122
gamma = 0.1320
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0504, test: 0.0476
ACCURACY - train: 0.9845, test: 0.9840
norm of g = 0.0813
gamma = 0.0885
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0503, test: 0.0481
ACCURACY - train: 0.9845, test: 0.9832
norm of g = 0.0614
shrinking trust region radius
gamma = 0.0865
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0503, test: 0.0481
ACCURACY - train: 0.9845, test: 0.9832
norm of g = 0.0614
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0502, test: 0.0479
ACCURACY - train: 0.9845, test: 0.9835
norm of g = 0.0395
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0501, test: 0.0477
ACCURACY - train: 0.9846, test: 0.9840
norm of g = 0.0309
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0501, test: 0.0476
ACCURACY - train: 0.9846, test: 0.9838
norm of g = 0.0318
expanding trust region radius
no need for safe gaurding
gamma = 2.8815
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0500, test: 0.0475
ACCURACY - train: 0.9847, test: 0.9841
norm of g = 0.0288
no need for safe gaurding
gamma = 1.9460
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0497, test: 0.0474
ACCURACY - train: 0.9847, test: 0.9836
norm of g = 0.0433
no need for safe gaurding
gamma = 1.8137
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0495, test: 0.0472
ACCURACY - train: 0.9847, test: 0.9841
norm of g = 0.0309
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0493, test: 0.0469
ACCURACY - train: 0.9849, test: 0.9839
norm of g = 0.0518
no need for safe gaurding
gamma = 1.7519
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0488, test: 0.0465
ACCURACY - train: 0.9850, test: 0.9836
norm of g = 0.0656
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0488, test: 0.0465
ACCURACY - train: 0.9850, test: 0.9836
norm of g = 0.0656
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0487, test: 0.0467
ACCURACY - train: 0.9850, test: 0.9838
norm of g = 0.0397
gamma = 0.0296
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0487, test: 0.0465
ACCURACY - train: 0.9849, test: 0.9841
norm of g = 0.0828
gamma = 0.0292
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0486, test: 0.0465
ACCURACY - train: 0.9849, test: 0.9836
norm of g = 0.0799
shrinking trust region radius
gamma = 0.0418
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0485, test: 0.0463
ACCURACY - train: 0.9850, test: 0.9838
norm of g = 0.0921
gamma = 0.0407
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0485, test: 0.0464
ACCURACY - train: 0.9851, test: 0.9841
norm of g = 0.0488
expanding trust region radius
gamma = 0.0353
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0484, test: 0.0464
ACCURACY - train: 0.9851, test: 0.9841
norm of g = 0.0311
gamma = 0.0335
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0484, test: 0.0465
ACCURACY - train: 0.9851, test: 0.9843
norm of g = 0.0543
gamma = 0.0198
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0483, test: 0.0464
ACCURACY - train: 0.9850, test: 0.9841
norm of g = 0.0326
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0483, test: 0.0462
ACCURACY - train: 0.9852, test: 0.9839
norm of g = 0.0490
gamma = 0.0312
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0482, test: 0.0463
ACCURACY - train: 0.9852, test: 0.9839
norm of g = 0.0263
expanding trust region radius
gamma = 0.0298
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0482, test: 0.0462
ACCURACY - train: 0.9851, test: 0.9841
norm of g = 0.0284
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0481, test: 0.0462
ACCURACY - train: 0.9850, test: 0.9839
norm of g = 0.0348
reached to the max num iteration -- BREAK
10 - 5 - preconditioning -- 1
2018-06-28 03:45:28.502157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 03:45:28.782671: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40b5690 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 03:45:28.783804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 03:45:29.085838: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40b9b70 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 03:45:29.086739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 03:45:29.377830: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x40be050 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 03:45:29.378753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 03:45:29.379054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 03:45:29.379078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 03:45:29.379110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 03:45:29.379125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 03:45:29.379139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 03:45:29.379151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 03:45:29.379410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 03:45:29.379431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 03:45:29.379525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 03:45:29.379535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 03:45:29.379542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 03:45:29.379548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 03:45:29.379560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 03:45:29.379577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 03:45:29.379585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 03:45:29.379592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 03:45:29.379598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3851, test: 2.3873
ACCURACY - train: 0.1127, test: 0.1142
norm of g = 0.8845
Backtracking line search satisfied for alpha = 0.5905
initial gamma = 4.6864
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3456, test: 2.3424
ACCURACY - train: 0.0974, test: 0.0973
norm of g = 0.9843
gamma = 1.4131
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2810, test: 2.2792
ACCURACY - train: 0.1718, test: 0.1781
norm of g = 0.3443
gamma = 0.3710
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.2394, test: 2.2380
ACCURACY - train: 0.1501, test: 0.1484
norm of g = 0.5505
shrinking trust region radius
gamma = 0.1467
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.2394, test: 2.2380
ACCURACY - train: 0.1501, test: 0.1484
norm of g = 0.5505
no need for safe gaurding
gamma = 2.8969
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 2.0848, test: 2.0813
ACCURACY - train: 0.4537, test: 0.4590
norm of g = 1.0845
curvature condition did satisfy -- (s,y) was not added
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.7852, test: 1.7723
ACCURACY - train: 0.5372, test: 0.5450
norm of g = 1.6277
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.7852, test: 1.7723
ACCURACY - train: 0.5372, test: 0.5450
norm of g = 1.6277
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.6205, test: 1.6036
ACCURACY - train: 0.6591, test: 0.6769
norm of g = 1.2416
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.4651, test: 1.4450
ACCURACY - train: 0.7013, test: 0.7138
norm of g = 1.1843
no need for safe gaurding
gamma = 1.0452
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.3101, test: 1.2872
ACCURACY - train: 0.7131, test: 0.7207
norm of g = 1.1788
no need for safe gaurding
gamma = 1.0701
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 1.1525, test: 1.1325
ACCURACY - train: 0.7627, test: 0.7718
norm of g = 1.1129
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 1.0183, test: 0.9889
ACCURACY - train: 0.7676, test: 0.7857
norm of g = 1.0269
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.8107, test: 0.7814
ACCURACY - train: 0.7732, test: 0.7843
norm of g = 1.7766
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.7155, test: 0.6827
ACCURACY - train: 0.7733, test: 0.7907
norm of g = 3.1025
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.7155, test: 0.6827
ACCURACY - train: 0.7733, test: 0.7907
norm of g = 3.1025
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6256, test: 0.5928
ACCURACY - train: 0.8220, test: 0.8367
norm of g = 0.9771
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.5936, test: 0.5638
ACCURACY - train: 0.8382, test: 0.8533
norm of g = 1.0852
gamma = 0.1045
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.5698, test: 0.5397
ACCURACY - train: 0.8365, test: 0.8514
norm of g = 1.1459
shrinking trust region radius
gamma = 0.2059
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5698, test: 0.5397
ACCURACY - train: 0.8365, test: 0.8514
norm of g = 1.1459
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5567, test: 0.5246
ACCURACY - train: 0.8455, test: 0.8599
norm of g = 0.6831
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5468, test: 0.5155
ACCURACY - train: 0.8492, test: 0.8618
norm of g = 0.5153
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5430, test: 0.5077
ACCURACY - train: 0.8494, test: 0.8628
norm of g = 0.4528
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.5188, test: 0.4937
ACCURACY - train: 0.8595, test: 0.8666
norm of g = 0.4373
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4945, test: 0.4662
ACCURACY - train: 0.8657, test: 0.8748
norm of g = 0.4778
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4758, test: 0.4457
ACCURACY - train: 0.8677, test: 0.8802
norm of g = 0.6744
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4503, test: 0.4206
ACCURACY - train: 0.8730, test: 0.8861
norm of g = 0.5359
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4503, test: 0.4206
ACCURACY - train: 0.8730, test: 0.8861
norm of g = 0.5359
gamma = 0.2490
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4431, test: 0.4105
ACCURACY - train: 0.8750, test: 0.8892
norm of g = 0.4910
shrinking trust region radius
gamma = 0.2868
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4431, test: 0.4105
ACCURACY - train: 0.8750, test: 0.8892
norm of g = 0.4910
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4305, test: 0.4069
ACCURACY - train: 0.8806, test: 0.8918
norm of g = 0.3750
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4300, test: 0.4042
ACCURACY - train: 0.8817, test: 0.8919
norm of g = 0.3280
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4285, test: 0.3990
ACCURACY - train: 0.8820, test: 0.8934
norm of g = 0.3157
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.4219, test: 0.3939
ACCURACY - train: 0.8812, test: 0.8949
norm of g = 0.3266
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.4210, test: 0.3889
ACCURACY - train: 0.8806, test: 0.8959
norm of g = 0.3188
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.4030, test: 0.3798
ACCURACY - train: 0.8892, test: 0.8982
norm of g = 0.4781
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3954, test: 0.3717
ACCURACY - train: 0.8914, test: 0.9000
norm of g = 0.3609
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3855, test: 0.3559
ACCURACY - train: 0.8923, test: 0.9044
norm of g = 0.6722
gamma = 0.2742
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3577, test: 0.3309
ACCURACY - train: 0.8951, test: 0.9052
norm of g = 0.9075
shrinking trust region radius
gamma = 0.2601
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3577, test: 0.3309
ACCURACY - train: 0.8951, test: 0.9052
norm of g = 0.9075
gamma = 0.2645
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3540, test: 0.3228
ACCURACY - train: 0.8977, test: 0.9107
norm of g = 0.8462
gamma = 0.2652
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3412, test: 0.3214
ACCURACY - train: 0.9033, test: 0.9130
norm of g = 0.7618
shrinking trust region radius
gamma = 0.2620
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3412, test: 0.3214
ACCURACY - train: 0.9033, test: 0.9130
norm of g = 0.7618
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3379, test: 0.3162
ACCURACY - train: 0.9054, test: 0.9153
norm of g = 0.4137
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3403, test: 0.3135
ACCURACY - train: 0.9045, test: 0.9153
norm of g = 0.2867
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3351, test: 0.3107
ACCURACY - train: 0.9034, test: 0.9144
norm of g = 0.4370
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3348, test: 0.3069
ACCURACY - train: 0.9027, test: 0.9154
norm of g = 0.2777
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3239, test: 0.3038
ACCURACY - train: 0.9080, test: 0.9166
norm of g = 0.2887
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3199, test: 0.2998
ACCURACY - train: 0.9093, test: 0.9171
norm of g = 0.3809
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3189, test: 0.2918
ACCURACY - train: 0.9092, test: 0.9189
norm of g = 0.3990
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3189, test: 0.2918
ACCURACY - train: 0.9092, test: 0.9189
norm of g = 0.3990
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3120, test: 0.2887
ACCURACY - train: 0.9102, test: 0.9205
norm of g = 0.2802
gamma = 0.1295
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.3118, test: 0.2860
ACCURACY - train: 0.9097, test: 0.9199
norm of g = 0.2940
gamma = 0.1420
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.3012, test: 0.2827
ACCURACY - train: 0.9133, test: 0.9218
norm of g = 0.2642
gamma = 0.1298
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.3006, test: 0.2799
ACCURACY - train: 0.9138, test: 0.9229
norm of g = 0.2369
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.3041, test: 0.2786
ACCURACY - train: 0.9156, test: 0.9229
norm of g = 0.3104
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2972, test: 0.2749
ACCURACY - train: 0.9147, test: 0.9234
norm of g = 0.2435
gamma = 0.1017
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2972, test: 0.2720
ACCURACY - train: 0.9135, test: 0.9242
norm of g = 0.2867
gamma = 0.1144
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2877, test: 0.2698
ACCURACY - train: 0.9170, test: 0.9251
norm of g = 0.3606
gamma = 0.1158
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2877, test: 0.2683
ACCURACY - train: 0.9182, test: 0.9246
norm of g = 0.2738
gamma = 0.1160
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2917, test: 0.2662
ACCURACY - train: 0.9179, test: 0.9256
norm of g = 0.3380
gamma = 0.1163
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2852, test: 0.2625
ACCURACY - train: 0.9178, test: 0.9264
norm of g = 0.3627
gamma = 0.0890
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2852, test: 0.2617
ACCURACY - train: 0.9170, test: 0.9256
norm of g = 0.3467
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2755, test: 0.2587
ACCURACY - train: 0.9203, test: 0.9273
norm of g = 0.3238
gamma = 0.0252
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2754, test: 0.2562
ACCURACY - train: 0.9215, test: 0.9270
norm of g = 0.2282
gamma = 0.0807
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2795, test: 0.2543
ACCURACY - train: 0.9209, test: 0.9283
norm of g = 0.2860
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2726, test: 0.2513
ACCURACY - train: 0.9211, test: 0.9301
norm of g = 0.2402
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2722, test: 0.2496
ACCURACY - train: 0.9201, test: 0.9291
norm of g = 0.2732
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2629, test: 0.2469
ACCURACY - train: 0.9242, test: 0.9304
norm of g = 0.2384
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2635, test: 0.2447
ACCURACY - train: 0.9242, test: 0.9304
norm of g = 0.2252
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2678, test: 0.2438
ACCURACY - train: 0.9243, test: 0.9310
norm of g = 0.3131
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2609, test: 0.2400
ACCURACY - train: 0.9247, test: 0.9320
norm of g = 0.2637
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2601, test: 0.2382
ACCURACY - train: 0.9244, test: 0.9324
norm of g = 0.2549
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2510, test: 0.2358
ACCURACY - train: 0.9281, test: 0.9337
norm of g = 0.1984
expanding trust region radius
gamma = 0.0762
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2519, test: 0.2334
ACCURACY - train: 0.9270, test: 0.9341
norm of g = 0.1935
gamma = 0.0706
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2560, test: 0.2332
ACCURACY - train: 0.9292, test: 0.9329
norm of g = 0.4619
gamma = 0.0812
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2459, test: 0.2263
ACCURACY - train: 0.9284, test: 0.9354
norm of g = 0.4094
shrinking trust region radius
gamma = 0.0935
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2459, test: 0.2263
ACCURACY - train: 0.9284, test: 0.9354
norm of g = 0.4094
gamma = 0.0942
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2450, test: 0.2243
ACCURACY - train: 0.9292, test: 0.9361
norm of g = 0.2343
gamma = 0.0947
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2377, test: 0.2228
ACCURACY - train: 0.9314, test: 0.9375
norm of g = 0.2153
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2399, test: 0.2224
ACCURACY - train: 0.9315, test: 0.9377
norm of g = 0.2291
gamma = 0.0889
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2448, test: 0.2212
ACCURACY - train: 0.9316, test: 0.9375
norm of g = 0.1656
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2394, test: 0.2200
ACCURACY - train: 0.9308, test: 0.9371
norm of g = 0.2036
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2385, test: 0.2183
ACCURACY - train: 0.9303, test: 0.9380
norm of g = 0.2727
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2301, test: 0.2160
ACCURACY - train: 0.9339, test: 0.9392
norm of g = 0.2227
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2326, test: 0.2157
ACCURACY - train: 0.9330, test: 0.9389
norm of g = 0.3905
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2360, test: 0.2125
ACCURACY - train: 0.9340, test: 0.9400
norm of g = 0.2235
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2298, test: 0.2117
ACCURACY - train: 0.9327, test: 0.9392
norm of g = 0.2847
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2279, test: 0.2087
ACCURACY - train: 0.9336, test: 0.9409
norm of g = 0.1968
gamma = 0.0538
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.2201, test: 0.2070
ACCURACY - train: 0.9367, test: 0.9424
norm of g = 0.1996
gamma = 0.0690
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.2215, test: 0.2052
ACCURACY - train: 0.9371, test: 0.9425
norm of g = 0.1780
expanding trust region radius
gamma = 0.0726
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2262, test: 0.2039
ACCURACY - train: 0.9365, test: 0.9421
norm of g = 0.2362
shrinking trust region radius
gamma = 0.0717
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2262, test: 0.2039
ACCURACY - train: 0.9365, test: 0.9421
norm of g = 0.2362
expanding trust region radius
gamma = 0.0830
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.2201, test: 0.2019
ACCURACY - train: 0.9352, test: 0.9427
norm of g = 0.1980
gamma = 0.0709
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.2190, test: 0.2017
ACCURACY - train: 0.9358, test: 0.9425
norm of g = 0.2894
gamma = 0.0769
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.2115, test: 0.1990
ACCURACY - train: 0.9393, test: 0.9435
norm of g = 0.2923
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.2115, test: 0.1990
ACCURACY - train: 0.9393, test: 0.9435
norm of g = 0.2923
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.2146, test: 0.1983
ACCURACY - train: 0.9391, test: 0.9436
norm of g = 0.2037
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.2200, test: 0.1973
ACCURACY - train: 0.9381, test: 0.9448
norm of g = 0.1772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.2141, test: 0.1966
ACCURACY - train: 0.9370, test: 0.9443
norm of g = 0.2264
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.2132, test: 0.1954
ACCURACY - train: 0.9373, test: 0.9446
norm of g = 0.1708
gamma = 0.0137
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.2061, test: 0.1942
ACCURACY - train: 0.9414, test: 0.9457
norm of g = 0.2205
gamma = 0.0106
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.2092, test: 0.1935
ACCURACY - train: 0.9408, test: 0.9452
norm of g = 0.3477
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.2092, test: 0.1935
ACCURACY - train: 0.9408, test: 0.9452
norm of g = 0.3477
gamma = 0.0351
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.2149, test: 0.1926
ACCURACY - train: 0.9397, test: 0.9460
norm of g = 0.2421
expanding trust region radius
gamma = 0.0336
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.2089, test: 0.1918
ACCURACY - train: 0.9380, test: 0.9459
norm of g = 0.1998
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.2078, test: 0.1914
ACCURACY - train: 0.9390, test: 0.9457
norm of g = 0.1950
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.2012, test: 0.1890
ACCURACY - train: 0.9420, test: 0.9464
norm of g = 0.2516
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.2034, test: 0.1875
ACCURACY - train: 0.9420, test: 0.9469
norm of g = 0.2281
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.2095, test: 0.1880
ACCURACY - train: 0.9405, test: 0.9456
norm of g = 0.3709
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.2021, test: 0.1859
ACCURACY - train: 0.9410, test: 0.9467
norm of g = 0.3448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.2009, test: 0.1841
ACCURACY - train: 0.9409, test: 0.9467
norm of g = 0.3682
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1947, test: 0.1829
ACCURACY - train: 0.9440, test: 0.9484
norm of g = 0.3836
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1968, test: 0.1821
ACCURACY - train: 0.9447, test: 0.9484
norm of g = 0.2615
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1968, test: 0.1821
ACCURACY - train: 0.9447, test: 0.9484
norm of g = 0.2615
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.2029, test: 0.1812
ACCURACY - train: 0.9429, test: 0.9482
norm of g = 0.1851
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.1963, test: 0.1799
ACCURACY - train: 0.9428, test: 0.9482
norm of g = 0.1548
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1950, test: 0.1794
ACCURACY - train: 0.9433, test: 0.9483
norm of g = 0.1713
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.1891, test: 0.1782
ACCURACY - train: 0.9456, test: 0.9485
norm of g = 0.1637
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1928, test: 0.1778
ACCURACY - train: 0.9455, test: 0.9487
norm of g = 0.1887
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1986, test: 0.1771
ACCURACY - train: 0.9433, test: 0.9490
norm of g = 0.1621
gamma = 0.0790
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1921, test: 0.1761
ACCURACY - train: 0.9439, test: 0.9496
norm of g = 0.1527
gamma = 0.0759
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1909, test: 0.1753
ACCURACY - train: 0.9447, test: 0.9493
norm of g = 0.1744
gamma = 0.0437
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1853, test: 0.1744
ACCURACY - train: 0.9472, test: 0.9504
norm of g = 0.1871
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.1890, test: 0.1741
ACCURACY - train: 0.9465, test: 0.9492
norm of g = 0.2121
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1948, test: 0.1736
ACCURACY - train: 0.9443, test: 0.9501
norm of g = 0.1902
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1883, test: 0.1724
ACCURACY - train: 0.9448, test: 0.9500
norm of g = 0.1475
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1869, test: 0.1717
ACCURACY - train: 0.9459, test: 0.9504
norm of g = 0.1536
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1802, test: 0.1700
ACCURACY - train: 0.9487, test: 0.9512
norm of g = 0.1517
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1831, test: 0.1693
ACCURACY - train: 0.9486, test: 0.9522
norm of g = 0.3822
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1860, test: 0.1652
ACCURACY - train: 0.9470, test: 0.9522
norm of g = 0.2457
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1794, test: 0.1624
ACCURACY - train: 0.9464, test: 0.9539
norm of g = 0.3798
gamma = 0.0651
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1770, test: 0.1609
ACCURACY - train: 0.9486, test: 0.9543
norm of g = 0.2496
expanding trust region radius
gamma = 0.0650
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1706, test: 0.1602
ACCURACY - train: 0.9521, test: 0.9546
norm of g = 0.1791
shrinking trust region radius
gamma = 0.0687
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1706, test: 0.1602
ACCURACY - train: 0.9521, test: 0.9546
norm of g = 0.1791
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1743, test: 0.1601
ACCURACY - train: 0.9503, test: 0.9542
norm of g = 0.1414
gamma = 0.0687
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1803, test: 0.1597
ACCURACY - train: 0.9484, test: 0.9546
norm of g = 0.1314
gamma = 0.0696
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.1746, test: 0.1592
ACCURACY - train: 0.9485, test: 0.9543
norm of g = 0.2216
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1732, test: 0.1588
ACCURACY - train: 0.9502, test: 0.9544
norm of g = 0.1911
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1673, test: 0.1576
ACCURACY - train: 0.9530, test: 0.9551
norm of g = 0.1490
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1704, test: 0.1575
ACCURACY - train: 0.9514, test: 0.9548
norm of g = 0.2125
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1759, test: 0.1555
ACCURACY - train: 0.9501, test: 0.9553
norm of g = 0.1870
gamma = 0.0328
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1694, test: 0.1542
ACCURACY - train: 0.9504, test: 0.9557
norm of g = 0.2254
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1694, test: 0.1542
ACCURACY - train: 0.9504, test: 0.9557
norm of g = 0.2254
expanding trust region radius
gamma = 0.0270
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1682, test: 0.1535
ACCURACY - train: 0.9516, test: 0.9560
norm of g = 0.2028
gamma = 0.0229
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1622, test: 0.1531
ACCURACY - train: 0.9535, test: 0.9566
norm of g = 0.1952
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1663, test: 0.1529
ACCURACY - train: 0.9521, test: 0.9561
norm of g = 0.2599
expanding trust region radius
gamma = 0.0304
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1724, test: 0.1527
ACCURACY - train: 0.9510, test: 0.9564
norm of g = 0.1673
shrinking trust region radius
gamma = 0.0820
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1724, test: 0.1527
ACCURACY - train: 0.9510, test: 0.9564
norm of g = 0.1673
expanding trust region radius
gamma = 0.0575
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1666, test: 0.1519
ACCURACY - train: 0.9512, test: 0.9565
norm of g = 0.1439
gamma = 0.0797
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1652, test: 0.1513
ACCURACY - train: 0.9523, test: 0.9572
norm of g = 0.2059
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1596, test: 0.1509
ACCURACY - train: 0.9545, test: 0.9573
norm of g = 0.2205
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1631, test: 0.1500
ACCURACY - train: 0.9530, test: 0.9570
norm of g = 0.1582
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1691, test: 0.1495
ACCURACY - train: 0.9521, test: 0.9567
norm of g = 0.2250
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1624, test: 0.1475
ACCURACY - train: 0.9527, test: 0.9582
norm of g = 0.2052
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1600, test: 0.1467
ACCURACY - train: 0.9538, test: 0.9578
norm of g = 0.1888
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1600, test: 0.1467
ACCURACY - train: 0.9538, test: 0.9578
norm of g = 0.1888
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1546, test: 0.1461
ACCURACY - train: 0.9566, test: 0.9582
norm of g = 0.1396
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1581, test: 0.1454
ACCURACY - train: 0.9541, test: 0.9584
norm of g = 0.1419
gamma = 0.0415
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1644, test: 0.1450
ACCURACY - train: 0.9532, test: 0.9589
norm of g = 0.1462
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1587, test: 0.1441
ACCURACY - train: 0.9541, test: 0.9589
norm of g = 0.2012
expanding trust region radius
gamma = 0.0538
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1571, test: 0.1437
ACCURACY - train: 0.9554, test: 0.9591
norm of g = 0.1987
shrinking trust region radius
gamma = 0.0646
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1571, test: 0.1437
ACCURACY - train: 0.9554, test: 0.9591
norm of g = 0.1987
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1517, test: 0.1432
ACCURACY - train: 0.9582, test: 0.9590
norm of g = 0.1257
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1557, test: 0.1431
ACCURACY - train: 0.9548, test: 0.9591
norm of g = 0.1377
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1622, test: 0.1428
ACCURACY - train: 0.9534, test: 0.9592
norm of g = 0.1326
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1563, test: 0.1424
ACCURACY - train: 0.9546, test: 0.9591
norm of g = 0.1474
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1548, test: 0.1416
ACCURACY - train: 0.9558, test: 0.9593
norm of g = 0.1654
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1495, test: 0.1411
ACCURACY - train: 0.9583, test: 0.9597
norm of g = 0.1727
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1531, test: 0.1407
ACCURACY - train: 0.9557, test: 0.9594
norm of g = 0.1667
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1589, test: 0.1399
ACCURACY - train: 0.9542, test: 0.9599
norm of g = 0.2138
gamma = 0.0317
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.1520, test: 0.1381
ACCURACY - train: 0.9559, test: 0.9596
norm of g = 0.1639
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1520, test: 0.1381
ACCURACY - train: 0.9559, test: 0.9596
norm of g = 0.1639
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1508, test: 0.1377
ACCURACY - train: 0.9572, test: 0.9597
norm of g = 0.1534
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.1452, test: 0.1371
ACCURACY - train: 0.9596, test: 0.9606
norm of g = 0.1130
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.1483, test: 0.1369
ACCURACY - train: 0.9572, test: 0.9611
norm of g = 0.1708
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1544, test: 0.1353
ACCURACY - train: 0.9559, test: 0.9609
norm of g = 0.2133
shrinking trust region radius
gamma = 0.0475
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1544, test: 0.1353
ACCURACY - train: 0.9559, test: 0.9609
norm of g = 0.2133
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1485, test: 0.1347
ACCURACY - train: 0.9574, test: 0.9615
norm of g = 0.1346
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1470, test: 0.1345
ACCURACY - train: 0.9587, test: 0.9608
norm of g = 0.1481
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1413, test: 0.1339
ACCURACY - train: 0.9605, test: 0.9620
norm of g = 0.1117
expanding trust region radius
gamma = 0.0356
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1448, test: 0.1331
ACCURACY - train: 0.9577, test: 0.9617
norm of g = 0.1916
shrinking trust region radius
gamma = 0.0483
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1448, test: 0.1331
ACCURACY - train: 0.9577, test: 0.9617
norm of g = 0.1916
expanding trust region radius
gamma = 0.0458
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1512, test: 0.1324
ACCURACY - train: 0.9561, test: 0.9616
norm of g = 0.1153
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1458, test: 0.1317
ACCURACY - train: 0.9572, test: 0.9610
norm of g = 0.3276
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1428, test: 0.1295
ACCURACY - train: 0.9597, test: 0.9631
norm of g = 0.2136
shrinking trust region radius
gamma = 0.0784
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1428, test: 0.1295
ACCURACY - train: 0.9597, test: 0.9631
norm of g = 0.2136
gamma = 0.0102
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1373, test: 0.1294
ACCURACY - train: 0.9612, test: 0.9628
norm of g = 0.1884
gamma = 0.0207
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1411, test: 0.1298
ACCURACY - train: 0.9590, test: 0.9631
norm of g = 0.1552
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1477, test: 0.1293
ACCURACY - train: 0.9575, test: 0.9632
norm of g = 0.1744
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1419, test: 0.1285
ACCURACY - train: 0.9587, test: 0.9627
norm of g = 0.1660
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1419, test: 0.1285
ACCURACY - train: 0.9587, test: 0.9627
norm of g = 0.1660
expanding trust region radius
gamma = 0.0657
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1403, test: 0.1281
ACCURACY - train: 0.9599, test: 0.9629
norm of g = 0.1545
gamma = 0.0513
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1350, test: 0.1282
ACCURACY - train: 0.9625, test: 0.9628
norm of g = 0.1486
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1392, test: 0.1276
ACCURACY - train: 0.9596, test: 0.9632
norm of g = 0.2433
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1454, test: 0.1271
ACCURACY - train: 0.9581, test: 0.9633
norm of g = 0.1159
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1395, test: 0.1264
ACCURACY - train: 0.9600, test: 0.9632
norm of g = 0.1225
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1377, test: 0.1259
ACCURACY - train: 0.9612, test: 0.9637
norm of g = 0.1401
expanding trust region radius
gamma = 0.0627
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1324, test: 0.1254
ACCURACY - train: 0.9632, test: 0.9643
norm of g = 0.1251
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1324, test: 0.1254
ACCURACY - train: 0.9632, test: 0.9643
norm of g = 0.1251
expanding trust region radius
gamma = 0.0005
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1365, test: 0.1251
ACCURACY - train: 0.9605, test: 0.9643
norm of g = 0.1284
gamma = 0.0354
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1433, test: 0.1253
ACCURACY - train: 0.9585, test: 0.9637
norm of g = 0.1956
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1376, test: 0.1245
ACCURACY - train: 0.9601, test: 0.9636
norm of g = 0.2034
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1356, test: 0.1240
ACCURACY - train: 0.9618, test: 0.9643
norm of g = 0.1590
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1308, test: 0.1240
ACCURACY - train: 0.9632, test: 0.9649
norm of g = 0.2392
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1344, test: 0.1232
ACCURACY - train: 0.9608, test: 0.9646
norm of g = 0.1431
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1402, test: 0.1225
ACCURACY - train: 0.9592, test: 0.9643
norm of g = 0.1245
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1348, test: 0.1203
ACCURACY - train: 0.9608, test: 0.9653
norm of g = 0.3883
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1348, test: 0.1203
ACCURACY - train: 0.9608, test: 0.9653
norm of g = 0.3883
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1320, test: 0.1194
ACCURACY - train: 0.9626, test: 0.9657
norm of g = 0.1824
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1261, test: 0.1189
ACCURACY - train: 0.9648, test: 0.9661
norm of g = 0.1397
shrinking trust region radius
gamma = 0.0117
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1261, test: 0.1189
ACCURACY - train: 0.9648, test: 0.9661
norm of g = 0.1397
expanding trust region radius
gamma = 0.0532
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.1294, test: 0.1187
ACCURACY - train: 0.9624, test: 0.9654
norm of g = 0.1322
shrinking trust region radius
gamma = 0.0748
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.1294, test: 0.1187
ACCURACY - train: 0.9624, test: 0.9654
norm of g = 0.1322
expanding trust region radius
gamma = 0.0345
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.1360, test: 0.1185
ACCURACY - train: 0.9607, test: 0.9656
norm of g = 0.1051
gamma = 0.0290
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.1305, test: 0.1179
ACCURACY - train: 0.9627, test: 0.9652
norm of g = 0.1305
gamma = 0.0250
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.1293, test: 0.1185
ACCURACY - train: 0.9637, test: 0.9658
norm of g = 0.2332
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.1243, test: 0.1177
ACCURACY - train: 0.9648, test: 0.9659
norm of g = 0.1960
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.1278, test: 0.1172
ACCURACY - train: 0.9625, test: 0.9659
norm of g = 0.1712
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.1341, test: 0.1170
ACCURACY - train: 0.9612, test: 0.9657
norm of g = 0.1117
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.1287, test: 0.1162
ACCURACY - train: 0.9634, test: 0.9662
norm of g = 0.1483
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.1271, test: 0.1161
ACCURACY - train: 0.9645, test: 0.9665
norm of g = 0.1672
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.1222, test: 0.1157
ACCURACY - train: 0.9656, test: 0.9669
norm of g = 0.1527
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.1258, test: 0.1153
ACCURACY - train: 0.9638, test: 0.9660
norm of g = 0.1702
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.1321, test: 0.1148
ACCURACY - train: 0.9610, test: 0.9666
norm of g = 0.2201
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.1269, test: 0.1146
ACCURACY - train: 0.9635, test: 0.9659
norm of g = 0.3236
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.1247, test: 0.1144
ACCURACY - train: 0.9644, test: 0.9669
norm of g = 0.2856
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.1247, test: 0.1144
ACCURACY - train: 0.9644, test: 0.9669
norm of g = 0.2856
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.1196, test: 0.1132
ACCURACY - train: 0.9665, test: 0.9669
norm of g = 0.1656
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.1226, test: 0.1126
ACCURACY - train: 0.9645, test: 0.9670
norm of g = 0.1111
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.1286, test: 0.1116
ACCURACY - train: 0.9627, test: 0.9677
norm of g = 0.1576
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.1231, test: 0.1109
ACCURACY - train: 0.9643, test: 0.9676
norm of g = 0.1969
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.1231, test: 0.1109
ACCURACY - train: 0.9643, test: 0.9676
norm of g = 0.1969
gamma = 0.0373
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.1218, test: 0.1105
ACCURACY - train: 0.9655, test: 0.9676
norm of g = 0.1684
expanding trust region radius
gamma = 0.0119
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.1168, test: 0.1102
ACCURACY - train: 0.9669, test: 0.9675
norm of g = 0.1068
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.1199, test: 0.1103
ACCURACY - train: 0.9649, test: 0.9672
norm of g = 0.1550
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.1263, test: 0.1101
ACCURACY - train: 0.9633, test: 0.9674
norm of g = 0.1246
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.1213, test: 0.1090
ACCURACY - train: 0.9648, test: 0.9677
norm of g = 0.1468
expanding trust region radius
gamma = 0.0020
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.1199, test: 0.1089
ACCURACY - train: 0.9660, test: 0.9681
norm of g = 0.1672
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.1199, test: 0.1089
ACCURACY - train: 0.9660, test: 0.9681
norm of g = 0.1672
gamma = 0.0904
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.1149, test: 0.1086
ACCURACY - train: 0.9673, test: 0.9682
norm of g = 0.1176
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.1183, test: 0.1085
ACCURACY - train: 0.9651, test: 0.9679
norm of g = 0.1569
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.1250, test: 0.1084
ACCURACY - train: 0.9638, test: 0.9677
norm of g = 0.1351
gamma = 0.0762
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.1200, test: 0.1086
ACCURACY - train: 0.9655, test: 0.9684
norm of g = 0.1767
gamma = 0.0762
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.1187, test: 0.1081
ACCURACY - train: 0.9662, test: 0.9681
norm of g = 0.1883
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.1138, test: 0.1074
ACCURACY - train: 0.9679, test: 0.9687
norm of g = 0.1585
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.1169, test: 0.1075
ACCURACY - train: 0.9657, test: 0.9677
norm of g = 0.1536
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.1233, test: 0.1069
ACCURACY - train: 0.9635, test: 0.9686
norm of g = 0.2528
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.1185, test: 0.1062
ACCURACY - train: 0.9656, test: 0.9693
norm of g = 0.3224
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.1167, test: 0.1072
ACCURACY - train: 0.9668, test: 0.9690
norm of g = 0.2920
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.1167, test: 0.1072
ACCURACY - train: 0.9668, test: 0.9690
norm of g = 0.2920
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.1115, test: 0.1058
ACCURACY - train: 0.9687, test: 0.9687
norm of g = 0.1855
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.1141, test: 0.1049
ACCURACY - train: 0.9665, test: 0.9691
norm of g = 0.1184
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.1141, test: 0.1049
ACCURACY - train: 0.9665, test: 0.9691
norm of g = 0.1184
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.1207, test: 0.1046
ACCURACY - train: 0.9649, test: 0.9690
norm of g = 0.1025
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.1159, test: 0.1041
ACCURACY - train: 0.9661, test: 0.9682
norm of g = 0.1881
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.1148, test: 0.1042
ACCURACY - train: 0.9670, test: 0.9694
norm of g = 0.2115
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.1098, test: 0.1036
ACCURACY - train: 0.9689, test: 0.9696
norm of g = 0.1818
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.1131, test: 0.1040
ACCURACY - train: 0.9670, test: 0.9686
norm of g = 0.2365
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.1192, test: 0.1035
ACCURACY - train: 0.9654, test: 0.9693
norm of g = 0.1124
gamma = 0.0017
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.1142, test: 0.1026
ACCURACY - train: 0.9667, test: 0.9698
norm of g = 0.1505
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.1133, test: 0.1034
ACCURACY - train: 0.9674, test: 0.9697
norm of g = 0.2195
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.1087, test: 0.1029
ACCURACY - train: 0.9691, test: 0.9699
norm of g = 0.1842
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.1116, test: 0.1024
ACCURACY - train: 0.9669, test: 0.9696
norm of g = 0.1246
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.1180, test: 0.1022
ACCURACY - train: 0.9657, test: 0.9694
norm of g = 0.1034
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.1134, test: 0.1019
ACCURACY - train: 0.9669, test: 0.9701
norm of g = 0.1708
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.1120, test: 0.1017
ACCURACY - train: 0.9679, test: 0.9703
norm of g = 0.1622
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.1076, test: 0.1019
ACCURACY - train: 0.9692, test: 0.9693
norm of g = 0.2692
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.1106, test: 0.1012
ACCURACY - train: 0.9675, test: 0.9700
norm of g = 0.2105
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.1168, test: 0.1009
ACCURACY - train: 0.9660, test: 0.9698
norm of g = 0.1366
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.1116, test: 0.1007
ACCURACY - train: 0.9676, test: 0.9698
norm of g = 0.1269
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.1104, test: 0.1006
ACCURACY - train: 0.9684, test: 0.9706
norm of g = 0.1971
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.1058, test: 0.1003
ACCURACY - train: 0.9697, test: 0.9703
norm of g = 0.1327
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.1089, test: 0.0997
ACCURACY - train: 0.9671, test: 0.9704
norm of g = 0.1448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.1148, test: 0.0995
ACCURACY - train: 0.9667, test: 0.9705
norm of g = 0.1325
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.1148, test: 0.0995
ACCURACY - train: 0.9668, test: 0.9705
norm of g = 0.1325
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.1098, test: 0.0989
ACCURACY - train: 0.9680, test: 0.9710
norm of g = 0.1339
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.1086, test: 0.0993
ACCURACY - train: 0.9685, test: 0.9704
norm of g = 0.2193
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.1039, test: 0.0982
ACCURACY - train: 0.9708, test: 0.9707
norm of g = 0.1610
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.1070, test: 0.0980
ACCURACY - train: 0.9683, test: 0.9714
norm of g = 0.1574
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.1134, test: 0.0978
ACCURACY - train: 0.9669, test: 0.9709
norm of g = 0.1318
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.1134, test: 0.0978
ACCURACY - train: 0.9669, test: 0.9709
norm of g = 0.1318
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.1083, test: 0.0975
ACCURACY - train: 0.9687, test: 0.9712
norm of g = 0.1175
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.1069, test: 0.0976
ACCURACY - train: 0.9694, test: 0.9714
norm of g = 0.1788
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.1029, test: 0.0971
ACCURACY - train: 0.9701, test: 0.9703
norm of g = 0.2731
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.1053, test: 0.0960
ACCURACY - train: 0.9688, test: 0.9724
norm of g = 0.2286
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.1053, test: 0.0960
ACCURACY - train: 0.9688, test: 0.9724
norm of g = 0.2286
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.1119, test: 0.0960
ACCURACY - train: 0.9671, test: 0.9717
norm of g = 0.1476
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.1064, test: 0.0954
ACCURACY - train: 0.9690, test: 0.9720
norm of g = 0.1482
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.1047, test: 0.0956
ACCURACY - train: 0.9698, test: 0.9721
norm of g = 0.1662
gamma = 0.1522
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.1004, test: 0.0955
ACCURACY - train: 0.9712, test: 0.9725
norm of g = 0.2404
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.1004, test: 0.0955
ACCURACY - train: 0.9713, test: 0.9725
norm of g = 0.2404
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.1038, test: 0.0948
ACCURACY - train: 0.9689, test: 0.9721
norm of g = 0.1560
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.1102, test: 0.0945
ACCURACY - train: 0.9677, test: 0.9722
norm of g = 0.1833
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.1102, test: 0.0945
ACCURACY - train: 0.9677, test: 0.9722
norm of g = 0.1833
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.1048, test: 0.0943
ACCURACY - train: 0.9699, test: 0.9727
norm of g = 0.1188
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.1031, test: 0.0943
ACCURACY - train: 0.9705, test: 0.9721
norm of g = 0.1207
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0990, test: 0.0940
ACCURACY - train: 0.9717, test: 0.9723
norm of g = 0.0833
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.1027, test: 0.0941
ACCURACY - train: 0.9691, test: 0.9725
norm of g = 0.1389
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.1093, test: 0.0937
ACCURACY - train: 0.9678, test: 0.9724
norm of g = 0.1495
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.1093, test: 0.0937
ACCURACY - train: 0.9678, test: 0.9724
norm of g = 0.1495
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.1039, test: 0.0934
ACCURACY - train: 0.9700, test: 0.9727
norm of g = 0.1284
reached to the max num iteration -- BREAK
10 - 10 - preconditioning -- 1
2018-06-28 04:19:05.548296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:19:05.804969: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4cefa50 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:19:05.805812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:19:06.081482: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4cf3f30 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:19:06.082358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:19:06.349145: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4cf8410 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:19:06.350045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:19:06.350364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 04:19:06.350391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 04:19:06.350427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 04:19:06.350444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 04:19:06.350461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 04:19:06.350477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 04:19:06.350731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 04:19:06.350755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 04:19:06.350860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 04:19:06.350873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 04:19:06.350880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 04:19:06.350887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 04:19:06.350893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 04:19:06.350911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 04:19:06.350931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 04:19:06.350939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 04:19:06.350946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3350, test: 2.3362
ACCURACY - train: 0.1278, test: 0.1298
norm of g = 0.6524
Backtracking line search satisfied for alpha = 0.8100
initial gamma = 4.2221
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3068, test: 2.3048
ACCURACY - train: 0.2322, test: 0.2346
norm of g = 0.8833
gamma = 0.8841
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2459, test: 2.2446
ACCURACY - train: 0.3416, test: 0.3490
norm of g = 0.4172
no need for safe gaurding
gamma = 1.9222
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1268, test: 2.1231
ACCURACY - train: 0.2498, test: 0.2507
norm of g = 1.0042
no need for safe gaurding
gamma = 9.7285
weights are updated
------------------------------------------------------------
iteration: 3
LOSS     - train: 1.2403, test: 1.2346
ACCURACY - train: 0.5643, test: 0.5700
norm of g = 4.2926
shrinking trust region radius
no need for safe gaurding
gamma = 1.8288
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.2403, test: 1.2346
ACCURACY - train: 0.5643, test: 0.5700
norm of g = 4.2926
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.2403, test: 1.2346
ACCURACY - train: 0.5643, test: 0.5700
norm of g = 4.2926
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.0067, test: 0.9917
ACCURACY - train: 0.7496, test: 0.7547
norm of g = 2.0039
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 0.9435, test: 0.9017
ACCURACY - train: 0.7175, test: 0.7395
norm of g = 2.7888
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 0.8101, test: 0.7724
ACCURACY - train: 0.7679, test: 0.7846
norm of g = 1.9803
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.8101, test: 0.7724
ACCURACY - train: 0.7679, test: 0.7846
norm of g = 1.9803
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.7544, test: 0.7225
ACCURACY - train: 0.7973, test: 0.8104
norm of g = 1.0502
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.6914, test: 0.6686
ACCURACY - train: 0.8147, test: 0.8236
norm of g = 0.8412
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.6471, test: 0.6264
ACCURACY - train: 0.8299, test: 0.8332
norm of g = 0.9092
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.6025, test: 0.5728
ACCURACY - train: 0.8186, test: 0.8305
norm of g = 1.8397
shrinking trust region radius
gamma = 0.5688
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.6025, test: 0.5728
ACCURACY - train: 0.8186, test: 0.8305
norm of g = 1.8397
gamma = 0.6065
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.5789, test: 0.5383
ACCURACY - train: 0.8426, test: 0.8524
norm of g = 0.7710
gamma = 0.6013
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.5592, test: 0.5284
ACCURACY - train: 0.8428, test: 0.8516
norm of g = 0.8287
gamma = 0.5957
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.5323, test: 0.5094
ACCURACY - train: 0.8539, test: 0.8582
norm of g = 0.6013
gamma = 0.4365
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5243, test: 0.4967
ACCURACY - train: 0.8544, test: 0.8611
norm of g = 0.6903
gamma = 0.4205
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5181, test: 0.4810
ACCURACY - train: 0.8523, test: 0.8639
norm of g = 0.5298
gamma = 0.4614
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5106, test: 0.4693
ACCURACY - train: 0.8547, test: 0.8691
norm of g = 0.5344
gamma = 0.3551
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.4884, test: 0.4546
ACCURACY - train: 0.8662, test: 0.8737
norm of g = 0.4707
gamma = 0.5234
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4681, test: 0.4483
ACCURACY - train: 0.8681, test: 0.8699
norm of g = 0.8393
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4513, test: 0.4351
ACCURACY - train: 0.8744, test: 0.8745
norm of g = 0.5524
gamma = 0.5153
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4542, test: 0.4254
ACCURACY - train: 0.8721, test: 0.8823
norm of g = 0.5781
gamma = 0.4146
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4522, test: 0.4135
ACCURACY - train: 0.8719, test: 0.8844
norm of g = 0.4520
gamma = 0.4603
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4344, test: 0.4039
ACCURACY - train: 0.8777, test: 0.8846
norm of g = 0.5610
gamma = 0.3923
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4194, test: 0.3969
ACCURACY - train: 0.8816, test: 0.8880
norm of g = 0.6223
gamma = 0.4026
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4119, test: 0.3845
ACCURACY - train: 0.8838, test: 0.8910
norm of g = 0.4545
shrinking trust region radius
gamma = 0.3232
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4169, test: 0.3823
ACCURACY - train: 0.8793, test: 0.8898
norm of g = 0.9782
gamma = 0.3188
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4164, test: 0.3771
ACCURACY - train: 0.8822, test: 0.8936
norm of g = 0.5459
expanding trust region radius
gamma = 0.3857
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4057, test: 0.3738
ACCURACY - train: 0.8878, test: 0.8951
norm of g = 0.3324
expanding trust region radius
gamma = 0.3101
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3879, test: 0.3693
ACCURACY - train: 0.8899, test: 0.8960
norm of g = 0.3449
expanding trust region radius
gamma = 0.3189
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3758, test: 0.3611
ACCURACY - train: 0.8944, test: 0.8977
norm of g = 0.3379
gamma = 0.3140
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3805, test: 0.3566
ACCURACY - train: 0.8908, test: 0.8951
norm of g = 1.0108
gamma = 0.3108
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3798, test: 0.3425
ACCURACY - train: 0.8927, test: 0.9031
norm of g = 1.0645
shrinking trust region radius
gamma = 0.2918
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3798, test: 0.3425
ACCURACY - train: 0.8927, test: 0.9031
norm of g = 1.0645
gamma = 0.2953
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3606, test: 0.3325
ACCURACY - train: 0.8977, test: 0.9071
norm of g = 0.5869
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3507, test: 0.3276
ACCURACY - train: 0.8992, test: 0.9055
norm of g = 0.3763
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3502, test: 0.3240
ACCURACY - train: 0.9009, test: 0.9064
norm of g = 0.4066
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3513, test: 0.3214
ACCURACY - train: 0.8970, test: 0.9065
norm of g = 0.4539
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3537, test: 0.3181
ACCURACY - train: 0.8987, test: 0.9089
norm of g = 0.2917
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3444, test: 0.3142
ACCURACY - train: 0.9047, test: 0.9103
norm of g = 0.3000
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3276, test: 0.3112
ACCURACY - train: 0.9063, test: 0.9111
norm of g = 0.3307
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3203, test: 0.3087
ACCURACY - train: 0.9069, test: 0.9116
norm of g = 0.2751
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3308, test: 0.3064
ACCURACY - train: 0.9047, test: 0.9110
norm of g = 0.3546
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3384, test: 0.3018
ACCURACY - train: 0.9017, test: 0.9151
norm of g = 0.2932
gamma = 0.1900
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3264, test: 0.2995
ACCURACY - train: 0.9066, test: 0.9158
norm of g = 0.3207
gamma = 0.1808
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3197, test: 0.2971
ACCURACY - train: 0.9098, test: 0.9148
norm of g = 0.3419
gamma = 0.1429
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3183, test: 0.2931
ACCURACY - train: 0.9099, test: 0.9156
norm of g = 0.2996
gamma = 0.1723
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3194, test: 0.2917
ACCURACY - train: 0.9062, test: 0.9140
norm of g = 0.5204
gamma = 0.1705
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.3221, test: 0.2895
ACCURACY - train: 0.9079, test: 0.9165
norm of g = 0.3782
gamma = 0.1529
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.3152, test: 0.2865
ACCURACY - train: 0.9123, test: 0.9194
norm of g = 0.4256
gamma = 0.1376
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2992, test: 0.2833
ACCURACY - train: 0.9137, test: 0.9186
norm of g = 0.3459
gamma = 0.1425
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2926, test: 0.2820
ACCURACY - train: 0.9147, test: 0.9192
norm of g = 0.3409
gamma = 0.1366
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.3027, test: 0.2795
ACCURACY - train: 0.9127, test: 0.9204
norm of g = 0.2762
gamma = 0.1518
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.3119, test: 0.2763
ACCURACY - train: 0.9089, test: 0.9228
norm of g = 0.3843
gamma = 0.1483
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2996, test: 0.2736
ACCURACY - train: 0.9140, test: 0.9221
norm of g = 0.2954
gamma = 0.1460
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2943, test: 0.2728
ACCURACY - train: 0.9159, test: 0.9205
norm of g = 0.3206
gamma = 0.0923
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2933, test: 0.2692
ACCURACY - train: 0.9158, test: 0.9212
norm of g = 0.2986
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2919, test: 0.2671
ACCURACY - train: 0.9137, test: 0.9222
norm of g = 0.3228
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2954, test: 0.2641
ACCURACY - train: 0.9157, test: 0.9246
norm of g = 0.2436
expanding trust region radius
gamma = 0.1041
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2889, test: 0.2613
ACCURACY - train: 0.9217, test: 0.9252
norm of g = 0.3046
shrinking trust region radius
gamma = 0.1078
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2889, test: 0.2613
ACCURACY - train: 0.9217, test: 0.9252
norm of g = 0.3046
gamma = 0.1004
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2755, test: 0.2600
ACCURACY - train: 0.9213, test: 0.9252
norm of g = 0.2418
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2698, test: 0.2594
ACCURACY - train: 0.9207, test: 0.9252
norm of g = 0.2193
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2817, test: 0.2587
ACCURACY - train: 0.9184, test: 0.9255
norm of g = 0.2569
gamma = 0.1392
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2897, test: 0.2557
ACCURACY - train: 0.9172, test: 0.9270
norm of g = 0.2418
gamma = 0.0614
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2782, test: 0.2534
ACCURACY - train: 0.9198, test: 0.9281
norm of g = 0.2598
gamma = 0.1190
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2738, test: 0.2520
ACCURACY - train: 0.9212, test: 0.9264
norm of g = 0.2719
gamma = 0.0974
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2722, test: 0.2487
ACCURACY - train: 0.9219, test: 0.9270
norm of g = 0.2574
gamma = 0.1256
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2707, test: 0.2470
ACCURACY - train: 0.9197, test: 0.9290
norm of g = 0.4089
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2749, test: 0.2454
ACCURACY - train: 0.9212, test: 0.9298
norm of g = 0.3450
gamma = 0.1402
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2706, test: 0.2435
ACCURACY - train: 0.9252, test: 0.9303
norm of g = 0.4647
gamma = 0.1124
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2583, test: 0.2427
ACCURACY - train: 0.9256, test: 0.9296
norm of g = 0.5976
gamma = 0.1143
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2501, test: 0.2406
ACCURACY - train: 0.9263, test: 0.9312
norm of g = 0.3354
gamma = 0.1142
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2612, test: 0.2388
ACCURACY - train: 0.9256, test: 0.9324
norm of g = 0.3211
gamma = 0.0956
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2695, test: 0.2366
ACCURACY - train: 0.9229, test: 0.9333
norm of g = 0.3076
gamma = 0.0971
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2591, test: 0.2345
ACCURACY - train: 0.9253, test: 0.9320
norm of g = 0.3512
gamma = 0.1437
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2556, test: 0.2335
ACCURACY - train: 0.9264, test: 0.9325
norm of g = 0.3380
gamma = 0.1343
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2538, test: 0.2318
ACCURACY - train: 0.9261, test: 0.9326
norm of g = 0.3305
gamma = 0.1103
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2510, test: 0.2289
ACCURACY - train: 0.9257, test: 0.9328
norm of g = 0.3459
gamma = 0.1594
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2559, test: 0.2277
ACCURACY - train: 0.9272, test: 0.9342
norm of g = 0.3214
gamma = 0.1347
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2511, test: 0.2251
ACCURACY - train: 0.9312, test: 0.9358
norm of g = 0.2921
gamma = 0.1090
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2399, test: 0.2250
ACCURACY - train: 0.9303, test: 0.9349
norm of g = 0.4916
gamma = 0.0796
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2327, test: 0.2248
ACCURACY - train: 0.9323, test: 0.9346
norm of g = 0.3413
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2441, test: 0.2222
ACCURACY - train: 0.9300, test: 0.9375
norm of g = 0.3444
gamma = 0.0387
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2521, test: 0.2188
ACCURACY - train: 0.9287, test: 0.9381
norm of g = 0.2981
shrinking trust region radius
gamma = 0.0804
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.2521, test: 0.2188
ACCURACY - train: 0.9287, test: 0.9381
norm of g = 0.2981
expanding trust region radius
gamma = 0.1705
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.2427, test: 0.2183
ACCURACY - train: 0.9314, test: 0.9382
norm of g = 0.2586
expanding trust region radius
gamma = 0.2609
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2402, test: 0.2179
ACCURACY - train: 0.9313, test: 0.9381
norm of g = 0.2364
gamma = 0.1782
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2386, test: 0.2180
ACCURACY - train: 0.9301, test: 0.9349
norm of g = 0.3480
gamma = 0.1740
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.2352, test: 0.2149
ACCURACY - train: 0.9305, test: 0.9364
norm of g = 0.3217
gamma = 0.1322
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.2408, test: 0.2143
ACCURACY - train: 0.9318, test: 0.9389
norm of g = 0.4377
gamma = 0.1351
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.2382, test: 0.2123
ACCURACY - train: 0.9329, test: 0.9386
norm of g = 0.5112
gamma = 0.1280
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.2270, test: 0.2125
ACCURACY - train: 0.9347, test: 0.9382
norm of g = 0.5976
gamma = 0.0478
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.2204, test: 0.2123
ACCURACY - train: 0.9359, test: 0.9384
norm of g = 0.4428
gamma = 0.0486
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.2315, test: 0.2107
ACCURACY - train: 0.9332, test: 0.9397
norm of g = 0.4305
gamma = 0.0767
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.2402, test: 0.2077
ACCURACY - train: 0.9314, test: 0.9404
norm of g = 0.3593
gamma = 0.1391
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.2304, test: 0.2068
ACCURACY - train: 0.9321, test: 0.9391
norm of g = 0.4878
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.2278, test: 0.2073
ACCURACY - train: 0.9333, test: 0.9403
norm of g = 0.4596
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.2245, test: 0.2037
ACCURACY - train: 0.9346, test: 0.9405
norm of g = 0.2700
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.2219, test: 0.2018
ACCURACY - train: 0.9338, test: 0.9402
norm of g = 0.4804
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.2267, test: 0.2011
ACCURACY - train: 0.9350, test: 0.9410
norm of g = 0.3686
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.2240, test: 0.1996
ACCURACY - train: 0.9373, test: 0.9422
norm of g = 0.4188
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.2125, test: 0.1990
ACCURACY - train: 0.9389, test: 0.9412
norm of g = 0.3864
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.2050, test: 0.1982
ACCURACY - train: 0.9400, test: 0.9421
norm of g = 0.2189
gamma = 0.0601
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.2163, test: 0.1950
ACCURACY - train: 0.9377, test: 0.9430
norm of g = 0.2702
shrinking trust region radius
gamma = 0.0387
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.2163, test: 0.1950
ACCURACY - train: 0.9377, test: 0.9430
norm of g = 0.2702
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.2258, test: 0.1942
ACCURACY - train: 0.9361, test: 0.9435
norm of g = 0.1792
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.2161, test: 0.1933
ACCURACY - train: 0.9377, test: 0.9440
norm of g = 0.2138
gamma = 0.0574
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.2144, test: 0.1928
ACCURACY - train: 0.9373, test: 0.9434
norm of g = 0.2156
expanding trust region radius
gamma = 0.0543
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.2124, test: 0.1918
ACCURACY - train: 0.9386, test: 0.9435
norm of g = 0.1917
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.2095, test: 0.1916
ACCURACY - train: 0.9382, test: 0.9430
norm of g = 0.4699
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.2146, test: 0.1910
ACCURACY - train: 0.9385, test: 0.9446
norm of g = 0.3753
gamma = 0.1175
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.2119, test: 0.1879
ACCURACY - train: 0.9402, test: 0.9446
norm of g = 0.3953
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.2119, test: 0.1879
ACCURACY - train: 0.9402, test: 0.9446
norm of g = 0.3953
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.2013, test: 0.1871
ACCURACY - train: 0.9427, test: 0.9444
norm of g = 0.2181
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1955, test: 0.1872
ACCURACY - train: 0.9429, test: 0.9437
norm of g = 0.1763
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.2075, test: 0.1870
ACCURACY - train: 0.9399, test: 0.9452
norm of g = 0.1998
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.2172, test: 0.1861
ACCURACY - train: 0.9372, test: 0.9449
norm of g = 0.2683
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.2074, test: 0.1850
ACCURACY - train: 0.9397, test: 0.9450
norm of g = 0.1994
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.2059, test: 0.1848
ACCURACY - train: 0.9399, test: 0.9455
norm of g = 0.2112
gamma = 0.0395
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.2036, test: 0.1839
ACCURACY - train: 0.9414, test: 0.9454
norm of g = 0.1757
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.2004, test: 0.1832
ACCURACY - train: 0.9404, test: 0.9451
norm of g = 0.3061
gamma = 0.1785
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.2061, test: 0.1826
ACCURACY - train: 0.9403, test: 0.9467
norm of g = 0.1956
gamma = 0.1227
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.2050, test: 0.1813
ACCURACY - train: 0.9427, test: 0.9459
norm of g = 0.2629
gamma = 0.0877
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1949, test: 0.1812
ACCURACY - train: 0.9441, test: 0.9455
norm of g = 0.2742
expanding trust region radius
gamma = 0.0887
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1885, test: 0.1810
ACCURACY - train: 0.9457, test: 0.9461
norm of g = 0.1946
gamma = 0.0583
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.2007, test: 0.1811
ACCURACY - train: 0.9409, test: 0.9462
norm of g = 0.3560
gamma = 0.0507
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.2105, test: 0.1792
ACCURACY - train: 0.9368, test: 0.9464
norm of g = 0.4823
shrinking trust region radius
gamma = 0.0662
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.2105, test: 0.1792
ACCURACY - train: 0.9368, test: 0.9464
norm of g = 0.4823
expanding trust region radius
gamma = 0.0679
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.2007, test: 0.1779
ACCURACY - train: 0.9402, test: 0.9477
norm of g = 0.3387
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1988, test: 0.1774
ACCURACY - train: 0.9419, test: 0.9468
norm of g = 0.2543
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1965, test: 0.1766
ACCURACY - train: 0.9431, test: 0.9471
norm of g = 0.2039
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1926, test: 0.1760
ACCURACY - train: 0.9435, test: 0.9471
norm of g = 0.1958
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.1984, test: 0.1754
ACCURACY - train: 0.9426, test: 0.9477
norm of g = 0.1775
gamma = 0.1054
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1977, test: 0.1745
ACCURACY - train: 0.9448, test: 0.9481
norm of g = 0.2867
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1879, test: 0.1742
ACCURACY - train: 0.9465, test: 0.9472
norm of g = 0.3199
gamma = 0.0480
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1811, test: 0.1743
ACCURACY - train: 0.9472, test: 0.9474
norm of g = 0.2061
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1938, test: 0.1741
ACCURACY - train: 0.9431, test: 0.9478
norm of g = 0.2709
expanding trust region radius
gamma = 0.0522
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.2029, test: 0.1725
ACCURACY - train: 0.9404, test: 0.9487
norm of g = 0.1609
gamma = 0.0630
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1930, test: 0.1710
ACCURACY - train: 0.9426, test: 0.9490
norm of g = 0.2344
gamma = 0.0407
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1921, test: 0.1718
ACCURACY - train: 0.9432, test: 0.9483
norm of g = 0.3762
gamma = 0.0320
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1888, test: 0.1698
ACCURACY - train: 0.9455, test: 0.9480
norm of g = 0.2709
shrinking trust region radius
gamma = 0.0612
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1888, test: 0.1698
ACCURACY - train: 0.9455, test: 0.9480
norm of g = 0.2709
expanding trust region radius
gamma = 0.0848
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1856, test: 0.1691
ACCURACY - train: 0.9454, test: 0.9487
norm of g = 0.3043
gamma = 0.1925
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1911, test: 0.1684
ACCURACY - train: 0.9444, test: 0.9494
norm of g = 0.2273
expanding trust region radius
gamma = 0.1738
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1903, test: 0.1676
ACCURACY - train: 0.9467, test: 0.9499
norm of g = 0.2735
shrinking trust region radius
gamma = 0.0936
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1903, test: 0.1676
ACCURACY - train: 0.9467, test: 0.9499
norm of g = 0.2735
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1806, test: 0.1672
ACCURACY - train: 0.9483, test: 0.9496
norm of g = 0.1869
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1744, test: 0.1672
ACCURACY - train: 0.9489, test: 0.9497
norm of g = 0.1586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1863, test: 0.1670
ACCURACY - train: 0.9463, test: 0.9499
norm of g = 0.2071
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1957, test: 0.1662
ACCURACY - train: 0.9417, test: 0.9498
norm of g = 0.2297
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1862, test: 0.1654
ACCURACY - train: 0.9432, test: 0.9506
norm of g = 0.1800
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1854, test: 0.1649
ACCURACY - train: 0.9444, test: 0.9505
norm of g = 0.2264
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1826, test: 0.1639
ACCURACY - train: 0.9480, test: 0.9502
norm of g = 0.1773
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1779, test: 0.1624
ACCURACY - train: 0.9472, test: 0.9508
norm of g = 0.1917
gamma = 0.1271
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1821, test: 0.1604
ACCURACY - train: 0.9475, test: 0.9522
norm of g = 0.3184
gamma = 0.1226
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1821, test: 0.1585
ACCURACY - train: 0.9472, test: 0.9525
norm of g = 0.5331
shrinking trust region radius
gamma = 0.0916
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1821, test: 0.1585
ACCURACY - train: 0.9472, test: 0.9525
norm of g = 0.5331
gamma = 0.1103
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1710, test: 0.1567
ACCURACY - train: 0.9507, test: 0.9531
norm of g = 0.3050
gamma = 0.0999
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1638, test: 0.1569
ACCURACY - train: 0.9526, test: 0.9523
norm of g = 0.1827
gamma = 0.0867
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1763, test: 0.1573
ACCURACY - train: 0.9487, test: 0.9525
norm of g = 0.2886
gamma = 0.1503
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1856, test: 0.1565
ACCURACY - train: 0.9447, test: 0.9526
norm of g = 0.2623
gamma = 0.1150
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1762, test: 0.1556
ACCURACY - train: 0.9457, test: 0.9530
norm of g = 0.1766
gamma = 0.2127
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1755, test: 0.1556
ACCURACY - train: 0.9472, test: 0.9532
norm of g = 0.2823
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1723, test: 0.1547
ACCURACY - train: 0.9507, test: 0.9537
norm of g = 0.1399
gamma = 0.0192
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1671, test: 0.1535
ACCURACY - train: 0.9509, test: 0.9534
norm of g = 0.2001
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1671, test: 0.1535
ACCURACY - train: 0.9509, test: 0.9534
norm of g = 0.2001
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.1733, test: 0.1530
ACCURACY - train: 0.9498, test: 0.9542
norm of g = 0.1848
gamma = 0.1864
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1737, test: 0.1521
ACCURACY - train: 0.9503, test: 0.9541
norm of g = 0.2550
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1646, test: 0.1520
ACCURACY - train: 0.9531, test: 0.9544
norm of g = 0.2547
gamma = 0.0287
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.1581, test: 0.1522
ACCURACY - train: 0.9547, test: 0.9544
norm of g = 0.1612
gamma = 0.0763
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.1706, test: 0.1518
ACCURACY - train: 0.9509, test: 0.9548
norm of g = 0.2737
gamma = 0.0919
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1795, test: 0.1506
ACCURACY - train: 0.9465, test: 0.9546
norm of g = 0.1873
gamma = 0.0384
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1703, test: 0.1500
ACCURACY - train: 0.9469, test: 0.9547
norm of g = 0.1600
gamma = 0.0939
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1694, test: 0.1500
ACCURACY - train: 0.9493, test: 0.9549
norm of g = 0.2460
gamma = 0.1959
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1668, test: 0.1497
ACCURACY - train: 0.9522, test: 0.9546
norm of g = 0.1977
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1627, test: 0.1489
ACCURACY - train: 0.9521, test: 0.9549
norm of g = 0.2871
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1684, test: 0.1485
ACCURACY - train: 0.9512, test: 0.9551
norm of g = 0.2405
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1687, test: 0.1477
ACCURACY - train: 0.9522, test: 0.9555
norm of g = 0.2526
expanding trust region radius
gamma = 0.0286
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1594, test: 0.1471
ACCURACY - train: 0.9543, test: 0.9561
norm of g = 0.1948
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1532, test: 0.1494
ACCURACY - train: 0.9566, test: 0.9552
norm of g = 0.2525
expanding trust region radius
gamma = 0.0624
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1643, test: 0.1462
ACCURACY - train: 0.9529, test: 0.9565
norm of g = 0.2196
shrinking trust region radius
gamma = 0.0874
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1643, test: 0.1462
ACCURACY - train: 0.9529, test: 0.9565
norm of g = 0.2196
expanding trust region radius
gamma = 0.1483
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1734, test: 0.1447
ACCURACY - train: 0.9477, test: 0.9566
norm of g = 0.1534
gamma = 0.0934
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1645, test: 0.1447
ACCURACY - train: 0.9483, test: 0.9570
norm of g = 0.2978
shrinking trust region radius
gamma = 0.1012
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1645, test: 0.1455
ACCURACY - train: 0.9517, test: 0.9556
norm of g = 0.4689
expanding trust region radius
gamma = 0.1020
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1621, test: 0.1439
ACCURACY - train: 0.9534, test: 0.9560
norm of g = 0.4140
gamma = 0.1441
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1563, test: 0.1425
ACCURACY - train: 0.9548, test: 0.9573
norm of g = 0.2312
gamma = 0.1275
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1620, test: 0.1425
ACCURACY - train: 0.9526, test: 0.9576
norm of g = 0.2388
gamma = 0.0955
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1624, test: 0.1416
ACCURACY - train: 0.9542, test: 0.9574
norm of g = 0.2796
gamma = 0.1809
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1536, test: 0.1414
ACCURACY - train: 0.9561, test: 0.9577
norm of g = 0.3101
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1469, test: 0.1415
ACCURACY - train: 0.9584, test: 0.9579
norm of g = 0.1936
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1591, test: 0.1414
ACCURACY - train: 0.9547, test: 0.9579
norm of g = 0.2127
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1681, test: 0.1400
ACCURACY - train: 0.9494, test: 0.9574
norm of g = 0.1694
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1592, test: 0.1396
ACCURACY - train: 0.9508, test: 0.9585
norm of g = 0.1560
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1587, test: 0.1395
ACCURACY - train: 0.9534, test: 0.9580
norm of g = 0.1967
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1564, test: 0.1390
ACCURACY - train: 0.9558, test: 0.9584
norm of g = 0.1824
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1517, test: 0.1383
ACCURACY - train: 0.9558, test: 0.9585
norm of g = 0.2126
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1574, test: 0.1383
ACCURACY - train: 0.9535, test: 0.9586
norm of g = 0.2236
expanding trust region radius
gamma = 0.0876
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1577, test: 0.1373
ACCURACY - train: 0.9554, test: 0.9585
norm of g = 0.2441
shrinking trust region radius
gamma = 0.0826
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1577, test: 0.1373
ACCURACY - train: 0.9554, test: 0.9585
norm of g = 0.2441
gamma = 0.0135
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1488, test: 0.1370
ACCURACY - train: 0.9579, test: 0.9586
norm of g = 0.1858
expanding trust region radius
gamma = 0.0226
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1426, test: 0.1372
ACCURACY - train: 0.9603, test: 0.9587
norm of g = 0.1477
gamma = 0.0627
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1548, test: 0.1374
ACCURACY - train: 0.9564, test: 0.9591
norm of g = 0.2061
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1638, test: 0.1365
ACCURACY - train: 0.9517, test: 0.9591
norm of g = 0.1925
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1550, test: 0.1356
ACCURACY - train: 0.9517, test: 0.9596
norm of g = 0.1820
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1545, test: 0.1364
ACCURACY - train: 0.9543, test: 0.9593
norm of g = 0.3273
gamma = 0.1584
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1520, test: 0.1351
ACCURACY - train: 0.9570, test: 0.9596
norm of g = 0.3045
shrinking trust region radius
gamma = 0.1732
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.1473, test: 0.1340
ACCURACY - train: 0.9568, test: 0.9599
norm of g = 0.3030
gamma = 0.1332
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.1524, test: 0.1333
ACCURACY - train: 0.9559, test: 0.9598
norm of g = 0.1696
expanding trust region radius
gamma = 0.0721
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.1534, test: 0.1328
ACCURACY - train: 0.9562, test: 0.9600
norm of g = 0.2264
gamma = 0.0024
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.1443, test: 0.1330
ACCURACY - train: 0.9589, test: 0.9604
norm of g = 0.2108
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.1380, test: 0.1334
ACCURACY - train: 0.9611, test: 0.9595
norm of g = 0.1686
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.1501, test: 0.1330
ACCURACY - train: 0.9577, test: 0.9604
norm of g = 0.2343
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.1588, test: 0.1317
ACCURACY - train: 0.9533, test: 0.9604
norm of g = 0.1618
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.1498, test: 0.1312
ACCURACY - train: 0.9537, test: 0.9603
norm of g = 0.1840
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.1497, test: 0.1317
ACCURACY - train: 0.9557, test: 0.9603
norm of g = 0.2342
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.1476, test: 0.1309
ACCURACY - train: 0.9584, test: 0.9614
norm of g = 0.2226
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.1431, test: 0.1304
ACCURACY - train: 0.9588, test: 0.9610
norm of g = 0.1879
gamma = 0.1226
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.1484, test: 0.1300
ACCURACY - train: 0.9569, test: 0.9618
norm of g = 0.1561
gamma = 0.1121
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.1491, test: 0.1292
ACCURACY - train: 0.9582, test: 0.9621
norm of g = 0.2056
gamma = 0.0313
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.1402, test: 0.1293
ACCURACY - train: 0.9608, test: 0.9618
norm of g = 0.2386
gamma = 0.0270
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.1342, test: 0.1299
ACCURACY - train: 0.9625, test: 0.9608
norm of g = 0.2515
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.1465, test: 0.1298
ACCURACY - train: 0.9577, test: 0.9617
norm of g = 0.2649
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.1548, test: 0.1282
ACCURACY - train: 0.9545, test: 0.9615
norm of g = 0.1381
gamma = 0.0091
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.1460, test: 0.1275
ACCURACY - train: 0.9557, test: 0.9623
norm of g = 0.1665
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.1462, test: 0.1284
ACCURACY - train: 0.9568, test: 0.9619
norm of g = 0.2764
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.1440, test: 0.1274
ACCURACY - train: 0.9594, test: 0.9625
norm of g = 0.2375
gamma = 0.0456
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.1396, test: 0.1274
ACCURACY - train: 0.9595, test: 0.9621
norm of g = 0.2904
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.1448, test: 0.1268
ACCURACY - train: 0.9577, test: 0.9624
norm of g = 0.2123
gamma = 0.0942
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.1455, test: 0.1262
ACCURACY - train: 0.9591, test: 0.9626
norm of g = 0.2778
gamma = 0.1012
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.1370, test: 0.1264
ACCURACY - train: 0.9612, test: 0.9620
norm of g = 0.3026
gamma = 0.0297
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.1306, test: 0.1263
ACCURACY - train: 0.9633, test: 0.9623
norm of g = 0.1918
gamma = 0.0334
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.1428, test: 0.1262
ACCURACY - train: 0.9597, test: 0.9628
norm of g = 0.2383
gamma = 0.1435
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.1517, test: 0.1253
ACCURACY - train: 0.9547, test: 0.9628
norm of g = 0.2777
gamma = 0.0665
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.1428, test: 0.1246
ACCURACY - train: 0.9568, test: 0.9631
norm of g = 0.1872
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.1427, test: 0.1253
ACCURACY - train: 0.9573, test: 0.9622
norm of g = 0.2547
expanding trust region radius
gamma = 0.0801
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.1407, test: 0.1245
ACCURACY - train: 0.9604, test: 0.9631
norm of g = 0.2160
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.1407, test: 0.1245
ACCURACY - train: 0.9604, test: 0.9631
norm of g = 0.2160
gamma = 0.2265
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.1362, test: 0.1241
ACCURACY - train: 0.9603, test: 0.9634
norm of g = 0.2081
expanding trust region radius
gamma = 0.2848
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.1416, test: 0.1237
ACCURACY - train: 0.9585, test: 0.9635
norm of g = 0.1556
expanding trust region radius
gamma = 0.1496
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.1423, test: 0.1234
ACCURACY - train: 0.9597, test: 0.9639
norm of g = 0.2490
gamma = 0.1957
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.1342, test: 0.1237
ACCURACY - train: 0.9624, test: 0.9641
norm of g = 0.3906
gamma = 0.1071
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.1278, test: 0.1250
ACCURACY - train: 0.9635, test: 0.9623
norm of g = 0.2943
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.1278, test: 0.1250
ACCURACY - train: 0.9635, test: 0.9623
norm of g = 0.2943
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.1402, test: 0.1237
ACCURACY - train: 0.9595, test: 0.9627
norm of g = 0.2892
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.1477, test: 0.1223
ACCURACY - train: 0.9558, test: 0.9635
norm of g = 0.1346
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.1394, test: 0.1215
ACCURACY - train: 0.9574, test: 0.9637
norm of g = 0.1921
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.1391, test: 0.1216
ACCURACY - train: 0.9590, test: 0.9641
norm of g = 0.1975
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.1375, test: 0.1214
ACCURACY - train: 0.9612, test: 0.9635
norm of g = 0.2395
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.1331, test: 0.1216
ACCURACY - train: 0.9615, test: 0.9634
norm of g = 0.3112
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.1376, test: 0.1208
ACCURACY - train: 0.9598, test: 0.9643
norm of g = 0.1959
gamma = 0.1592
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.1383, test: 0.1201
ACCURACY - train: 0.9616, test: 0.9649
norm of g = 0.2441
gamma = 0.0106
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.1297, test: 0.1199
ACCURACY - train: 0.9633, test: 0.9649
norm of g = 0.2418
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.1244, test: 0.1208
ACCURACY - train: 0.9649, test: 0.9634
norm of g = 0.2473
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.1361, test: 0.1201
ACCURACY - train: 0.9614, test: 0.9644
norm of g = 0.2045
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.1361, test: 0.1201
ACCURACY - train: 0.9614, test: 0.9644
norm of g = 0.2045
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.1446, test: 0.1194
ACCURACY - train: 0.9570, test: 0.9651
norm of g = 0.1402
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.1361, test: 0.1187
ACCURACY - train: 0.9588, test: 0.9653
norm of g = 0.1852
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.1363, test: 0.1191
ACCURACY - train: 0.9604, test: 0.9644
norm of g = 0.2223
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.1344, test: 0.1184
ACCURACY - train: 0.9622, test: 0.9648
norm of g = 0.1862
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.1295, test: 0.1181
ACCURACY - train: 0.9628, test: 0.9653
norm of g = 0.2404
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.1344, test: 0.1178
ACCURACY - train: 0.9602, test: 0.9653
norm of g = 0.1891
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.1351, test: 0.1171
ACCURACY - train: 0.9620, test: 0.9658
norm of g = 0.2463
gamma = 0.0395
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.1268, test: 0.1171
ACCURACY - train: 0.9639, test: 0.9661
norm of g = 0.2592
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.1212, test: 0.1176
ACCURACY - train: 0.9654, test: 0.9654
norm of g = 0.2297
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.1329, test: 0.1169
ACCURACY - train: 0.9619, test: 0.9659
norm of g = 0.1814
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.1411, test: 0.1159
ACCURACY - train: 0.9575, test: 0.9658
norm of g = 0.1256
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.1322, test: 0.1150
ACCURACY - train: 0.9597, test: 0.9663
norm of g = 0.2144
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.1325, test: 0.1159
ACCURACY - train: 0.9609, test: 0.9654
norm of g = 0.2960
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.1299, test: 0.1145
ACCURACY - train: 0.9641, test: 0.9671
norm of g = 0.1547
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.1299, test: 0.1145
ACCURACY - train: 0.9641, test: 0.9671
norm of g = 0.1547
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.1251, test: 0.1137
ACCURACY - train: 0.9645, test: 0.9670
norm of g = 0.2028
gamma = 0.0486
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.1295, test: 0.1130
ACCURACY - train: 0.9626, test: 0.9671
norm of g = 0.2078
shrinking trust region radius
gamma = 0.0451
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.1295, test: 0.1130
ACCURACY - train: 0.9626, test: 0.9671
norm of g = 0.2078
gamma = 0.0387
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.1306, test: 0.1126
ACCURACY - train: 0.9627, test: 0.9674
norm of g = 0.1976
gamma = 0.0725
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.1222, test: 0.1124
ACCURACY - train: 0.9652, test: 0.9678
norm of g = 0.1905
gamma = 0.0909
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.1168, test: 0.1126
ACCURACY - train: 0.9666, test: 0.9674
norm of g = 0.1430
gamma = 0.2055
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.1285, test: 0.1126
ACCURACY - train: 0.9626, test: 0.9677
norm of g = 0.1802
expanding trust region radius
gamma = 0.0969
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.1365, test: 0.1120
ACCURACY - train: 0.9595, test: 0.9674
norm of g = 0.1175
gamma = 0.2413
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.1279, test: 0.1117
ACCURACY - train: 0.9616, test: 0.9677
norm of g = 0.1708
gamma = 0.1606
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.1286, test: 0.1122
ACCURACY - train: 0.9627, test: 0.9674
norm of g = 0.2648
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.1268, test: 0.1117
ACCURACY - train: 0.9642, test: 0.9678
norm of g = 0.1847
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.1219, test: 0.1117
ACCURACY - train: 0.9647, test: 0.9679
norm of g = 0.2247
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.1269, test: 0.1108
ACCURACY - train: 0.9631, test: 0.9679
norm of g = 0.1286
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.1283, test: 0.1102
ACCURACY - train: 0.9640, test: 0.9681
norm of g = 0.2512
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.1198, test: 0.1103
ACCURACY - train: 0.9655, test: 0.9682
norm of g = 0.2418
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.1143, test: 0.1103
ACCURACY - train: 0.9673, test: 0.9677
norm of g = 0.1693
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.1143, test: 0.1103
ACCURACY - train: 0.9673, test: 0.9677
norm of g = 0.1693
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.1260, test: 0.1101
ACCURACY - train: 0.9638, test: 0.9678
norm of g = 0.1900
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.1337, test: 0.1097
ACCURACY - train: 0.9604, test: 0.9686
norm of g = 0.1268
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.1252, test: 0.1092
ACCURACY - train: 0.9620, test: 0.9685
norm of g = 0.1636
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.1256, test: 0.1096
ACCURACY - train: 0.9633, test: 0.9684
norm of g = 0.2038
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.1240, test: 0.1093
ACCURACY - train: 0.9650, test: 0.9680
norm of g = 0.1728
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.1191, test: 0.1089
ACCURACY - train: 0.9654, test: 0.9681
norm of g = 0.2226
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.1240, test: 0.1085
ACCURACY - train: 0.9639, test: 0.9681
norm of g = 0.1370
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.1254, test: 0.1077
ACCURACY - train: 0.9653, test: 0.9684
norm of g = 0.2559
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.1169, test: 0.1079
ACCURACY - train: 0.9668, test: 0.9684
norm of g = 0.2192
reached to the max num iteration -- BREAK
10 - 25 - preconditioning -- 1
2018-06-28 04:38:43.628324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:38:43.888215: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x525d730 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:38:43.889074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:38:44.152093: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x5261c10 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:38:44.152944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:38:44.442380: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x52660f0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:38:44.443434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:38:44.443804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 04:38:44.443835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 04:38:44.443877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 04:38:44.443896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 04:38:44.443914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 04:38:44.443931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 04:38:44.444208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 04:38:44.444234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 04:38:44.444355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 04:38:44.444368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 04:38:44.444377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 04:38:44.444385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 04:38:44.444393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 04:38:44.444417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 04:38:44.444429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 04:38:44.444438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 04:38:44.444454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3782, test: 2.3830
ACCURACY - train: 0.0969, test: 0.0982
norm of g = 0.7367
Backtracking line search satisfied for alpha = 1.0000
initial gamma = 2.1941
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3098, test: 2.3140
ACCURACY - train: 0.1185, test: 0.1131
norm of g = 0.5951
gamma = 0.8064
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2609, test: 2.2619
ACCURACY - train: 0.1144, test: 0.1123
norm of g = 0.3466
gamma = 0.0974
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1623, test: 2.1554
ACCURACY - train: 0.2510, test: 0.2720
norm of g = 0.5773
shrinking trust region radius
gamma = 0.0530
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.1623, test: 2.1554
ACCURACY - train: 0.2510, test: 0.2720
norm of g = 0.5773
curvature condition did satisfy -- (s,y) was not added
gamma = 0.0530
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.8422, test: 1.8314
ACCURACY - train: 0.5738, test: 0.5806
norm of g = 0.9237
no need for safe gaurding
gamma = 1.9259
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.3787, test: 1.3571
ACCURACY - train: 0.6662, test: 0.6796
norm of g = 1.7048
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 0.9246, test: 0.8958
ACCURACY - train: 0.7315, test: 0.7397
norm of g = 2.2888
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 0.9246, test: 0.8958
ACCURACY - train: 0.7315, test: 0.7397
norm of g = 2.2888
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 0.8330, test: 0.7824
ACCURACY - train: 0.7673, test: 0.7806
norm of g = 1.2553
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.7770, test: 0.7283
ACCURACY - train: 0.7904, test: 0.8070
norm of g = 1.7415
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.6528, test: 0.6232
ACCURACY - train: 0.8294, test: 0.8399
norm of g = 1.0068
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.6528, test: 0.6232
ACCURACY - train: 0.8294, test: 0.8399
norm of g = 1.0068
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.6173, test: 0.5943
ACCURACY - train: 0.8454, test: 0.8520
norm of g = 0.7612
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.5919, test: 0.5734
ACCURACY - train: 0.8496, test: 0.8560
norm of g = 0.6212
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.5637, test: 0.5432
ACCURACY - train: 0.8496, test: 0.8587
norm of g = 0.7084
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.5236, test: 0.4858
ACCURACY - train: 0.8558, test: 0.8651
norm of g = 0.7267
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.4835, test: 0.4575
ACCURACY - train: 0.8619, test: 0.8740
norm of g = 1.1337
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.4362, test: 0.4139
ACCURACY - train: 0.8704, test: 0.8848
norm of g = 1.2612
shrinking trust region radius
gamma = 0.4435
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.4362, test: 0.4139
ACCURACY - train: 0.8704, test: 0.8848
norm of g = 1.2612
gamma = 0.4379
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.4326, test: 0.3951
ACCURACY - train: 0.8785, test: 0.8887
norm of g = 0.6611
gamma = 0.3764
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.4406, test: 0.3859
ACCURACY - train: 0.8665, test: 0.8923
norm of g = 0.4551
gamma = 0.3539
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.4303, test: 0.3841
ACCURACY - train: 0.8669, test: 0.8907
norm of g = 0.7644
gamma = 0.3537
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4057, test: 0.3699
ACCURACY - train: 0.8865, test: 0.8974
norm of g = 0.4657
gamma = 0.3344
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4002, test: 0.3637
ACCURACY - train: 0.8908, test: 0.8977
norm of g = 0.5896
gamma = 0.3682
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.3821, test: 0.3596
ACCURACY - train: 0.8906, test: 0.8995
norm of g = 0.5562
gamma = 0.3315
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.3796, test: 0.3518
ACCURACY - train: 0.8921, test: 0.9019
norm of g = 0.4535
gamma = 0.2878
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.3750, test: 0.3456
ACCURACY - train: 0.8975, test: 0.9035
norm of g = 0.4018
gamma = 0.2437
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.3552, test: 0.3392
ACCURACY - train: 0.9012, test: 0.9045
norm of g = 0.3850
gamma = 0.2607
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.3450, test: 0.3320
ACCURACY - train: 0.9025, test: 0.9057
norm of g = 0.3623
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.3381, test: 0.3262
ACCURACY - train: 0.8996, test: 0.9075
norm of g = 0.4786
gamma = 0.2206
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3342, test: 0.3224
ACCURACY - train: 0.9035, test: 0.9098
norm of g = 0.5723
gamma = 0.2673
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3335, test: 0.3171
ACCURACY - train: 0.9052, test: 0.9095
norm of g = 0.5260
gamma = 0.2667
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3477, test: 0.3087
ACCURACY - train: 0.9031, test: 0.9130
norm of g = 0.4522
shrinking trust region radius
gamma = 0.1404
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3477, test: 0.3087
ACCURACY - train: 0.9031, test: 0.9130
norm of g = 0.4522
expanding trust region radius
gamma = 0.1406
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3495, test: 0.3063
ACCURACY - train: 0.9008, test: 0.9140
norm of g = 0.3164
gamma = 0.1436
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3289, test: 0.3042
ACCURACY - train: 0.9037, test: 0.9132
norm of g = 0.3314
gamma = 0.1243
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3350, test: 0.3011
ACCURACY - train: 0.9062, test: 0.9136
norm of g = 0.4617
gamma = 0.1189
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3345, test: 0.2995
ACCURACY - train: 0.9040, test: 0.9151
norm of g = 0.3186
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3229, test: 0.2978
ACCURACY - train: 0.9056, test: 0.9149
norm of g = 0.3339
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3117, test: 0.2944
ACCURACY - train: 0.9106, test: 0.9157
norm of g = 0.3917
gamma = 0.2341
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3038, test: 0.2912
ACCURACY - train: 0.9160, test: 0.9165
norm of g = 0.3220
gamma = 0.1299
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3079, test: 0.2894
ACCURACY - train: 0.9104, test: 0.9166
norm of g = 0.3885
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3198, test: 0.2881
ACCURACY - train: 0.9058, test: 0.9158
norm of g = 0.3393
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3119, test: 0.2854
ACCURACY - train: 0.9087, test: 0.9159
norm of g = 0.3480
expanding trust region radius
gamma = 0.1599
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.2985, test: 0.2834
ACCURACY - train: 0.9117, test: 0.9177
norm of g = 0.3006
gamma = 0.1495
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3095, test: 0.2785
ACCURACY - train: 0.9092, test: 0.9202
norm of g = 0.4533
gamma = 0.1614
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3208, test: 0.2741
ACCURACY - train: 0.9017, test: 0.9209
norm of g = 0.4768
shrinking trust region radius
gamma = 0.2712
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3208, test: 0.2741
ACCURACY - train: 0.9017, test: 0.9209
norm of g = 0.4768
gamma = 0.2646
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3095, test: 0.2724
ACCURACY - train: 0.9033, test: 0.9216
norm of g = 0.3896
expanding trust region radius
gamma = 0.2054
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3019, test: 0.2712
ACCURACY - train: 0.9125, test: 0.9216
norm of g = 0.3301
gamma = 0.2039
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3015, test: 0.2696
ACCURACY - train: 0.9137, test: 0.9212
norm of g = 0.4291
gamma = 0.1952
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2853, test: 0.2671
ACCURACY - train: 0.9169, test: 0.9219
norm of g = 0.3515
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2910, test: 0.2653
ACCURACY - train: 0.9175, test: 0.9240
norm of g = 0.3345
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2914, test: 0.2637
ACCURACY - train: 0.9204, test: 0.9234
norm of g = 0.2894
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2777, test: 0.2627
ACCURACY - train: 0.9215, test: 0.9244
norm of g = 0.3045
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2748, test: 0.2620
ACCURACY - train: 0.9200, test: 0.9245
norm of g = 0.3041
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2668, test: 0.2589
ACCURACY - train: 0.9221, test: 0.9255
norm of g = 0.3567
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2624, test: 0.2559
ACCURACY - train: 0.9250, test: 0.9254
norm of g = 0.3173
gamma = 0.2550
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2667, test: 0.2532
ACCURACY - train: 0.9244, test: 0.9267
norm of g = 0.2985
gamma = 0.1693
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2906, test: 0.2515
ACCURACY - train: 0.9200, test: 0.9272
norm of g = 0.2991
gamma = 0.1651
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2909, test: 0.2502
ACCURACY - train: 0.9165, test: 0.9285
norm of g = 0.2877
gamma = 0.1816
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2697, test: 0.2468
ACCURACY - train: 0.9202, test: 0.9289
norm of g = 0.3073
gamma = 0.1600
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2772, test: 0.2456
ACCURACY - train: 0.9173, test: 0.9304
norm of g = 0.5142
gamma = 0.1795
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2744, test: 0.2451
ACCURACY - train: 0.9221, test: 0.9302
norm of g = 0.3217
gamma = 0.1928
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2651, test: 0.2439
ACCURACY - train: 0.9227, test: 0.9298
norm of g = 0.3971
expanding trust region radius
gamma = 0.2784
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2572, test: 0.2412
ACCURACY - train: 0.9269, test: 0.9302
norm of g = 0.3815
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2572, test: 0.2412
ACCURACY - train: 0.9269, test: 0.9302
norm of g = 0.3815
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2533, test: 0.2394
ACCURACY - train: 0.9302, test: 0.9308
norm of g = 0.3685
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2567, test: 0.2396
ACCURACY - train: 0.9235, test: 0.9311
norm of g = 0.4127
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2684, test: 0.2384
ACCURACY - train: 0.9200, test: 0.9299
norm of g = 0.3340
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2605, test: 0.2357
ACCURACY - train: 0.9210, test: 0.9300
norm of g = 0.3408
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2460, test: 0.2368
ACCURACY - train: 0.9271, test: 0.9306
norm of g = 0.4703
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2562, test: 0.2305
ACCURACY - train: 0.9250, test: 0.9349
norm of g = 0.4323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2730, test: 0.2304
ACCURACY - train: 0.9160, test: 0.9326
norm of g = 0.7496
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2591, test: 0.2329
ACCURACY - train: 0.9215, test: 0.9318
norm of g = 0.7406
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2538, test: 0.2274
ACCURACY - train: 0.9252, test: 0.9342
norm of g = 0.5847
gamma = 0.2917
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2536, test: 0.2236
ACCURACY - train: 0.9287, test: 0.9360
norm of g = 0.4796
gamma = 0.2945
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2371, test: 0.2217
ACCURACY - train: 0.9300, test: 0.9367
norm of g = 0.3286
expanding trust region radius
gamma = 0.3250
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2450, test: 0.2208
ACCURACY - train: 0.9287, test: 0.9359
norm of g = 0.2677
gamma = 0.1987
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2461, test: 0.2203
ACCURACY - train: 0.9321, test: 0.9357
norm of g = 0.2381
gamma = 0.1816
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2339, test: 0.2203
ACCURACY - train: 0.9333, test: 0.9354
norm of g = 0.2677
gamma = 0.1911
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2337, test: 0.2206
ACCURACY - train: 0.9317, test: 0.9365
norm of g = 0.3412
gamma = 0.1971
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2238, test: 0.2180
ACCURACY - train: 0.9348, test: 0.9376
norm of g = 0.2834
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2176, test: 0.2147
ACCURACY - train: 0.9383, test: 0.9367
norm of g = 0.3060
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2241, test: 0.2134
ACCURACY - train: 0.9367, test: 0.9373
norm of g = 0.3372
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2512, test: 0.2119
ACCURACY - train: 0.9331, test: 0.9386
norm of g = 0.5025
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2476, test: 0.2089
ACCURACY - train: 0.9302, test: 0.9390
norm of g = 0.3986
gamma = 0.2117
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2283, test: 0.2065
ACCURACY - train: 0.9300, test: 0.9399
norm of g = 0.5076
gamma = 0.2150
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.2335, test: 0.2038
ACCURACY - train: 0.9285, test: 0.9404
norm of g = 0.6144
gamma = 0.2367
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.2282, test: 0.2063
ACCURACY - train: 0.9335, test: 0.9404
norm of g = 0.4785
shrinking trust region radius
gamma = 0.1877
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2282, test: 0.2063
ACCURACY - train: 0.9335, test: 0.9404
norm of g = 0.4785
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2194, test: 0.2023
ACCURACY - train: 0.9360, test: 0.9411
norm of g = 0.3304
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.2141, test: 0.1994
ACCURACY - train: 0.9381, test: 0.9409
norm of g = 0.3688
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.2092, test: 0.1973
ACCURACY - train: 0.9406, test: 0.9424
norm of g = 0.4337
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.2133, test: 0.1979
ACCURACY - train: 0.9360, test: 0.9428
norm of g = 0.4581
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.2238, test: 0.1936
ACCURACY - train: 0.9375, test: 0.9441
norm of g = 0.4136
gamma = 0.0329
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.2136, test: 0.1919
ACCURACY - train: 0.9365, test: 0.9439
norm of g = 0.3841
shrinking trust region radius
gamma = 0.0931
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.2136, test: 0.1919
ACCURACY - train: 0.9365, test: 0.9439
norm of g = 0.3841
gamma = 0.0576
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1990, test: 0.1904
ACCURACY - train: 0.9408, test: 0.9443
norm of g = 0.3346
expanding trust region radius
gamma = 0.1533
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.2127, test: 0.1898
ACCURACY - train: 0.9385, test: 0.9431
norm of g = 0.2856
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.2263, test: 0.1884
ACCURACY - train: 0.9306, test: 0.9461
norm of g = 0.3874
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.2105, test: 0.1874
ACCURACY - train: 0.9340, test: 0.9461
norm of g = 0.2768
shrinking trust region radius
gamma = 0.0415
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.2105, test: 0.1874
ACCURACY - train: 0.9340, test: 0.9461
norm of g = 0.2768
expanding trust region radius
gamma = 0.3341
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.2098, test: 0.1865
ACCURACY - train: 0.9394, test: 0.9470
norm of g = 0.2653
expanding trust region radius
gamma = 0.2075
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.2111, test: 0.1845
ACCURACY - train: 0.9410, test: 0.9462
norm of g = 0.3822
gamma = 0.4176
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1957, test: 0.1847
ACCURACY - train: 0.9454, test: 0.9447
norm of g = 0.4303
gamma = 0.2537
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.2032, test: 0.1855
ACCURACY - train: 0.9390, test: 0.9454
norm of g = 0.4854
gamma = 0.4083
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.2041, test: 0.1838
ACCURACY - train: 0.9429, test: 0.9471
norm of g = 0.4684
shrinking trust region radius
gamma = 0.1698
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.2041, test: 0.1838
ACCURACY - train: 0.9429, test: 0.9471
norm of g = 0.4684
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1940, test: 0.1817
ACCURACY - train: 0.9444, test: 0.9477
norm of g = 0.3599
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1936, test: 0.1817
ACCURACY - train: 0.9410, test: 0.9470
norm of g = 0.3268
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1840, test: 0.1799
ACCURACY - train: 0.9465, test: 0.9475
norm of g = 0.3355
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1768, test: 0.1777
ACCURACY - train: 0.9500, test: 0.9479
norm of g = 0.3176
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1849, test: 0.1766
ACCURACY - train: 0.9492, test: 0.9486
norm of g = 0.3663
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.2117, test: 0.1747
ACCURACY - train: 0.9427, test: 0.9489
norm of g = 0.2404
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.2093, test: 0.1735
ACCURACY - train: 0.9404, test: 0.9499
norm of g = 0.2012
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1896, test: 0.1717
ACCURACY - train: 0.9450, test: 0.9509
norm of g = 0.3320
gamma = 0.3374
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.1971, test: 0.1695
ACCURACY - train: 0.9419, test: 0.9489
norm of g = 0.5212
shrinking trust region radius
gamma = 0.2891
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1927, test: 0.1738
ACCURACY - train: 0.9419, test: 0.9497
norm of g = 0.4472
expanding trust region radius
gamma = 0.2838
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1835, test: 0.1710
ACCURACY - train: 0.9454, test: 0.9510
norm of g = 0.3106
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1796, test: 0.1672
ACCURACY - train: 0.9465, test: 0.9509
norm of g = 0.2960
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1767, test: 0.1659
ACCURACY - train: 0.9500, test: 0.9519
norm of g = 0.2857
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1793, test: 0.1676
ACCURACY - train: 0.9477, test: 0.9514
norm of g = 0.3724
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.1911, test: 0.1656
ACCURACY - train: 0.9442, test: 0.9524
norm of g = 0.3459
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1838, test: 0.1620
ACCURACY - train: 0.9460, test: 0.9543
norm of g = 0.4486
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1664, test: 0.1621
ACCURACY - train: 0.9523, test: 0.9523
norm of g = 0.3778
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1834, test: 0.1643
ACCURACY - train: 0.9467, test: 0.9505
norm of g = 0.6049
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1955, test: 0.1604
ACCURACY - train: 0.9400, test: 0.9527
norm of g = 0.5944
gamma = 0.2385
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1757, test: 0.1584
ACCURACY - train: 0.9458, test: 0.9548
norm of g = 0.3308
gamma = 0.2116
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1754, test: 0.1577
ACCURACY - train: 0.9492, test: 0.9553
norm of g = 0.2189
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1788, test: 0.1563
ACCURACY - train: 0.9515, test: 0.9553
norm of g = 0.3300
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1627, test: 0.1564
ACCURACY - train: 0.9575, test: 0.9545
norm of g = 0.2465
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1713, test: 0.1562
ACCURACY - train: 0.9519, test: 0.9547
norm of g = 0.3322
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1732, test: 0.1552
ACCURACY - train: 0.9510, test: 0.9545
norm of g = 0.2278
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1641, test: 0.1563
ACCURACY - train: 0.9517, test: 0.9539
norm of g = 0.3422
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1628, test: 0.1547
ACCURACY - train: 0.9500, test: 0.9551
norm of g = 0.2752
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.1628, test: 0.1547
ACCURACY - train: 0.9500, test: 0.9551
norm of g = 0.2752
expanding trust region radius
gamma = 0.2839
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1545, test: 0.1526
ACCURACY - train: 0.9529, test: 0.9557
norm of g = 0.2515
gamma = 0.2438
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1457, test: 0.1510
ACCURACY - train: 0.9579, test: 0.9552
norm of g = 0.3338
gamma = 0.2187
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1537, test: 0.1474
ACCURACY - train: 0.9569, test: 0.9565
norm of g = 0.3894
shrinking trust region radius
gamma = 0.2203
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1537, test: 0.1474
ACCURACY - train: 0.9569, test: 0.9565
norm of g = 0.3894
gamma = 0.2314
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1820, test: 0.1459
ACCURACY - train: 0.9504, test: 0.9569
norm of g = 0.2889
expanding trust region radius
gamma = 0.2542
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1783, test: 0.1454
ACCURACY - train: 0.9483, test: 0.9584
norm of g = 0.2257
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1613, test: 0.1453
ACCURACY - train: 0.9523, test: 0.9578
norm of g = 0.2520
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1691, test: 0.1435
ACCURACY - train: 0.9494, test: 0.9586
norm of g = 0.3936
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1691, test: 0.1435
ACCURACY - train: 0.9494, test: 0.9586
norm of g = 0.3936
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1645, test: 0.1434
ACCURACY - train: 0.9500, test: 0.9589
norm of g = 0.3190
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1556, test: 0.1440
ACCURACY - train: 0.9535, test: 0.9584
norm of g = 0.2013
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1550, test: 0.1436
ACCURACY - train: 0.9544, test: 0.9579
norm of g = 0.2803
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1523, test: 0.1432
ACCURACY - train: 0.9565, test: 0.9588
norm of g = 0.3046
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1523, test: 0.1432
ACCURACY - train: 0.9565, test: 0.9588
norm of g = 0.3046
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1552, test: 0.1429
ACCURACY - train: 0.9546, test: 0.9590
norm of g = 0.3485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1691, test: 0.1428
ACCURACY - train: 0.9498, test: 0.9585
norm of g = 0.2901
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1610, test: 0.1420
ACCURACY - train: 0.9519, test: 0.9576
norm of g = 0.2038
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1454, test: 0.1430
ACCURACY - train: 0.9592, test: 0.9574
norm of g = 0.2668
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1454, test: 0.1430
ACCURACY - train: 0.9592, test: 0.9574
norm of g = 0.2668
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1602, test: 0.1419
ACCURACY - train: 0.9535, test: 0.9579
norm of g = 0.2297
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1717, test: 0.1410
ACCURACY - train: 0.9483, test: 0.9586
norm of g = 0.3586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1537, test: 0.1410
ACCURACY - train: 0.9546, test: 0.9606
norm of g = 0.2116
expanding trust region radius
gamma = 0.3691
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1556, test: 0.1396
ACCURACY - train: 0.9542, test: 0.9606
norm of g = 0.2819
gamma = 0.3439
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1591, test: 0.1393
ACCURACY - train: 0.9558, test: 0.9599
norm of g = 0.4164
shrinking trust region radius
gamma = 0.3976
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1591, test: 0.1393
ACCURACY - train: 0.9558, test: 0.9599
norm of g = 0.4164
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1447, test: 0.1377
ACCURACY - train: 0.9610, test: 0.9604
norm of g = 0.3017
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1508, test: 0.1374
ACCURACY - train: 0.9602, test: 0.9597
norm of g = 0.2097
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1533, test: 0.1371
ACCURACY - train: 0.9575, test: 0.9599
norm of g = 0.2396
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1448, test: 0.1381
ACCURACY - train: 0.9585, test: 0.9597
norm of g = 0.2744
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1457, test: 0.1409
ACCURACY - train: 0.9538, test: 0.9579
norm of g = 0.3072
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1371, test: 0.1384
ACCURACY - train: 0.9590, test: 0.9594
norm of g = 0.2457
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1291, test: 0.1358
ACCURACY - train: 0.9646, test: 0.9607
norm of g = 0.2485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1396, test: 0.1347
ACCURACY - train: 0.9613, test: 0.9610
norm of g = 0.2864
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.1670, test: 0.1330
ACCURACY - train: 0.9544, test: 0.9617
norm of g = 0.2277
gamma = 0.2431
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1626, test: 0.1333
ACCURACY - train: 0.9538, test: 0.9625
norm of g = 0.2662
expanding trust region radius
gamma = 0.2103
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1467, test: 0.1316
ACCURACY - train: 0.9571, test: 0.9619
norm of g = 0.2025
gamma = 0.3158
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.1559, test: 0.1320
ACCURACY - train: 0.9552, test: 0.9623
norm of g = 0.4865
gamma = 0.3544
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.1499, test: 0.1340
ACCURACY - train: 0.9571, test: 0.9625
norm of g = 0.4387
shrinking trust region radius
gamma = 0.3228
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1499, test: 0.1340
ACCURACY - train: 0.9571, test: 0.9625
norm of g = 0.4387
gamma = 0.2962
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1414, test: 0.1321
ACCURACY - train: 0.9577, test: 0.9626
norm of g = 0.2953
expanding trust region radius
gamma = 0.3447
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1407, test: 0.1308
ACCURACY - train: 0.9581, test: 0.9618
norm of g = 0.3029
gamma = 0.3235
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1379, test: 0.1296
ACCURACY - train: 0.9625, test: 0.9638
norm of g = 0.2437
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1403, test: 0.1319
ACCURACY - train: 0.9610, test: 0.9618
norm of g = 0.3856
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1534, test: 0.1297
ACCURACY - train: 0.9548, test: 0.9623
norm of g = 0.2720
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1455, test: 0.1282
ACCURACY - train: 0.9583, test: 0.9625
norm of g = 0.2336
expanding trust region radius
gamma = 0.2137
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1304, test: 0.1283
ACCURACY - train: 0.9631, test: 0.9622
norm of g = 0.2827
shrinking trust region radius
gamma = 0.2388
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1304, test: 0.1283
ACCURACY - train: 0.9631, test: 0.9622
norm of g = 0.2827
gamma = 0.6572
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1448, test: 0.1284
ACCURACY - train: 0.9577, test: 0.9619
norm of g = 0.2480
gamma = 0.8041
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1547, test: 0.1272
ACCURACY - train: 0.9525, test: 0.9633
norm of g = 0.3582
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1370, test: 0.1269
ACCURACY - train: 0.9594, test: 0.9634
norm of g = 0.2439
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1397, test: 0.1259
ACCURACY - train: 0.9594, test: 0.9651
norm of g = 0.2903
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1450, test: 0.1245
ACCURACY - train: 0.9598, test: 0.9651
norm of g = 0.3755
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1312, test: 0.1256
ACCURACY - train: 0.9663, test: 0.9638
norm of g = 0.2792
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1362, test: 0.1251
ACCURACY - train: 0.9642, test: 0.9642
norm of g = 0.2424
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1377, test: 0.1250
ACCURACY - train: 0.9619, test: 0.9643
norm of g = 0.2360
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1301, test: 0.1263
ACCURACY - train: 0.9619, test: 0.9638
norm of g = 0.2705
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1309, test: 0.1276
ACCURACY - train: 0.9600, test: 0.9629
norm of g = 0.2866
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1243, test: 0.1254
ACCURACY - train: 0.9652, test: 0.9647
norm of g = 0.3275
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1162, test: 0.1238
ACCURACY - train: 0.9669, test: 0.9648
norm of g = 0.2431
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1259, test: 0.1222
ACCURACY - train: 0.9646, test: 0.9642
norm of g = 0.2626
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1530, test: 0.1205
ACCURACY - train: 0.9600, test: 0.9656
norm of g = 0.3138
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1477, test: 0.1212
ACCURACY - train: 0.9583, test: 0.9663
norm of g = 0.2461
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1334, test: 0.1203
ACCURACY - train: 0.9627, test: 0.9671
norm of g = 0.2996
gamma = 0.2568
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1413, test: 0.1186
ACCURACY - train: 0.9606, test: 0.9664
norm of g = 0.3250
gamma = 0.2977
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1353, test: 0.1205
ACCURACY - train: 0.9625, test: 0.9658
norm of g = 0.2247
gamma = 0.0770
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1284, test: 0.1220
ACCURACY - train: 0.9625, test: 0.9639
norm of g = 0.2982
gamma = 0.4305
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1289, test: 0.1198
ACCURACY - train: 0.9608, test: 0.9648
norm of g = 0.3834
gamma = 0.4259
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1265, test: 0.1190
ACCURACY - train: 0.9625, test: 0.9648
norm of g = 0.2880
gamma = 0.4012
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1278, test: 0.1193
ACCURACY - train: 0.9652, test: 0.9661
norm of g = 0.3536
gamma = 0.3987
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1411, test: 0.1194
ACCURACY - train: 0.9594, test: 0.9649
norm of g = 0.2869
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1333, test: 0.1177
ACCURACY - train: 0.9615, test: 0.9664
norm of g = 0.2152
expanding trust region radius
gamma = 0.3234
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1172, test: 0.1180
ACCURACY - train: 0.9667, test: 0.9661
norm of g = 0.1718
shrinking trust region radius
gamma = 0.3304
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1172, test: 0.1180
ACCURACY - train: 0.9667, test: 0.9661
norm of g = 0.1718
gamma = 0.3798
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1323, test: 0.1170
ACCURACY - train: 0.9606, test: 0.9652
norm of g = 0.3134
gamma = 0.3793
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.1410, test: 0.1160
ACCURACY - train: 0.9575, test: 0.9668
norm of g = 0.4175
gamma = 0.2179
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.1231, test: 0.1148
ACCURACY - train: 0.9633, test: 0.9684
norm of g = 0.2982
gamma = 0.1833
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.1274, test: 0.1164
ACCURACY - train: 0.9631, test: 0.9678
norm of g = 0.3748
gamma = 0.2558
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.1317, test: 0.1130
ACCURACY - train: 0.9633, test: 0.9676
norm of g = 0.3126
gamma = 0.4694
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.1183, test: 0.1135
ACCURACY - train: 0.9702, test: 0.9673
norm of g = 0.2301
gamma = 0.3418
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.1238, test: 0.1136
ACCURACY - train: 0.9675, test: 0.9673
norm of g = 0.3197
gamma = 0.2275
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.1252, test: 0.1139
ACCURACY - train: 0.9650, test: 0.9674
norm of g = 0.2765
gamma = 0.2063
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.1173, test: 0.1142
ACCURACY - train: 0.9644, test: 0.9678
norm of g = 0.2574
gamma = 0.1151
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.1175, test: 0.1157
ACCURACY - train: 0.9642, test: 0.9670
norm of g = 0.2363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.1121, test: 0.1150
ACCURACY - train: 0.9681, test: 0.9678
norm of g = 0.2655
gamma = 0.6368
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.1043, test: 0.1120
ACCURACY - train: 0.9694, test: 0.9685
norm of g = 0.2380
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.1144, test: 0.1111
ACCURACY - train: 0.9698, test: 0.9673
norm of g = 0.2789
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.1403, test: 0.1099
ACCURACY - train: 0.9617, test: 0.9685
norm of g = 0.2680
gamma = 0.1703
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.1342, test: 0.1096
ACCURACY - train: 0.9625, test: 0.9693
norm of g = 0.2018
gamma = 0.5059
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.1222, test: 0.1093
ACCURACY - train: 0.9650, test: 0.9700
norm of g = 0.2938
gamma = 0.5529
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.1300, test: 0.1081
ACCURACY - train: 0.9638, test: 0.9697
norm of g = 0.3629
gamma = 0.5241
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.1225, test: 0.1096
ACCURACY - train: 0.9648, test: 0.9688
norm of g = 0.1883
gamma = 0.4747
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.1157, test: 0.1101
ACCURACY - train: 0.9660, test: 0.9679
norm of g = 0.2762
gamma = 0.0934
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.1176, test: 0.1094
ACCURACY - train: 0.9642, test: 0.9676
norm of g = 0.4033
gamma = 0.0794
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.1159, test: 0.1080
ACCURACY - train: 0.9660, test: 0.9690
norm of g = 0.3492
gamma = 0.5336
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.1155, test: 0.1091
ACCURACY - train: 0.9688, test: 0.9685
norm of g = 0.2674
gamma = 0.5444
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.1293, test: 0.1083
ACCURACY - train: 0.9629, test: 0.9693
norm of g = 0.3166
gamma = 0.7987
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.1223, test: 0.1078
ACCURACY - train: 0.9644, test: 0.9685
norm of g = 0.3011
gamma = 0.4327
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.1080, test: 0.1076
ACCURACY - train: 0.9690, test: 0.9696
norm of g = 0.3098
shrinking trust region radius
gamma = 0.7369
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.1080, test: 0.1076
ACCURACY - train: 0.9690, test: 0.9696
norm of g = 0.3098
gamma = 0.8272
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.1217, test: 0.1075
ACCURACY - train: 0.9660, test: 0.9695
norm of g = 0.2404
expanding trust region radius
gamma = 0.9395
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.1298, test: 0.1070
ACCURACY - train: 0.9608, test: 0.9697
norm of g = 0.3179
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.1127, test: 0.1068
ACCURACY - train: 0.9658, test: 0.9699
norm of g = 0.2263
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.1178, test: 0.1079
ACCURACY - train: 0.9671, test: 0.9705
norm of g = 0.3793
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.1229, test: 0.1052
ACCURACY - train: 0.9646, test: 0.9704
norm of g = 0.4106
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.1102, test: 0.1055
ACCURACY - train: 0.9721, test: 0.9696
norm of g = 0.3210
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.1142, test: 0.1060
ACCURACY - train: 0.9698, test: 0.9698
norm of g = 0.2895
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.1163, test: 0.1059
ACCURACY - train: 0.9677, test: 0.9699
norm of g = 0.3340
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.1086, test: 0.1063
ACCURACY - train: 0.9654, test: 0.9706
norm of g = 0.2991
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.1091, test: 0.1083
ACCURACY - train: 0.9660, test: 0.9685
norm of g = 0.3190
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.1039, test: 0.1067
ACCURACY - train: 0.9702, test: 0.9699
norm of g = 0.2810
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0964, test: 0.1058
ACCURACY - train: 0.9713, test: 0.9698
norm of g = 0.2671
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.1059, test: 0.1033
ACCURACY - train: 0.9715, test: 0.9701
norm of g = 0.2436
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.1306, test: 0.1026
ACCURACY - train: 0.9640, test: 0.9705
norm of g = 0.2743
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.1244, test: 0.1025
ACCURACY - train: 0.9635, test: 0.9710
norm of g = 0.2154
gamma = 0.1695
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.1138, test: 0.1016
ACCURACY - train: 0.9675, test: 0.9725
norm of g = 0.2602
gamma = 0.4046
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.1223, test: 0.1014
ACCURACY - train: 0.9648, test: 0.9708
norm of g = 0.4256
gamma = 0.4237
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.1139, test: 0.1031
ACCURACY - train: 0.9671, test: 0.9700
norm of g = 0.1663
expanding trust region radius
gamma = 0.4450
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.1069, test: 0.1029
ACCURACY - train: 0.9679, test: 0.9702
norm of g = 0.2395
shrinking trust region radius
gamma = 0.6408
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.1069, test: 0.1029
ACCURACY - train: 0.9679, test: 0.9702
norm of g = 0.2395
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.1087, test: 0.1018
ACCURACY - train: 0.9679, test: 0.9704
norm of g = 0.2723
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.1077, test: 0.1011
ACCURACY - train: 0.9696, test: 0.9713
norm of g = 0.2839
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.1076, test: 0.1019
ACCURACY - train: 0.9700, test: 0.9699
norm of g = 0.2947
gamma = 0.2316
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.1213, test: 0.1015
ACCURACY - train: 0.9658, test: 0.9715
norm of g = 0.2905
gamma = 0.7348
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.1150, test: 0.1012
ACCURACY - train: 0.9665, test: 0.9714
norm of g = 0.3206
gamma = 0.5350
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.1005, test: 0.1002
ACCURACY - train: 0.9721, test: 0.9720
norm of g = 0.2272
gamma = 0.5351
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.1143, test: 0.1027
ACCURACY - train: 0.9671, test: 0.9704
norm of g = 0.3345
gamma = 1.2356
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.1211, test: 0.1009
ACCURACY - train: 0.9648, test: 0.9707
norm of g = 0.3696
gamma = 0.7865
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.1042, test: 0.1000
ACCURACY - train: 0.9702, test: 0.9727
norm of g = 0.2729
gamma = 0.3986
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.1092, test: 0.0994
ACCURACY - train: 0.9681, test: 0.9718
norm of g = 0.2984
gamma = 0.2494
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.1143, test: 0.0979
ACCURACY - train: 0.9683, test: 0.9720
norm of g = 0.2982
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.1030, test: 0.0977
ACCURACY - train: 0.9719, test: 0.9720
norm of g = 0.3095
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.1058, test: 0.0978
ACCURACY - train: 0.9708, test: 0.9725
norm of g = 0.2365
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.1078, test: 0.0980
ACCURACY - train: 0.9704, test: 0.9723
norm of g = 0.2904
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0998, test: 0.0995
ACCURACY - train: 0.9677, test: 0.9714
norm of g = 0.2035
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.1000, test: 0.0994
ACCURACY - train: 0.9688, test: 0.9717
norm of g = 0.2483
gamma = 0.0152
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0959, test: 0.0996
ACCURACY - train: 0.9708, test: 0.9719
norm of g = 0.2605
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0895, test: 0.0984
ACCURACY - train: 0.9731, test: 0.9711
norm of g = 0.2772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0986, test: 0.0957
ACCURACY - train: 0.9731, test: 0.9724
norm of g = 0.2128
gamma = 0.4585
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.1219, test: 0.0956
ACCURACY - train: 0.9660, test: 0.9725
norm of g = 0.2637
gamma = 0.2513
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.1161, test: 0.0960
ACCURACY - train: 0.9658, test: 0.9738
norm of g = 0.3088
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.1063, test: 0.0945
ACCURACY - train: 0.9700, test: 0.9740
norm of g = 0.2192
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.1137, test: 0.0949
ACCURACY - train: 0.9665, test: 0.9727
norm of g = 0.3036
gamma = 0.5808
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.1058, test: 0.0954
ACCURACY - train: 0.9687, test: 0.9730
norm of g = 0.2049
gamma = 0.3386
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0993, test: 0.0960
ACCURACY - train: 0.9700, test: 0.9720
norm of g = 0.2511
gamma = 0.5294
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.1017, test: 0.0952
ACCURACY - train: 0.9683, test: 0.9726
norm of g = 0.3336
gamma = 0.5251
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0996, test: 0.0942
ACCURACY - train: 0.9706, test: 0.9729
norm of g = 0.2735
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0995, test: 0.0956
ACCURACY - train: 0.9719, test: 0.9725
norm of g = 0.2643
gamma = 0.5160
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.1126, test: 0.0936
ACCURACY - train: 0.9688, test: 0.9735
norm of g = 0.2074
gamma = 0.1806
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.1064, test: 0.0940
ACCURACY - train: 0.9685, test: 0.9735
norm of g = 0.2448
gamma = 0.4948
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0936, test: 0.0939
ACCURACY - train: 0.9721, test: 0.9740
norm of g = 0.3343
gamma = 0.5604
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.1054, test: 0.0941
ACCURACY - train: 0.9690, test: 0.9742
norm of g = 0.2625
gamma = 0.5447
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.1122, test: 0.0937
ACCURACY - train: 0.9665, test: 0.9742
norm of g = 0.3087
gamma = 0.7193
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0961, test: 0.0936
ACCURACY - train: 0.9712, test: 0.9740
norm of g = 0.2600
gamma = 0.5241
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.1020, test: 0.0933
ACCURACY - train: 0.9704, test: 0.9742
norm of g = 0.3792
gamma = 0.4205
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.1068, test: 0.0905
ACCURACY - train: 0.9715, test: 0.9751
norm of g = 0.2954
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0951, test: 0.0910
ACCURACY - train: 0.9744, test: 0.9741
norm of g = 0.2122
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0983, test: 0.0909
ACCURACY - train: 0.9731, test: 0.9748
norm of g = 0.2485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0995, test: 0.0915
ACCURACY - train: 0.9717, test: 0.9746
norm of g = 0.2263
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0932, test: 0.0925
ACCURACY - train: 0.9715, test: 0.9744
norm of g = 0.3125
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0924, test: 0.0925
ACCURACY - train: 0.9719, test: 0.9734
norm of g = 0.2168
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0897, test: 0.0941
ACCURACY - train: 0.9729, test: 0.9727
norm of g = 0.3010
gamma = 0.6530
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0829, test: 0.0915
ACCURACY - train: 0.9735, test: 0.9740
norm of g = 0.2602
gamma = 0.0252
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0916, test: 0.0893
ACCURACY - train: 0.9740, test: 0.9741
norm of g = 0.2130
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0916, test: 0.0893
ACCURACY - train: 0.9740, test: 0.9741
norm of g = 0.2130
reached to the max num iteration -- BREAK
10 - 50 - preconditioning -- 1
2018-06-28 04:50:05.328853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:50:05.579011: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x43845a0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:50:05.579868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:50:05.861073: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4388a50 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:50:05.861928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:50:06.127648: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x438cf30 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:50:06.128503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:50:06.128820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 04:50:06.128845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 04:50:06.128876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 04:50:06.128890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 04:50:06.128902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 04:50:06.128915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 04:50:06.129136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 04:50:06.129155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 04:50:06.129242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 04:50:06.129252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 04:50:06.129259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 04:50:06.129264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 04:50:06.129270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 04:50:06.129283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 04:50:06.129290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 04:50:06.129297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 04:50:06.129310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3461, test: 2.3512
ACCURACY - train: 0.0988, test: 0.0983
norm of g = 0.7206
Backtracking line search satisfied for alpha = 0.7290
initial gamma = 4.6763
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3162, test: 2.3205
ACCURACY - train: 0.1608, test: 0.1612
norm of g = 0.9667
gamma = 1.1440
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2518, test: 2.2534
ACCURACY - train: 0.3121, test: 0.3032
norm of g = 0.4676
gamma = 0.2585
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1888, test: 2.1853
ACCURACY - train: 0.1067, test: 0.1092
norm of g = 1.1678
shrinking trust region radius
gamma = 0.0512
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.1888, test: 2.1853
ACCURACY - train: 0.1067, test: 0.1092
norm of g = 1.1678
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 2.0050, test: 1.9987
ACCURACY - train: 0.3675, test: 0.3672
norm of g = 1.4190
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.6197, test: 1.6096
ACCURACY - train: 0.5433, test: 0.5543
norm of g = 1.6778
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.1909, test: 1.1551
ACCURACY - train: 0.6275, test: 0.6382
norm of g = 2.3044
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.1909, test: 1.1551
ACCURACY - train: 0.6275, test: 0.6382
norm of g = 2.3044
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.0100, test: 0.9719
ACCURACY - train: 0.7554, test: 0.7766
norm of g = 1.2493
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.8705, test: 0.8638
ACCURACY - train: 0.7575, test: 0.7599
norm of g = 2.5488
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.7333, test: 0.6765
ACCURACY - train: 0.7863, test: 0.8039
norm of g = 2.4105
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.7333, test: 0.6765
ACCURACY - train: 0.7862, test: 0.8039
norm of g = 2.4105
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.6571, test: 0.5995
ACCURACY - train: 0.8187, test: 0.8393
norm of g = 0.9586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.6156, test: 0.5749
ACCURACY - train: 0.8367, test: 0.8455
norm of g = 1.1358
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.5587, test: 0.5442
ACCURACY - train: 0.8433, test: 0.8493
norm of g = 0.7484
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.5587, test: 0.5442
ACCURACY - train: 0.8433, test: 0.8493
norm of g = 0.7484
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.5357, test: 0.5221
ACCURACY - train: 0.8538, test: 0.8580
norm of g = 0.6747
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.5368, test: 0.5074
ACCURACY - train: 0.8500, test: 0.8661
norm of g = 0.5466
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5365, test: 0.4943
ACCURACY - train: 0.8533, test: 0.8686
norm of g = 0.5797
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5173, test: 0.4719
ACCURACY - train: 0.8583, test: 0.8749
norm of g = 0.5193
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.4952, test: 0.4494
ACCURACY - train: 0.8571, test: 0.8758
norm of g = 0.7068
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.4392, test: 0.4064
ACCURACY - train: 0.8758, test: 0.8865
norm of g = 0.6694
gamma = 0.1291
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4075, test: 0.3746
ACCURACY - train: 0.8783, test: 0.8936
norm of g = 0.9622
shrinking trust region radius
gamma = 0.1086
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4075, test: 0.3746
ACCURACY - train: 0.8783, test: 0.8936
norm of g = 0.9622
gamma = 0.3044
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.3816, test: 0.3650
ACCURACY - train: 0.8883, test: 0.8976
norm of g = 0.5320
gamma = 0.3501
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.3606, test: 0.3595
ACCURACY - train: 0.9008, test: 0.8992
norm of g = 0.6265
gamma = 0.3311
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.3690, test: 0.3521
ACCURACY - train: 0.8971, test: 0.8993
norm of g = 0.5317
gamma = 0.3329
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.3689, test: 0.3475
ACCURACY - train: 0.8933, test: 0.9028
norm of g = 0.5820
gamma = 0.3138
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.3518, test: 0.3421
ACCURACY - train: 0.9017, test: 0.9010
norm of g = 0.6290
gamma = 0.3368
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.3518, test: 0.3372
ACCURACY - train: 0.9033, test: 0.9047
norm of g = 0.5714
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3618, test: 0.3324
ACCURACY - train: 0.8987, test: 0.9053
norm of g = 0.7427
gamma = 0.3160
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3636, test: 0.3278
ACCURACY - train: 0.9033, test: 0.9055
norm of g = 0.5531
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3636, test: 0.3278
ACCURACY - train: 0.9033, test: 0.9055
norm of g = 0.5531
gamma = 0.2540
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3711, test: 0.3251
ACCURACY - train: 0.8983, test: 0.9079
norm of g = 0.5970
gamma = 0.2760
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3592, test: 0.3224
ACCURACY - train: 0.8983, test: 0.9101
norm of g = 0.4001
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3358, test: 0.3210
ACCURACY - train: 0.9008, test: 0.9108
norm of g = 0.4316
gamma = 0.0164
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3308, test: 0.3202
ACCURACY - train: 0.9029, test: 0.9098
norm of g = 0.4072
gamma = 0.0160
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3440, test: 0.3190
ACCURACY - train: 0.9004, test: 0.9098
norm of g = 0.3954
expanding trust region radius
gamma = 0.0960
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3609, test: 0.3181
ACCURACY - train: 0.8987, test: 0.9100
norm of g = 0.4072
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3556, test: 0.3147
ACCURACY - train: 0.8987, test: 0.9125
norm of g = 0.3943
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3471, test: 0.3128
ACCURACY - train: 0.8971, test: 0.9126
norm of g = 0.4237
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3682, test: 0.3149
ACCURACY - train: 0.8887, test: 0.9096
norm of g = 0.8156
gamma = 0.3429
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3383, test: 0.3071
ACCURACY - train: 0.8958, test: 0.9145
norm of g = 0.4816
shrinking trust region radius
gamma = 0.3868
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3265, test: 0.3017
ACCURACY - train: 0.9042, test: 0.9140
norm of g = 0.7916
expanding trust region radius
gamma = 0.4009
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3346, test: 0.2990
ACCURACY - train: 0.9083, test: 0.9152
norm of g = 0.5456
gamma = 0.3449
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3424, test: 0.2970
ACCURACY - train: 0.9050, test: 0.9159
norm of g = 0.3803
gamma = 0.3824
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3321, test: 0.2951
ACCURACY - train: 0.9062, test: 0.9168
norm of g = 0.3417
gamma = 0.3180
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3201, test: 0.2930
ACCURACY - train: 0.9058, test: 0.9190
norm of g = 0.4289
expanding trust region radius
gamma = 0.2329
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3254, test: 0.2916
ACCURACY - train: 0.9025, test: 0.9193
norm of g = 0.4034
gamma = 0.2678
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3052, test: 0.2911
ACCURACY - train: 0.9137, test: 0.9172
norm of g = 0.6515
gamma = 0.2584
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.2964, test: 0.2865
ACCURACY - train: 0.9167, test: 0.9175
norm of g = 0.5023
shrinking trust region radius
gamma = 0.2112
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2964, test: 0.2865
ACCURACY - train: 0.9167, test: 0.9175
norm of g = 0.5023
gamma = 0.0413
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.3137, test: 0.2842
ACCURACY - train: 0.9108, test: 0.9186
norm of g = 0.4062
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.3106, test: 0.2832
ACCURACY - train: 0.9133, test: 0.9187
norm of g = 0.3590
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.3007, test: 0.2823
ACCURACY - train: 0.9129, test: 0.9189
norm of g = 0.3219
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2871, test: 0.2808
ACCURACY - train: 0.9133, test: 0.9192
norm of g = 0.3830
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2890, test: 0.2809
ACCURACY - train: 0.9154, test: 0.9184
norm of g = 0.3386
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.3183, test: 0.2798
ACCURACY - train: 0.9112, test: 0.9185
norm of g = 0.5055
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2986, test: 0.2766
ACCURACY - train: 0.9129, test: 0.9214
norm of g = 0.4254
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2630, test: 0.2750
ACCURACY - train: 0.9237, test: 0.9218
norm of g = 0.4969
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2716, test: 0.2711
ACCURACY - train: 0.9225, test: 0.9230
norm of g = 0.3842
gamma = 0.1926
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2881, test: 0.2714
ACCURACY - train: 0.9129, test: 0.9228
norm of g = 0.4071
gamma = 0.1961
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2758, test: 0.2675
ACCURACY - train: 0.9196, test: 0.9224
norm of g = 0.5521
gamma = 0.2358
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2611, test: 0.2608
ACCURACY - train: 0.9283, test: 0.9237
norm of g = 0.4720
gamma = 0.1643
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2717, test: 0.2631
ACCURACY - train: 0.9233, test: 0.9234
norm of g = 0.6181
gamma = 0.1626
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.3104, test: 0.2629
ACCURACY - train: 0.9142, test: 0.9228
norm of g = 0.7775
gamma = 0.2968
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.3234, test: 0.2603
ACCURACY - train: 0.9087, test: 0.9255
norm of g = 0.6096
gamma = 0.3742
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.3023, test: 0.2583
ACCURACY - train: 0.9079, test: 0.9262
norm of g = 0.9095
gamma = 0.4773
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2752, test: 0.2589
ACCURACY - train: 0.9196, test: 0.9229
norm of g = 0.8454
gamma = 0.4900
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2675, test: 0.2564
ACCURACY - train: 0.9212, test: 0.9250
norm of g = 0.8342
gamma = 0.2948
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2808, test: 0.2507
ACCURACY - train: 0.9221, test: 0.9281
norm of g = 0.7097
gamma = 0.3141
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2886, test: 0.2527
ACCURACY - train: 0.9187, test: 0.9253
norm of g = 0.7596
gamma = 0.3919
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2770, test: 0.2501
ACCURACY - train: 0.9212, test: 0.9262
norm of g = 0.5935
gamma = 0.4035
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2689, test: 0.2480
ACCURACY - train: 0.9262, test: 0.9281
norm of g = 0.6318
gamma = 0.4146
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2631, test: 0.2433
ACCURACY - train: 0.9217, test: 0.9291
norm of g = 0.5838
gamma = 0.8019
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2572, test: 0.2411
ACCURACY - train: 0.9200, test: 0.9295
norm of g = 0.4331
gamma = 0.6494
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2494, test: 0.2369
ACCURACY - train: 0.9250, test: 0.9299
norm of g = 0.4899
gamma = 0.1677
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2407, test: 0.2318
ACCURACY - train: 0.9342, test: 0.9325
norm of g = 0.3983
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2541, test: 0.2379
ACCURACY - train: 0.9271, test: 0.9304
norm of g = 0.7259
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2568, test: 0.2333
ACCURACY - train: 0.9246, test: 0.9310
norm of g = 0.5376
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2438, test: 0.2310
ACCURACY - train: 0.9296, test: 0.9323
norm of g = 0.4296
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2465, test: 0.2296
ACCURACY - train: 0.9283, test: 0.9329
norm of g = 0.5049
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2510, test: 0.2281
ACCURACY - train: 0.9279, test: 0.9340
norm of g = 0.5309
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2582, test: 0.2286
ACCURACY - train: 0.9287, test: 0.9330
norm of g = 0.3001
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2706, test: 0.2272
ACCURACY - train: 0.9258, test: 0.9325
norm of g = 0.4198
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2604, test: 0.2288
ACCURACY - train: 0.9242, test: 0.9319
norm of g = 0.6468
gamma = 0.6688
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2332, test: 0.2241
ACCURACY - train: 0.9254, test: 0.9358
norm of g = 0.5865
gamma = 0.4615
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2276, test: 0.2271
ACCURACY - train: 0.9325, test: 0.9343
norm of g = 0.7267
gamma = 0.4704
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.2371, test: 0.2268
ACCURACY - train: 0.9350, test: 0.9330
norm of g = 0.5599
gamma = 0.4906
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.2587, test: 0.2219
ACCURACY - train: 0.9217, test: 0.9354
norm of g = 0.6559
gamma = 0.5170
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2523, test: 0.2159
ACCURACY - train: 0.9246, test: 0.9354
norm of g = 0.4720
gamma = 0.3388
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2345, test: 0.2190
ACCURACY - train: 0.9262, test: 0.9367
norm of g = 0.5134
gamma = 0.3320
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.2548, test: 0.2220
ACCURACY - train: 0.9237, test: 0.9351
norm of g = 0.9296
gamma = 0.3600
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.2368, test: 0.2131
ACCURACY - train: 0.9283, test: 0.9369
norm of g = 0.6926
gamma = 0.4151
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.2254, test: 0.2137
ACCURACY - train: 0.9363, test: 0.9372
norm of g = 0.6512
gamma = 0.3900
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.2303, test: 0.2109
ACCURACY - train: 0.9329, test: 0.9381
norm of g = 0.4374
gamma = 0.2536
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.2462, test: 0.2079
ACCURACY - train: 0.9321, test: 0.9386
norm of g = 0.5195
gamma = 0.3502
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.2384, test: 0.2084
ACCURACY - train: 0.9333, test: 0.9372
norm of g = 0.4697
gamma = 0.3959
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.2190, test: 0.2047
ACCURACY - train: 0.9392, test: 0.9401
norm of g = 0.4440
gamma = 0.3637
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.2230, test: 0.2035
ACCURACY - train: 0.9337, test: 0.9408
norm of g = 0.4914
gamma = 0.3627
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.2094, test: 0.2015
ACCURACY - train: 0.9392, test: 0.9408
norm of g = 0.5741
gamma = 0.3492
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.2117, test: 0.2046
ACCURACY - train: 0.9404, test: 0.9396
norm of g = 0.6956
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.2237, test: 0.1998
ACCURACY - train: 0.9346, test: 0.9400
norm of g = 0.6916
gamma = 0.2736
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.2132, test: 0.1992
ACCURACY - train: 0.9429, test: 0.9427
norm of g = 0.5604
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.2111, test: 0.2025
ACCURACY - train: 0.9350, test: 0.9410
norm of g = 0.6605
gamma = 0.1871
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.2001, test: 0.1950
ACCURACY - train: 0.9350, test: 0.9426
norm of g = 0.6016
gamma = 0.2909
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.2033, test: 0.1977
ACCURACY - train: 0.9400, test: 0.9427
norm of g = 0.6942
gamma = 0.2321
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.2342, test: 0.2008
ACCURACY - train: 0.9379, test: 0.9412
norm of g = 0.7789
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.2142, test: 0.1951
ACCURACY - train: 0.9342, test: 0.9411
norm of g = 0.7282
gamma = 0.0774
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1754, test: 0.1922
ACCURACY - train: 0.9475, test: 0.9433
norm of g = 0.5317
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1816, test: 0.1877
ACCURACY - train: 0.9508, test: 0.9447
norm of g = 0.4647
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1931, test: 0.1858
ACCURACY - train: 0.9404, test: 0.9469
norm of g = 0.3694
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1797, test: 0.1845
ACCURACY - train: 0.9471, test: 0.9450
norm of g = 0.3844
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1718, test: 0.1794
ACCURACY - train: 0.9567, test: 0.9449
norm of g = 0.4350
gamma = 0.1420
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.1878, test: 0.1793
ACCURACY - train: 0.9483, test: 0.9485
norm of g = 0.5709
gamma = 0.0330
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.2234, test: 0.1836
ACCURACY - train: 0.9404, test: 0.9440
norm of g = 0.6638
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.2439, test: 0.1851
ACCURACY - train: 0.9308, test: 0.9459
norm of g = 0.7280
gamma = 0.3297
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.2143, test: 0.1761
ACCURACY - train: 0.9371, test: 0.9498
norm of g = 0.4798
gamma = 0.2570
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1851, test: 0.1761
ACCURACY - train: 0.9433, test: 0.9470
norm of g = 0.5139
shrinking trust region radius
gamma = 0.6166
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1851, test: 0.1761
ACCURACY - train: 0.9433, test: 0.9470
norm of g = 0.5139
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1878, test: 0.1739
ACCURACY - train: 0.9417, test: 0.9474
norm of g = 0.4048
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.2042, test: 0.1723
ACCURACY - train: 0.9375, test: 0.9485
norm of g = 0.3740
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.2092, test: 0.1721
ACCURACY - train: 0.9383, test: 0.9482
norm of g = 0.3966
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.1960, test: 0.1726
ACCURACY - train: 0.9417, test: 0.9486
norm of g = 0.4126
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1849, test: 0.1743
ACCURACY - train: 0.9458, test: 0.9500
norm of g = 0.4613
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1852, test: 0.1725
ACCURACY - train: 0.9454, test: 0.9491
norm of g = 0.3570
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1800, test: 0.1717
ACCURACY - train: 0.9442, test: 0.9482
norm of g = 0.2741
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1793, test: 0.1705
ACCURACY - train: 0.9467, test: 0.9491
norm of g = 0.4123
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1799, test: 0.1679
ACCURACY - train: 0.9512, test: 0.9502
norm of g = 0.4252
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1895, test: 0.1730
ACCURACY - train: 0.9429, test: 0.9480
norm of g = 0.5264
gamma = 0.2987
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1897, test: 0.1726
ACCURACY - train: 0.9421, test: 0.9490
norm of g = 0.4685
shrinking trust region radius
gamma = 0.3588
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1897, test: 0.1726
ACCURACY - train: 0.9421, test: 0.9490
norm of g = 0.4685
gamma = 0.5736
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1785, test: 0.1696
ACCURACY - train: 0.9496, test: 0.9492
norm of g = 0.3405
gamma = 0.6705
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1806, test: 0.1685
ACCURACY - train: 0.9479, test: 0.9498
norm of g = 0.4647
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1816, test: 0.1665
ACCURACY - train: 0.9458, test: 0.9512
norm of g = 0.5040
gamma = 0.0694
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1891, test: 0.1660
ACCURACY - train: 0.9442, test: 0.9512
norm of g = 0.3007
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.2041, test: 0.1669
ACCURACY - train: 0.9404, test: 0.9505
norm of g = 0.4813
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1900, test: 0.1651
ACCURACY - train: 0.9442, test: 0.9516
norm of g = 0.2905
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1675, test: 0.1642
ACCURACY - train: 0.9462, test: 0.9524
norm of g = 0.3517
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1615, test: 0.1650
ACCURACY - train: 0.9533, test: 0.9516
norm of g = 0.3662
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1615, test: 0.1650
ACCURACY - train: 0.9533, test: 0.9516
norm of g = 0.3662
gamma = 0.3827
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1702, test: 0.1639
ACCURACY - train: 0.9537, test: 0.9516
norm of g = 0.3616
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1949, test: 0.1641
ACCURACY - train: 0.9450, test: 0.9506
norm of g = 0.3230
expanding trust region radius
gamma = 0.0908
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1929, test: 0.1616
ACCURACY - train: 0.9442, test: 0.9530
norm of g = 0.3604
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1929, test: 0.1616
ACCURACY - train: 0.9442, test: 0.9530
norm of g = 0.3604
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1736, test: 0.1613
ACCURACY - train: 0.9521, test: 0.9536
norm of g = 0.4511
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1848, test: 0.1624
ACCURACY - train: 0.9462, test: 0.9539
norm of g = 0.3598
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1738, test: 0.1606
ACCURACY - train: 0.9487, test: 0.9543
norm of g = 0.3184
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1652, test: 0.1610
ACCURACY - train: 0.9479, test: 0.9534
norm of g = 0.5965
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1742, test: 0.1615
ACCURACY - train: 0.9521, test: 0.9536
norm of g = 0.5054
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1902, test: 0.1599
ACCURACY - train: 0.9479, test: 0.9532
norm of g = 0.4565
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1832, test: 0.1591
ACCURACY - train: 0.9487, test: 0.9525
norm of g = 0.4682
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1832, test: 0.1591
ACCURACY - train: 0.9487, test: 0.9525
norm of g = 0.4682
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1671, test: 0.1569
ACCURACY - train: 0.9529, test: 0.9539
norm of g = 0.4232
expanding trust region radius
gamma = 0.1844
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1703, test: 0.1564
ACCURACY - train: 0.9533, test: 0.9536
norm of g = 0.3674
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1596, test: 0.1566
ACCURACY - train: 0.9554, test: 0.9540
norm of g = 0.3537
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1608, test: 0.1570
ACCURACY - train: 0.9563, test: 0.9542
norm of g = 0.3066
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1704, test: 0.1565
ACCURACY - train: 0.9537, test: 0.9541
norm of g = 0.4378
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1704, test: 0.1565
ACCURACY - train: 0.9538, test: 0.9541
norm of g = 0.4378
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1638, test: 0.1553
ACCURACY - train: 0.9558, test: 0.9540
norm of g = 0.3124
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1658, test: 0.1552
ACCURACY - train: 0.9500, test: 0.9541
norm of g = 0.3012
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1592, test: 0.1559
ACCURACY - train: 0.9508, test: 0.9544
norm of g = 0.3434
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1580, test: 0.1574
ACCURACY - train: 0.9500, test: 0.9555
norm of g = 0.3501
expanding trust region radius
gamma = 0.3491
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1843, test: 0.1570
ACCURACY - train: 0.9475, test: 0.9537
norm of g = 0.4105
expanding trust region radius
gamma = 0.4750
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1684, test: 0.1547
ACCURACY - train: 0.9529, test: 0.9561
norm of g = 0.4046
shrinking trust region radius
gamma = 0.2174
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1684, test: 0.1547
ACCURACY - train: 0.9529, test: 0.9561
norm of g = 0.4046
gamma = 0.3132
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1359, test: 0.1516
ACCURACY - train: 0.9604, test: 0.9564
norm of g = 0.3347
gamma = 0.3865
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1426, test: 0.1504
ACCURACY - train: 0.9604, test: 0.9566
norm of g = 0.2962
gamma = 0.2434
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1533, test: 0.1486
ACCURACY - train: 0.9525, test: 0.9571
norm of g = 0.2531
expanding trust region radius
gamma = 0.2040
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1406, test: 0.1487
ACCURACY - train: 0.9567, test: 0.9566
norm of g = 0.3004
gamma = 0.1914
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.1374, test: 0.1493
ACCURACY - train: 0.9675, test: 0.9553
norm of g = 0.5565
gamma = 0.3513
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1531, test: 0.1485
ACCURACY - train: 0.9612, test: 0.9565
norm of g = 0.5213
gamma = 0.2994
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1832, test: 0.1500
ACCURACY - train: 0.9517, test: 0.9572
norm of g = 0.4765
gamma = 0.3784
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.2009, test: 0.1469
ACCURACY - train: 0.9433, test: 0.9581
norm of g = 0.5942
shrinking trust region radius
gamma = 0.5744
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.2009, test: 0.1469
ACCURACY - train: 0.9433, test: 0.9581
norm of g = 0.5942
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1783, test: 0.1446
ACCURACY - train: 0.9458, test: 0.9587
norm of g = 0.4186
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1496, test: 0.1442
ACCURACY - train: 0.9525, test: 0.9586
norm of g = 0.3151
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1576, test: 0.1449
ACCURACY - train: 0.9525, test: 0.9585
norm of g = 0.4053
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1751, test: 0.1429
ACCURACY - train: 0.9437, test: 0.9592
norm of g = 0.4056
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1783, test: 0.1430
ACCURACY - train: 0.9437, test: 0.9584
norm of g = 0.5230
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1624, test: 0.1426
ACCURACY - train: 0.9525, test: 0.9594
norm of g = 0.3180
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1493, test: 0.1439
ACCURACY - train: 0.9558, test: 0.9590
norm of g = 0.4040
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1524, test: 0.1467
ACCURACY - train: 0.9525, test: 0.9580
norm of g = 0.5065
gamma = 0.9929
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1480, test: 0.1438
ACCURACY - train: 0.9538, test: 0.9568
norm of g = 0.4726
gamma = 0.8868
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1456, test: 0.1403
ACCURACY - train: 0.9583, test: 0.9579
norm of g = 0.3630
gamma = 0.8782
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1467, test: 0.1398
ACCURACY - train: 0.9563, test: 0.9583
norm of g = 0.4372
shrinking trust region radius
gamma = 0.6992
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1467, test: 0.1398
ACCURACY - train: 0.9562, test: 0.9583
norm of g = 0.4372
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1570, test: 0.1387
ACCURACY - train: 0.9529, test: 0.9594
norm of g = 0.3675
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1577, test: 0.1387
ACCURACY - train: 0.9529, test: 0.9595
norm of g = 0.3348
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1477, test: 0.1385
ACCURACY - train: 0.9579, test: 0.9592
norm of g = 0.2937
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1472, test: 0.1383
ACCURACY - train: 0.9571, test: 0.9598
norm of g = 0.3529
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1472, test: 0.1400
ACCURACY - train: 0.9546, test: 0.9595
norm of g = 0.5905
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1564, test: 0.1388
ACCURACY - train: 0.9537, test: 0.9594
norm of g = 0.4169
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1700, test: 0.1369
ACCURACY - train: 0.9554, test: 0.9600
norm of g = 0.4283
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1587, test: 0.1373
ACCURACY - train: 0.9512, test: 0.9610
norm of g = 0.7033
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1358, test: 0.1380
ACCURACY - train: 0.9588, test: 0.9615
norm of g = 0.4993
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1339, test: 0.1384
ACCURACY - train: 0.9642, test: 0.9614
norm of g = 0.5712
shrinking trust region radius
gamma = 0.3411
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1339, test: 0.1384
ACCURACY - train: 0.9642, test: 0.9614
norm of g = 0.5712
gamma = 0.5846
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1384, test: 0.1357
ACCURACY - train: 0.9608, test: 0.9620
norm of g = 0.4346
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1608, test: 0.1346
ACCURACY - train: 0.9533, test: 0.9619
norm of g = 0.3499
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1612, test: 0.1326
ACCURACY - train: 0.9508, test: 0.9626
norm of g = 0.3886
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1394, test: 0.1332
ACCURACY - train: 0.9617, test: 0.9619
norm of g = 0.4966
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1488, test: 0.1345
ACCURACY - train: 0.9575, test: 0.9631
norm of g = 0.4384
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1392, test: 0.1311
ACCURACY - train: 0.9558, test: 0.9630
norm of g = 0.3215
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1293, test: 0.1297
ACCURACY - train: 0.9604, test: 0.9626
norm of g = 0.4210
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1293, test: 0.1297
ACCURACY - train: 0.9604, test: 0.9626
norm of g = 0.4210
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1404, test: 0.1304
ACCURACY - train: 0.9604, test: 0.9625
norm of g = 0.2515
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1613, test: 0.1303
ACCURACY - train: 0.9550, test: 0.9632
norm of g = 0.4401
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1544, test: 0.1293
ACCURACY - train: 0.9537, test: 0.9631
norm of g = 0.3228
gamma = 0.4960
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1374, test: 0.1295
ACCURACY - train: 0.9613, test: 0.9633
norm of g = 0.3590
gamma = 0.1925
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1402, test: 0.1295
ACCURACY - train: 0.9596, test: 0.9627
norm of g = 0.3685
gamma = 0.7000
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.1309, test: 0.1292
ACCURACY - train: 0.9625, test: 0.9618
norm of g = 0.3082
expanding trust region radius
gamma = 0.6970
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.1331, test: 0.1296
ACCURACY - train: 0.9633, test: 0.9619
norm of g = 0.2838
gamma = 1.2210
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.1418, test: 0.1300
ACCURACY - train: 0.9592, test: 0.9629
norm of g = 0.5387
gamma = 0.0898
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.1334, test: 0.1323
ACCURACY - train: 0.9654, test: 0.9638
norm of g = 0.4572
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.1334, test: 0.1323
ACCURACY - train: 0.9654, test: 0.9637
norm of g = 0.4572
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.1360, test: 0.1294
ACCURACY - train: 0.9613, test: 0.9635
norm of g = 0.2735
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.1311, test: 0.1284
ACCURACY - train: 0.9575, test: 0.9633
norm of g = 0.3124
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.1276, test: 0.1308
ACCURACY - train: 0.9558, test: 0.9635
norm of g = 0.3094
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.1494, test: 0.1293
ACCURACY - train: 0.9558, test: 0.9642
norm of g = 0.4744
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.1393, test: 0.1267
ACCURACY - train: 0.9587, test: 0.9649
norm of g = 0.4258
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.1393, test: 0.1267
ACCURACY - train: 0.9588, test: 0.9649
norm of g = 0.4258
gamma = 0.0646
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.1123, test: 0.1248
ACCURACY - train: 0.9696, test: 0.9649
norm of g = 0.3363
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.1171, test: 0.1238
ACCURACY - train: 0.9692, test: 0.9652
norm of g = 0.2737
gamma = 0.3032
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.1254, test: 0.1230
ACCURACY - train: 0.9613, test: 0.9663
norm of g = 0.2770
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.1141, test: 0.1228
ACCURACY - train: 0.9650, test: 0.9664
norm of g = 0.3314
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.1110, test: 0.1222
ACCURACY - train: 0.9721, test: 0.9642
norm of g = 0.3461
gamma = 0.0663
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.1253, test: 0.1209
ACCURACY - train: 0.9658, test: 0.9659
norm of g = 0.3053
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.1533, test: 0.1218
ACCURACY - train: 0.9596, test: 0.9655
norm of g = 0.3186
expanding trust region radius
gamma = 0.8003
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.1715, test: 0.1220
ACCURACY - train: 0.9521, test: 0.9659
norm of g = 0.3382
gamma = 1.1513
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.1498, test: 0.1224
ACCURACY - train: 0.9533, test: 0.9654
norm of g = 0.5706
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.1264, test: 0.1234
ACCURACY - train: 0.9617, test: 0.9646
norm of g = 0.6615
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.1362, test: 0.1210
ACCURACY - train: 0.9633, test: 0.9669
norm of g = 0.4233
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.1525, test: 0.1194
ACCURACY - train: 0.9546, test: 0.9670
norm of g = 0.4292
gamma = 0.2207
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.1514, test: 0.1192
ACCURACY - train: 0.9575, test: 0.9659
norm of g = 0.3669
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.1382, test: 0.1212
ACCURACY - train: 0.9629, test: 0.9663
norm of g = 0.3343
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.1229, test: 0.1215
ACCURACY - train: 0.9642, test: 0.9658
norm of g = 0.4425
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.1250, test: 0.1199
ACCURACY - train: 0.9600, test: 0.9676
norm of g = 0.3769
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.1225, test: 0.1196
ACCURACY - train: 0.9629, test: 0.9652
norm of g = 0.2815
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.1224, test: 0.1191
ACCURACY - train: 0.9638, test: 0.9643
norm of g = 0.3319
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.1268, test: 0.1168
ACCURACY - train: 0.9604, test: 0.9655
norm of g = 0.4266
gamma = 0.9303
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.1351, test: 0.1224
ACCURACY - train: 0.9596, test: 0.9642
norm of g = 0.4148
gamma = 0.0917
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.1358, test: 0.1223
ACCURACY - train: 0.9583, test: 0.9661
norm of g = 0.5596
gamma = 0.2283
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.1232, test: 0.1194
ACCURACY - train: 0.9650, test: 0.9666
norm of g = 0.4194
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.1248, test: 0.1219
ACCURACY - train: 0.9642, test: 0.9648
norm of g = 0.6010
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.1213, test: 0.1161
ACCURACY - train: 0.9613, test: 0.9675
norm of g = 0.4277
gamma = 0.1106
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.1344, test: 0.1181
ACCURACY - train: 0.9633, test: 0.9666
norm of g = 0.5582
gamma = 0.2301
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.1487, test: 0.1176
ACCURACY - train: 0.9579, test: 0.9654
norm of g = 0.6722
gamma = 0.3211
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.1333, test: 0.1188
ACCURACY - train: 0.9617, test: 0.9671
norm of g = 0.5259
gamma = 0.2912
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.1150, test: 0.1181
ACCURACY - train: 0.9650, test: 0.9665
norm of g = 0.5763
gamma = 0.2925
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.1140, test: 0.1169
ACCURACY - train: 0.9696, test: 0.9672
norm of g = 0.4974
shrinking trust region radius
gamma = 0.8773
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.1140, test: 0.1169
ACCURACY - train: 0.9696, test: 0.9672
norm of g = 0.4974
gamma = 0.9185
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.1169, test: 0.1147
ACCURACY - train: 0.9696, test: 0.9683
norm of g = 0.3830
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.1377, test: 0.1139
ACCURACY - train: 0.9617, test: 0.9682
norm of g = 0.3378
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.1379, test: 0.1124
ACCURACY - train: 0.9571, test: 0.9682
norm of g = 0.3670
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.1171, test: 0.1122
ACCURACY - train: 0.9658, test: 0.9688
norm of g = 0.4492
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.1247, test: 0.1130
ACCURACY - train: 0.9642, test: 0.9690
norm of g = 0.3181
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.1174, test: 0.1116
ACCURACY - train: 0.9642, test: 0.9695
norm of g = 0.2940
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.1078, test: 0.1112
ACCURACY - train: 0.9658, test: 0.9689
norm of g = 0.3506
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.1217, test: 0.1143
ACCURACY - train: 0.9667, test: 0.9692
norm of g = 0.5192
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.1419, test: 0.1126
ACCURACY - train: 0.9600, test: 0.9692
norm of g = 0.5173
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.1334, test: 0.1102
ACCURACY - train: 0.9617, test: 0.9686
norm of g = 0.2776
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.1170, test: 0.1104
ACCURACY - train: 0.9688, test: 0.9691
norm of g = 0.3805
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.1197, test: 0.1145
ACCURACY - train: 0.9658, test: 0.9668
norm of g = 0.4640
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.1113, test: 0.1131
ACCURACY - train: 0.9692, test: 0.9657
norm of g = 0.4917
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.1159, test: 0.1128
ACCURACY - train: 0.9688, test: 0.9676
norm of g = 0.6073
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.1171, test: 0.1102
ACCURACY - train: 0.9671, test: 0.9680
norm of g = 0.3701
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.1114, test: 0.1126
ACCURACY - train: 0.9679, test: 0.9675
norm of g = 0.3507
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.1139, test: 0.1100
ACCURACY - train: 0.9667, test: 0.9696
norm of g = 0.3154
shrinking trust region radius
gamma = 0.4445
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.1139, test: 0.1100
ACCURACY - train: 0.9667, test: 0.9696
norm of g = 0.3154
expanding trust region radius
gamma = 0.4474
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.1106, test: 0.1090
ACCURACY - train: 0.9638, test: 0.9691
norm of g = 0.3683
shrinking trust region radius
gamma = 0.5921
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.1106, test: 0.1090
ACCURACY - train: 0.9638, test: 0.9691
norm of g = 0.3683
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.1057, test: 0.1086
ACCURACY - train: 0.9654, test: 0.9686
norm of g = 0.3390
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.1251, test: 0.1086
ACCURACY - train: 0.9629, test: 0.9693
norm of g = 0.2772
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.1210, test: 0.1080
ACCURACY - train: 0.9625, test: 0.9691
norm of g = 0.3260
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0953, test: 0.1071
ACCURACY - train: 0.9742, test: 0.9696
norm of g = 0.3216
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0989, test: 0.1070
ACCURACY - train: 0.9704, test: 0.9701
norm of g = 0.3821
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.1043, test: 0.1063
ACCURACY - train: 0.9654, test: 0.9703
norm of g = 0.2947
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0956, test: 0.1067
ACCURACY - train: 0.9704, test: 0.9693
norm of g = 0.3650
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0940, test: 0.1026
ACCURACY - train: 0.9729, test: 0.9713
norm of g = 0.4008
shrinking trust region radius
gamma = 0.4141
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0940, test: 0.1026
ACCURACY - train: 0.9729, test: 0.9713
norm of g = 0.4008
gamma = 0.6171
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.1081, test: 0.1017
ACCURACY - train: 0.9688, test: 0.9714
norm of g = 0.2995
gamma = 0.5073
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.1318, test: 0.1017
ACCURACY - train: 0.9613, test: 0.9716
norm of g = 0.3161
gamma = 0.6720
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.1470, test: 0.1020
ACCURACY - train: 0.9562, test: 0.9722
norm of g = 0.2891
expanding trust region radius
gamma = 0.7850
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.1269, test: 0.1017
ACCURACY - train: 0.9604, test: 0.9716
norm of g = 0.3225
expanding trust region radius
gamma = 0.6503
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.1035, test: 0.1022
ACCURACY - train: 0.9700, test: 0.9713
norm of g = 0.3439
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.1206, test: 0.1066
ACCURACY - train: 0.9708, test: 0.9680
norm of g = 0.5719
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.1380, test: 0.1058
ACCURACY - train: 0.9608, test: 0.9691
norm of g = 0.7233
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.1337, test: 0.1030
ACCURACY - train: 0.9579, test: 0.9699
norm of g = 0.5740
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.1337, test: 0.1030
ACCURACY - train: 0.9579, test: 0.9699
norm of g = 0.5740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.1219, test: 0.1012
ACCURACY - train: 0.9633, test: 0.9710
norm of g = 0.4740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.1031, test: 0.1017
ACCURACY - train: 0.9717, test: 0.9709
norm of g = 0.2883
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.1053, test: 0.1021
ACCURACY - train: 0.9675, test: 0.9710
norm of g = 0.2604
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.1049, test: 0.1016
ACCURACY - train: 0.9683, test: 0.9704
norm of g = 0.2740
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.1036, test: 0.1010
ACCURACY - train: 0.9688, test: 0.9705
norm of g = 0.2720
gamma = 0.1806
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.1083, test: 0.1014
ACCURACY - train: 0.9654, test: 0.9711
norm of g = 0.4067
shrinking trust region radius
gamma = 0.8777
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.1083, test: 0.1014
ACCURACY - train: 0.9654, test: 0.9711
norm of g = 0.4067
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.1190, test: 0.1004
ACCURACY - train: 0.9638, test: 0.9716
norm of g = 0.4081
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.1157, test: 0.1005
ACCURACY - train: 0.9629, test: 0.9709
norm of g = 0.3703
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.1050, test: 0.1004
ACCURACY - train: 0.9704, test: 0.9714
norm of g = 0.3178
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.1042, test: 0.1019
ACCURACY - train: 0.9708, test: 0.9721
norm of g = 0.3577
reached to the max num iteration -- BREAK
10 - 100 - preconditioning -- 1
2018-06-28 04:58:38.704150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:58:38.991187: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x5263d90 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:58:38.992402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:58:39.270954: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x5268230 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:58:39.271852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:58:39.525773: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x528c770 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 04:58:39.526684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 04:58:39.526996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 04:58:39.527023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 04:58:39.527060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 04:58:39.527078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 04:58:39.527095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 04:58:39.527112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 04:58:39.527350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 04:58:39.527381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 04:58:39.527485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 04:58:39.527497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 04:58:39.527504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 04:58:39.527510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 04:58:39.527516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 04:58:39.527536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 04:58:39.527546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 04:58:39.527554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 04:58:39.527562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.4420, test: 2.4270
ACCURACY - train: 0.0967, test: 0.1035
norm of g = 1.0443
Backtracking line search satisfied for alpha = 1.0000
initial gamma = 1.4307
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.2853, test: 2.2899
ACCURACY - train: 0.1117, test: 0.1035
norm of g = 0.5036
gamma = 0.7282
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2306, test: 2.2412
ACCURACY - train: 0.1267, test: 0.1115
norm of g = 0.6575
gamma = 0.3818
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.0842, test: 2.1280
ACCURACY - train: 0.1375, test: 0.1165
norm of g = 3.1537
shrinking trust region radius
gamma = 0.1815
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.0842, test: 2.1280
ACCURACY - train: 0.1375, test: 0.1165
norm of g = 3.1537
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 4
LOSS     - train: 2.0842, test: 2.1280
ACCURACY - train: 0.1375, test: 0.1165
norm of g = 3.1537
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.8391, test: 1.8446
ACCURACY - train: 0.4433, test: 0.4316
norm of g = 1.3161
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.6967, test: 1.6861
ACCURACY - train: 0.5425, test: 0.5315
norm of g = 1.1832
expanding trust region radius
no need for safe gaurding
gamma = 1.1247
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.5307, test: 1.5339
ACCURACY - train: 0.6633, test: 0.6643
norm of g = 1.1555
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.2608, test: 1.2562
ACCURACY - train: 0.7067, test: 0.7131
norm of g = 1.3472
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.0278, test: 1.0038
ACCURACY - train: 0.7483, test: 0.7579
norm of g = 1.3743
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 10
LOSS     - train: 1.0278, test: 1.0038
ACCURACY - train: 0.7483, test: 0.7579
norm of g = 1.3743
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.8793, test: 0.8829
ACCURACY - train: 0.7875, test: 0.7900
norm of g = 1.0916
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.8185, test: 0.7851
ACCURACY - train: 0.7833, test: 0.8033
norm of g = 1.4014
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.7529, test: 0.7010
ACCURACY - train: 0.8050, test: 0.8223
norm of g = 1.0371
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.6398, test: 0.6181
ACCURACY - train: 0.8258, test: 0.8347
norm of g = 0.9408
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6070, test: 0.5737
ACCURACY - train: 0.8175, test: 0.8314
norm of g = 1.2406
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.5597, test: 0.5237
ACCURACY - train: 0.8375, test: 0.8449
norm of g = 1.2488
shrinking trust region radius
gamma = 0.0552
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.5597, test: 0.5237
ACCURACY - train: 0.8375, test: 0.8449
norm of g = 1.2488
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5313, test: 0.4973
ACCURACY - train: 0.8450, test: 0.8551
norm of g = 0.9334
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.4956, test: 0.4796
ACCURACY - train: 0.8525, test: 0.8668
norm of g = 0.7302
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.4810, test: 0.4574
ACCURACY - train: 0.8600, test: 0.8677
norm of g = 0.6693
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.4522, test: 0.4390
ACCURACY - train: 0.8717, test: 0.8734
norm of g = 0.6230
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4811, test: 0.4315
ACCURACY - train: 0.8575, test: 0.8662
norm of g = 0.8749
gamma = 0.0759
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4798, test: 0.4142
ACCURACY - train: 0.8608, test: 0.8778
norm of g = 0.8698
shrinking trust region radius
gamma = 0.0821
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4798, test: 0.4142
ACCURACY - train: 0.8608, test: 0.8778
norm of g = 0.8698
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4446, test: 0.4092
ACCURACY - train: 0.8625, test: 0.8803
norm of g = 0.7272
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4490, test: 0.4032
ACCURACY - train: 0.8700, test: 0.8830
norm of g = 0.8174
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4384, test: 0.3959
ACCURACY - train: 0.8658, test: 0.8832
norm of g = 0.5267
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4335, test: 0.3937
ACCURACY - train: 0.8683, test: 0.8836
norm of g = 0.6684
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4070, test: 0.3856
ACCURACY - train: 0.8825, test: 0.8880
norm of g = 0.5668
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3765, test: 0.3753
ACCURACY - train: 0.8825, test: 0.8920
norm of g = 0.6481
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3707, test: 0.3594
ACCURACY - train: 0.8833, test: 0.8948
norm of g = 0.6067
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3603, test: 0.3549
ACCURACY - train: 0.8917, test: 0.8945
norm of g = 0.8655
gamma = 0.4243
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3424, test: 0.3517
ACCURACY - train: 0.9100, test: 0.9011
norm of g = 0.5227
gamma = 0.3367
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3728, test: 0.3449
ACCURACY - train: 0.8858, test: 0.8991
norm of g = 0.9862
shrinking trust region radius
gamma = 0.2683
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3728, test: 0.3449
ACCURACY - train: 0.8858, test: 0.8991
norm of g = 0.9862
gamma = 0.3215
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3620, test: 0.3341
ACCURACY - train: 0.8858, test: 0.9030
norm of g = 0.6829
expanding trust region radius
gamma = 0.2686
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3595, test: 0.3294
ACCURACY - train: 0.8983, test: 0.9043
norm of g = 0.6407
gamma = 0.3794
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3739, test: 0.3320
ACCURACY - train: 0.8967, test: 0.9020
norm of g = 0.5721
gamma = 0.3995
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3603, test: 0.3258
ACCURACY - train: 0.8992, test: 0.9041
norm of g = 0.6069
gamma = 0.3747
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3515, test: 0.3225
ACCURACY - train: 0.8958, test: 0.9084
norm of g = 0.7106
gamma = 0.6488
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3436, test: 0.3207
ACCURACY - train: 0.9008, test: 0.9031
norm of g = 0.8097
gamma = 0.6642
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3299, test: 0.3128
ACCURACY - train: 0.9008, test: 0.9079
norm of g = 0.5993
gamma = 0.9177
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3373, test: 0.3103
ACCURACY - train: 0.8950, test: 0.9100
norm of g = 0.5485
gamma = 0.9567
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3382, test: 0.3117
ACCURACY - train: 0.8958, test: 0.9077
norm of g = 0.7334
gamma = 0.7381
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3310, test: 0.3036
ACCURACY - train: 0.8942, test: 0.9087
norm of g = 0.6042
gamma = 0.6095
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3313, test: 0.3028
ACCURACY - train: 0.8933, test: 0.9096
norm of g = 0.5660
gamma = 0.6148
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.2931, test: 0.2990
ACCURACY - train: 0.9167, test: 0.9122
norm of g = 0.4715
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.2808, test: 0.2986
ACCURACY - train: 0.9242, test: 0.9115
norm of g = 0.5600
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.2876, test: 0.2912
ACCURACY - train: 0.9175, test: 0.9144
norm of g = 0.5105
gamma = 0.3474
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3140, test: 0.2944
ACCURACY - train: 0.9092, test: 0.9125
norm of g = 0.4078
expanding trust region radius
gamma = 0.2751
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.3088, test: 0.2883
ACCURACY - train: 0.9158, test: 0.9166
norm of g = 0.6156
shrinking trust region radius
gamma = 0.3870
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2953, test: 0.2910
ACCURACY - train: 0.9133, test: 0.9131
norm of g = 1.0917
gamma = 0.3507
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2908, test: 0.2819
ACCURACY - train: 0.9133, test: 0.9173
norm of g = 0.7700
gamma = 0.5935
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2588, test: 0.2780
ACCURACY - train: 0.9267, test: 0.9178
norm of g = 0.6239
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2803, test: 0.2768
ACCURACY - train: 0.9275, test: 0.9189
norm of g = 0.5905
gamma = 0.4807
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2958, test: 0.2769
ACCURACY - train: 0.9142, test: 0.9200
norm of g = 0.5403
expanding trust region radius
gamma = 0.4211
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.3072, test: 0.2749
ACCURACY - train: 0.9042, test: 0.9210
norm of g = 0.6781
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.3141, test: 0.2765
ACCURACY - train: 0.9083, test: 0.9198
norm of g = 0.5941
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2787, test: 0.2742
ACCURACY - train: 0.9258, test: 0.9195
norm of g = 0.6032
shrinking trust region radius
gamma = 0.5323
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2787, test: 0.2742
ACCURACY - train: 0.9258, test: 0.9195
norm of g = 0.6032
gamma = 0.5308
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2822, test: 0.2720
ACCURACY - train: 0.9275, test: 0.9193
norm of g = 0.4567
expanding trust region radius
gamma = 0.4619
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.3194, test: 0.2704
ACCURACY - train: 0.9133, test: 0.9195
norm of g = 0.6402
gamma = 0.7148
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.3210, test: 0.2742
ACCURACY - train: 0.9125, test: 0.9185
norm of g = 0.8180
gamma = 0.8309
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.3011, test: 0.2729
ACCURACY - train: 0.9158, test: 0.9194
norm of g = 0.7600
gamma = 1.0276
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2711, test: 0.2649
ACCURACY - train: 0.9150, test: 0.9236
norm of g = 0.6703
gamma = 0.4431
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2794, test: 0.2624
ACCURACY - train: 0.9092, test: 0.9248
norm of g = 0.5773
gamma = 0.4397
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2853, test: 0.2657
ACCURACY - train: 0.9150, test: 0.9205
norm of g = 0.7568
gamma = 0.9207
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2418, test: 0.2686
ACCURACY - train: 0.9308, test: 0.9212
norm of g = 0.7170
gamma = 0.3277
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2378, test: 0.2609
ACCURACY - train: 0.9292, test: 0.9235
norm of g = 0.9587
gamma = 0.4213
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2604, test: 0.2676
ACCURACY - train: 0.9267, test: 0.9216
norm of g = 0.9611
gamma = 0.2078
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2785, test: 0.2592
ACCURACY - train: 0.9250, test: 0.9234
norm of g = 0.6771
gamma = 0.2960
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2672, test: 0.2523
ACCURACY - train: 0.9267, test: 0.9261
norm of g = 0.4784
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2664, test: 0.2503
ACCURACY - train: 0.9167, test: 0.9273
norm of g = 0.4160
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.3092, test: 0.2519
ACCURACY - train: 0.9158, test: 0.9273
norm of g = 0.5535
gamma = 0.3272
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2819, test: 0.2476
ACCURACY - train: 0.9208, test: 0.9284
norm of g = 0.4666
gamma = 0.3062
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2626, test: 0.2421
ACCURACY - train: 0.9250, test: 0.9300
norm of g = 0.5509
gamma = 0.1160
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2905, test: 0.2474
ACCURACY - train: 0.9033, test: 0.9284
norm of g = 0.6644
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2905, test: 0.2474
ACCURACY - train: 0.9033, test: 0.9284
norm of g = 0.6644
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2787, test: 0.2444
ACCURACY - train: 0.9108, test: 0.9287
norm of g = 0.4503
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2697, test: 0.2419
ACCURACY - train: 0.9192, test: 0.9294
norm of g = 0.5794
expanding trust region radius
gamma = 0.2889
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2871, test: 0.2387
ACCURACY - train: 0.9200, test: 0.9320
norm of g = 0.7043
gamma = 0.2878
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2574, test: 0.2397
ACCURACY - train: 0.9225, test: 0.9299
norm of g = 0.5325
gamma = 0.3096
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2337, test: 0.2370
ACCURACY - train: 0.9267, test: 0.9290
norm of g = 0.6165
shrinking trust region radius
gamma = 0.3352
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2622, test: 0.2429
ACCURACY - train: 0.9200, test: 0.9286
norm of g = 0.9521
expanding trust region radius
gamma = 0.5869
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2602, test: 0.2365
ACCURACY - train: 0.9250, test: 0.9303
norm of g = 0.7359
gamma = 0.6851
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2374, test: 0.2328
ACCURACY - train: 0.9383, test: 0.9316
norm of g = 0.4598
gamma = 0.7928
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2548, test: 0.2308
ACCURACY - train: 0.9292, test: 0.9339
norm of g = 0.5673
expanding trust region radius
gamma = 0.8975
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.2698, test: 0.2318
ACCURACY - train: 0.9258, test: 0.9323
norm of g = 0.4906
gamma = 0.5282
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.2810, test: 0.2306
ACCURACY - train: 0.9258, test: 0.9321
norm of g = 0.5554
gamma = 0.4818
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2751, test: 0.2312
ACCURACY - train: 0.9217, test: 0.9308
norm of g = 0.7939
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2324, test: 0.2256
ACCURACY - train: 0.9367, test: 0.9341
norm of g = 0.4952
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.2397, test: 0.2270
ACCURACY - train: 0.9275, test: 0.9349
norm of g = 0.5751
gamma = 0.8089
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.2465, test: 0.2247
ACCURACY - train: 0.9225, test: 0.9341
norm of g = 0.5670
gamma = 0.5042
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.2362, test: 0.2259
ACCURACY - train: 0.9275, test: 0.9333
norm of g = 0.6566
gamma = 0.6816
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.2412, test: 0.2248
ACCURACY - train: 0.9208, test: 0.9340
norm of g = 0.4785
gamma = 0.7094
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.2262, test: 0.2196
ACCURACY - train: 0.9383, test: 0.9361
norm of g = 0.4938
expanding trust region radius
gamma = 0.5381
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.2046, test: 0.2179
ACCURACY - train: 0.9375, test: 0.9369
norm of g = 0.5113
shrinking trust region radius
gamma = 0.5708
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.2046, test: 0.2179
ACCURACY - train: 0.9375, test: 0.9369
norm of g = 0.5113
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.2145, test: 0.2163
ACCURACY - train: 0.9400, test: 0.9368
norm of g = 0.3979
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.2353, test: 0.2158
ACCURACY - train: 0.9333, test: 0.9381
norm of g = 0.5431
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.2449, test: 0.2218
ACCURACY - train: 0.9283, test: 0.9350
norm of g = 0.8309
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.2398, test: 0.2186
ACCURACY - train: 0.9267, test: 0.9389
norm of g = 0.7915
gamma = 0.0209
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.2472, test: 0.2161
ACCURACY - train: 0.9217, test: 0.9370
norm of g = 0.8319
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.2472, test: 0.2161
ACCURACY - train: 0.9217, test: 0.9370
norm of g = 0.8319
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.2276, test: 0.2138
ACCURACY - train: 0.9308, test: 0.9374
norm of g = 0.6513
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.2072, test: 0.2112
ACCURACY - train: 0.9383, test: 0.9393
norm of g = 0.4574
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.2163, test: 0.2109
ACCURACY - train: 0.9325, test: 0.9389
norm of g = 0.3615
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.2066, test: 0.2122
ACCURACY - train: 0.9325, test: 0.9397
norm of g = 0.5376
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1906, test: 0.2113
ACCURACY - train: 0.9375, test: 0.9394
norm of g = 0.4880
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.2130, test: 0.2184
ACCURACY - train: 0.9350, test: 0.9389
norm of g = 0.5525
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.2286, test: 0.2141
ACCURACY - train: 0.9333, test: 0.9383
norm of g = 1.0051
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.2099, test: 0.2050
ACCURACY - train: 0.9425, test: 0.9415
norm of g = 0.4578
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.2473, test: 0.2076
ACCURACY - train: 0.9275, test: 0.9382
norm of g = 0.7023
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.2223, test: 0.2061
ACCURACY - train: 0.9367, test: 0.9396
norm of g = 0.6463
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.2223, test: 0.2061
ACCURACY - train: 0.9367, test: 0.9396
norm of g = 0.6463
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1947, test: 0.2032
ACCURACY - train: 0.9433, test: 0.9411
norm of g = 0.6689
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.2014, test: 0.1995
ACCURACY - train: 0.9425, test: 0.9421
norm of g = 0.6450
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1810, test: 0.1974
ACCURACY - train: 0.9533, test: 0.9435
norm of g = 0.5309
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1701, test: 0.1984
ACCURACY - train: 0.9575, test: 0.9431
norm of g = 0.5231
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.2072, test: 0.1995
ACCURACY - train: 0.9450, test: 0.9431
norm of g = 0.6238
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.2178, test: 0.1987
ACCURACY - train: 0.9400, test: 0.9439
norm of g = 0.5089
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.2154, test: 0.1938
ACCURACY - train: 0.9350, test: 0.9447
norm of g = 0.9000
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.2154, test: 0.1938
ACCURACY - train: 0.9350, test: 0.9447
norm of g = 0.9000
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.2061, test: 0.1921
ACCURACY - train: 0.9433, test: 0.9455
norm of g = 0.5948
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1948, test: 0.1919
ACCURACY - train: 0.9442, test: 0.9459
norm of g = 0.5426
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.2002, test: 0.1906
ACCURACY - train: 0.9400, test: 0.9460
norm of g = 0.4277
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1951, test: 0.1907
ACCURACY - train: 0.9450, test: 0.9454
norm of g = 0.4080
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1948, test: 0.1918
ACCURACY - train: 0.9417, test: 0.9449
norm of g = 0.4021
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.2056, test: 0.1919
ACCURACY - train: 0.9375, test: 0.9458
norm of g = 0.4759
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.2482, test: 0.1923
ACCURACY - train: 0.9292, test: 0.9441
norm of g = 0.5171
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.2602, test: 0.1909
ACCURACY - train: 0.9308, test: 0.9444
norm of g = 0.5084
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.2505, test: 0.1960
ACCURACY - train: 0.9300, test: 0.9444
norm of g = 0.8111
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.2348, test: 0.1889
ACCURACY - train: 0.9383, test: 0.9445
norm of g = 0.6904
gamma = 0.9715
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.2118, test: 0.1884
ACCURACY - train: 0.9383, test: 0.9452
norm of g = 0.4869
expanding trust region radius
gamma = 0.7447
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.2113, test: 0.1879
ACCURACY - train: 0.9317, test: 0.9454
norm of g = 0.5622
shrinking trust region radius
gamma = 0.7270
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.2113, test: 0.1879
ACCURACY - train: 0.9317, test: 0.9454
norm of g = 0.5622
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1988, test: 0.1845
ACCURACY - train: 0.9383, test: 0.9475
norm of g = 0.4889
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1731, test: 0.1835
ACCURACY - train: 0.9475, test: 0.9462
norm of g = 0.3802
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1893, test: 0.1838
ACCURACY - train: 0.9483, test: 0.9468
norm of g = 0.4615
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.2137, test: 0.1871
ACCURACY - train: 0.9325, test: 0.9442
norm of g = 0.9928
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.2029, test: 0.1860
ACCURACY - train: 0.9392, test: 0.9467
norm of g = 0.6930
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.2131, test: 0.1895
ACCURACY - train: 0.9367, test: 0.9464
norm of g = 0.7772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.2077, test: 0.1876
ACCURACY - train: 0.9367, test: 0.9458
norm of g = 0.6025
gamma = 0.1408
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.2089, test: 0.1815
ACCURACY - train: 0.9392, test: 0.9494
norm of g = 0.7425
gamma = 0.0956
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.2046, test: 0.1911
ACCURACY - train: 0.9375, test: 0.9464
norm of g = 0.8106
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1958, test: 0.1873
ACCURACY - train: 0.9350, test: 0.9455
norm of g = 0.8231
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1973, test: 0.1775
ACCURACY - train: 0.9425, test: 0.9497
norm of g = 0.5478
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1908, test: 0.1792
ACCURACY - train: 0.9475, test: 0.9468
norm of g = 0.6916
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.1863, test: 0.1795
ACCURACY - train: 0.9425, test: 0.9484
norm of g = 0.7358
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1973, test: 0.1795
ACCURACY - train: 0.9367, test: 0.9475
norm of g = 0.7560
gamma = 0.7644
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1915, test: 0.1763
ACCURACY - train: 0.9475, test: 0.9487
norm of g = 0.7935
gamma = 1.1750
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.1801, test: 0.1761
ACCURACY - train: 0.9442, test: 0.9495
norm of g = 0.5020
expanding trust region radius
gamma = 1.2638
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.1931, test: 0.1716
ACCURACY - train: 0.9367, test: 0.9518
norm of g = 0.4656
shrinking trust region radius
gamma = 1.2270
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1931, test: 0.1716
ACCURACY - train: 0.9367, test: 0.9518
norm of g = 0.4656
expanding trust region radius
gamma = 0.9071
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1809, test: 0.1700
ACCURACY - train: 0.9475, test: 0.9517
norm of g = 0.5485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1601, test: 0.1735
ACCURACY - train: 0.9567, test: 0.9494
norm of g = 0.4581
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1724, test: 0.1734
ACCURACY - train: 0.9550, test: 0.9482
norm of g = 0.5066
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1949, test: 0.1728
ACCURACY - train: 0.9483, test: 0.9485
norm of g = 0.3785
expanding trust region radius
gamma = 0.0169
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.1895, test: 0.1725
ACCURACY - train: 0.9458, test: 0.9489
norm of g = 0.4962
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.1848, test: 0.1750
ACCURACY - train: 0.9458, test: 0.9493
norm of g = 0.8705
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.1806, test: 0.1697
ACCURACY - train: 0.9442, test: 0.9520
norm of g = 0.7190
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.1501, test: 0.1674
ACCURACY - train: 0.9625, test: 0.9521
norm of g = 0.5792
gamma = 0.0669
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.1708, test: 0.1687
ACCURACY - train: 0.9567, test: 0.9514
norm of g = 0.5781
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.1837, test: 0.1715
ACCURACY - train: 0.9508, test: 0.9502
norm of g = 0.6313
gamma = 0.9830
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.1903, test: 0.1663
ACCURACY - train: 0.9383, test: 0.9526
norm of g = 0.8127
gamma = 0.9802
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.1973, test: 0.1657
ACCURACY - train: 0.9433, test: 0.9510
norm of g = 0.6594
gamma = 1.2410
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1751, test: 0.1661
ACCURACY - train: 0.9533, test: 0.9522
norm of g = 0.5149
gamma = 1.4879
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1876, test: 0.1736
ACCURACY - train: 0.9475, test: 0.9480
norm of g = 0.6834
gamma = 1.7979
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.2128, test: 0.1659
ACCURACY - train: 0.9392, test: 0.9521
norm of g = 0.7350
gamma = 2.6815
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.2123, test: 0.1643
ACCURACY - train: 0.9425, test: 0.9515
norm of g = 0.6103
gamma = 1.2199
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1904, test: 0.1590
ACCURACY - train: 0.9483, test: 0.9533
norm of g = 0.4745
expanding trust region radius
gamma = 1.0332
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1602, test: 0.1604
ACCURACY - train: 0.9492, test: 0.9541
norm of g = 0.5155
gamma = 1.2801
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.1679, test: 0.1703
ACCURACY - train: 0.9458, test: 0.9528
norm of g = 0.7508
gamma = 1.1401
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.1742, test: 0.1632
ACCURACY - train: 0.9442, test: 0.9496
norm of g = 0.7603
gamma = 1.1343
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.1495, test: 0.1697
ACCURACY - train: 0.9575, test: 0.9493
norm of g = 1.0444
gamma = 1.1499
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.1441, test: 0.1728
ACCURACY - train: 0.9600, test: 0.9511
norm of g = 0.8932
gamma = 0.6121
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.1427, test: 0.1592
ACCURACY - train: 0.9558, test: 0.9529
norm of g = 0.5233
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.1427, test: 0.1592
ACCURACY - train: 0.9558, test: 0.9529
norm of g = 0.5233
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.1577, test: 0.1535
ACCURACY - train: 0.9575, test: 0.9548
norm of g = 0.3791
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1536, test: 0.1555
ACCURACY - train: 0.9592, test: 0.9544
norm of g = 0.5201
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.1536, test: 0.1555
ACCURACY - train: 0.9592, test: 0.9544
norm of g = 0.5201
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.1650, test: 0.1517
ACCURACY - train: 0.9525, test: 0.9567
norm of g = 0.4978
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.2118, test: 0.1528
ACCURACY - train: 0.9342, test: 0.9541
norm of g = 0.5005
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.1861, test: 0.1510
ACCURACY - train: 0.9508, test: 0.9565
norm of g = 0.5480
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.1613, test: 0.1509
ACCURACY - train: 0.9558, test: 0.9564
norm of g = 0.7698
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.1829, test: 0.1571
ACCURACY - train: 0.9417, test: 0.9555
norm of g = 0.8556
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.1686, test: 0.1557
ACCURACY - train: 0.9508, test: 0.9544
norm of g = 0.7906
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.1616, test: 0.1474
ACCURACY - train: 0.9508, test: 0.9588
norm of g = 0.5689
gamma = 0.9424
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.1810, test: 0.1497
ACCURACY - train: 0.9442, test: 0.9581
norm of g = 0.8062
gamma = 0.9587
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.1610, test: 0.1464
ACCURACY - train: 0.9500, test: 0.9581
norm of g = 0.6048
gamma = 0.9587
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.1411, test: 0.1446
ACCURACY - train: 0.9575, test: 0.9578
norm of g = 0.5340
gamma = 0.9447
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.1523, test: 0.1452
ACCURACY - train: 0.9558, test: 0.9582
norm of g = 0.5047
gamma = 1.0083
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.1483, test: 0.1435
ACCURACY - train: 0.9567, test: 0.9600
norm of g = 0.4262
gamma = 0.4677
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1416, test: 0.1449
ACCURACY - train: 0.9575, test: 0.9592
norm of g = 0.4365
expanding trust region radius
gamma = 0.8049
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1593, test: 0.1445
ACCURACY - train: 0.9575, test: 0.9596
norm of g = 0.6241
gamma = 0.6286
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.1782, test: 0.1540
ACCURACY - train: 0.9508, test: 0.9530
norm of g = 0.7816
gamma = 0.8918
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.1914, test: 0.1519
ACCURACY - train: 0.9433, test: 0.9530
norm of g = 0.9385
shrinking trust region radius
gamma = 1.0013
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.1914, test: 0.1519
ACCURACY - train: 0.9433, test: 0.9530
norm of g = 0.9385
gamma = 0.9230
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.1772, test: 0.1443
ACCURACY - train: 0.9467, test: 0.9561
norm of g = 0.5153
expanding trust region radius
gamma = 0.9615
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.1450, test: 0.1410
ACCURACY - train: 0.9550, test: 0.9594
norm of g = 0.4562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.1455, test: 0.1406
ACCURACY - train: 0.9592, test: 0.9590
norm of g = 0.4816
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.1464, test: 0.1411
ACCURACY - train: 0.9550, test: 0.9587
norm of g = 0.4530
gamma = 0.5050
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.1445, test: 0.1394
ACCURACY - train: 0.9575, test: 0.9596
norm of g = 0.4498
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.1557, test: 0.1424
ACCURACY - train: 0.9558, test: 0.9591
norm of g = 0.6980
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.1426, test: 0.1426
ACCURACY - train: 0.9625, test: 0.9590
norm of g = 0.7452
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.1198, test: 0.1401
ACCURACY - train: 0.9625, test: 0.9587
norm of g = 0.3850
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.1342, test: 0.1389
ACCURACY - train: 0.9658, test: 0.9579
norm of g = 0.5890
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.1535, test: 0.1374
ACCURACY - train: 0.9508, test: 0.9604
norm of g = 0.7026
gamma = 0.4915
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.1572, test: 0.1379
ACCURACY - train: 0.9533, test: 0.9604
norm of g = 0.8939
gamma = 0.5399
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.1474, test: 0.1385
ACCURACY - train: 0.9592, test: 0.9617
norm of g = 0.7023
gamma = 0.5701
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.1581, test: 0.1346
ACCURACY - train: 0.9550, test: 0.9602
norm of g = 0.6746
gamma = 0.6910
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.1442, test: 0.1373
ACCURACY - train: 0.9600, test: 0.9586
norm of g = 0.9057
gamma = 0.9323
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.1247, test: 0.1315
ACCURACY - train: 0.9625, test: 0.9602
norm of g = 0.4580
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.1373, test: 0.1360
ACCURACY - train: 0.9567, test: 0.9618
norm of g = 0.4906
gamma = 0.5982
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.1238, test: 0.1343
ACCURACY - train: 0.9625, test: 0.9609
norm of g = 0.5187
gamma = 0.5724
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.1176, test: 0.1379
ACCURACY - train: 0.9592, test: 0.9604
norm of g = 0.6996
gamma = 0.9304
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.1349, test: 0.1414
ACCURACY - train: 0.9533, test: 0.9615
norm of g = 0.7031
gamma = 1.2709
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.1412, test: 0.1352
ACCURACY - train: 0.9558, test: 0.9625
norm of g = 0.5627
gamma = 0.4920
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.1318, test: 0.1308
ACCURACY - train: 0.9617, test: 0.9620
norm of g = 0.4666
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.1622, test: 0.1358
ACCURACY - train: 0.9492, test: 0.9607
norm of g = 0.6211
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.1500, test: 0.1326
ACCURACY - train: 0.9567, test: 0.9611
norm of g = 0.6047
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.1217, test: 0.1284
ACCURACY - train: 0.9658, test: 0.9626
norm of g = 0.5963
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.1220, test: 0.1272
ACCURACY - train: 0.9717, test: 0.9639
norm of g = 0.5069
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.1090, test: 0.1272
ACCURACY - train: 0.9742, test: 0.9641
norm of g = 0.4721
gamma = 0.9417
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.1006, test: 0.1330
ACCURACY - train: 0.9683, test: 0.9622
norm of g = 0.6496
gamma = 0.8675
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.1356, test: 0.1341
ACCURACY - train: 0.9575, test: 0.9603
norm of g = 0.8096
gamma = 0.3288
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.1394, test: 0.1260
ACCURACY - train: 0.9625, test: 0.9631
norm of g = 0.5351
gamma = 0.6456
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.1333, test: 0.1256
ACCURACY - train: 0.9583, test: 0.9656
norm of g = 0.6320
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.1256, test: 0.1256
ACCURACY - train: 0.9625, test: 0.9640
norm of g = 0.4907
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.1155, test: 0.1261
ACCURACY - train: 0.9658, test: 0.9625
norm of g = 0.7150
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.1191, test: 0.1238
ACCURACY - train: 0.9667, test: 0.9625
norm of g = 0.5092
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.1214, test: 0.1213
ACCURACY - train: 0.9667, test: 0.9651
norm of g = 0.5651
gamma = 0.5013
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.1186, test: 0.1237
ACCURACY - train: 0.9658, test: 0.9643
norm of g = 0.5353
gamma = 0.8023
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.1332, test: 0.1202
ACCURACY - train: 0.9600, test: 0.9657
norm of g = 0.4261
gamma = 1.5819
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.1661, test: 0.1220
ACCURACY - train: 0.9533, test: 0.9646
norm of g = 0.4972
gamma = 1.0557
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.1738, test: 0.1232
ACCURACY - train: 0.9533, test: 0.9663
norm of g = 0.5987
gamma = 0.5054
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.1711, test: 0.1223
ACCURACY - train: 0.9500, test: 0.9656
norm of g = 0.6648
gamma = 1.3569
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.1570, test: 0.1189
ACCURACY - train: 0.9550, test: 0.9646
norm of g = 0.5993
gamma = 1.5246
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.1282, test: 0.1209
ACCURACY - train: 0.9583, test: 0.9648
norm of g = 0.4340
expanding trust region radius
gamma = 1.5346
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.1289, test: 0.1178
ACCURACY - train: 0.9583, test: 0.9658
norm of g = 0.4493
shrinking trust region radius
gamma = 1.2810
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.1279, test: 0.1262
ACCURACY - train: 0.9650, test: 0.9648
norm of g = 0.8208
gamma = 1.0336
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.1095, test: 0.1179
ACCURACY - train: 0.9742, test: 0.9663
norm of g = 0.5273
gamma = 0.7214
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.1277, test: 0.1163
ACCURACY - train: 0.9717, test: 0.9665
norm of g = 0.4803
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.1540, test: 0.1140
ACCURACY - train: 0.9550, test: 0.9665
norm of g = 0.5404
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.1443, test: 0.1139
ACCURACY - train: 0.9600, test: 0.9678
norm of g = 0.5371
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.1380, test: 0.1149
ACCURACY - train: 0.9617, test: 0.9665
norm of g = 0.6853
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.1396, test: 0.1144
ACCURACY - train: 0.9617, test: 0.9656
norm of g = 0.4122
gamma = 0.2074
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.1419, test: 0.1153
ACCURACY - train: 0.9542, test: 0.9668
norm of g = 0.6412
gamma = 0.1631
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.1258, test: 0.1159
ACCURACY - train: 0.9567, test: 0.9664
norm of g = 0.4070
expanding trust region radius
gamma = 0.4408
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.1178, test: 0.1167
ACCURACY - train: 0.9650, test: 0.9658
norm of g = 0.4085
gamma = 1.2336
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.1257, test: 0.1160
ACCURACY - train: 0.9600, test: 0.9666
norm of g = 0.4543
gamma = 2.6830
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.1258, test: 0.1210
ACCURACY - train: 0.9608, test: 0.9667
norm of g = 0.8735
gamma = 1.8473
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.1195, test: 0.1189
ACCURACY - train: 0.9592, test: 0.9635
norm of g = 0.6048
gamma = 0.2777
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.1291, test: 0.1150
ACCURACY - train: 0.9633, test: 0.9651
norm of g = 0.5298
gamma = 0.2551
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.1257, test: 0.1146
ACCURACY - train: 0.9675, test: 0.9670
norm of g = 0.7870
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.1133, test: 0.1156
ACCURACY - train: 0.9633, test: 0.9646
norm of g = 0.4918
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.1230, test: 0.1135
ACCURACY - train: 0.9675, test: 0.9663
norm of g = 0.3930
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.1200, test: 0.1164
ACCURACY - train: 0.9667, test: 0.9644
norm of g = 0.5772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.1044, test: 0.1110
ACCURACY - train: 0.9708, test: 0.9668
norm of g = 0.3745
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.1173, test: 0.1134
ACCURACY - train: 0.9700, test: 0.9683
norm of g = 0.4064
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.1353, test: 0.1174
ACCURACY - train: 0.9592, test: 0.9650
norm of g = 0.3611
gamma = 0.8248
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.1271, test: 0.1163
ACCURACY - train: 0.9575, test: 0.9655
norm of g = 0.5660
gamma = 0.8125
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.1299, test: 0.1187
ACCURACY - train: 0.9583, test: 0.9665
norm of g = 0.9102
gamma = 0.3449
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.1175, test: 0.1194
ACCURACY - train: 0.9633, test: 0.9640
norm of g = 0.8867
shrinking trust region radius
gamma = 1.2824
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.1175, test: 0.1194
ACCURACY - train: 0.9633, test: 0.9640
norm of g = 0.8867
expanding trust region radius
gamma = 1.0390
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0999, test: 0.1129
ACCURACY - train: 0.9717, test: 0.9682
norm of g = 0.5751
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.1153, test: 0.1149
ACCURACY - train: 0.9675, test: 0.9656
norm of g = 0.6830
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.1232, test: 0.1147
ACCURACY - train: 0.9658, test: 0.9678
norm of g = 0.5346
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.1244, test: 0.1103
ACCURACY - train: 0.9583, test: 0.9681
norm of g = 0.5800
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.1355, test: 0.1134
ACCURACY - train: 0.9608, test: 0.9662
norm of g = 0.7035
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.1213, test: 0.1106
ACCURACY - train: 0.9642, test: 0.9663
norm of g = 0.5513
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.1343, test: 0.1211
ACCURACY - train: 0.9575, test: 0.9633
norm of g = 0.7044
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.1558, test: 0.1143
ACCURACY - train: 0.9508, test: 0.9676
norm of g = 0.9211
gamma = 2.0774
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.1502, test: 0.1100
ACCURACY - train: 0.9617, test: 0.9677
norm of g = 0.5434
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.1358, test: 0.1072
ACCURACY - train: 0.9658, test: 0.9680
norm of g = 0.4825
gamma = 2.1689
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.1058, test: 0.1072
ACCURACY - train: 0.9733, test: 0.9700
norm of g = 0.5042
gamma = 2.1325
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.1034, test: 0.1077
ACCURACY - train: 0.9717, test: 0.9691
norm of g = 0.3684
gamma = 0.8322
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.1125, test: 0.1082
ACCURACY - train: 0.9675, test: 0.9668
norm of g = 0.4586
gamma = 0.6806
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0915, test: 0.1103
ACCURACY - train: 0.9767, test: 0.9667
norm of g = 0.4739
gamma = 0.8574
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0903, test: 0.1081
ACCURACY - train: 0.9758, test: 0.9690
norm of g = 0.4434
gamma = 0.6082
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0984, test: 0.1101
ACCURACY - train: 0.9725, test: 0.9671
norm of g = 0.7120
gamma = 0.4610
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.1053, test: 0.1073
ACCURACY - train: 0.9733, test: 0.9671
norm of g = 0.4104
gamma = 0.4887
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.1049, test: 0.1081
ACCURACY - train: 0.9692, test: 0.9676
norm of g = 0.4630
gamma = 0.4813
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.1177, test: 0.1073
ACCURACY - train: 0.9625, test: 0.9692
norm of g = 0.7389
gamma = 0.5095
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.1558, test: 0.1106
ACCURACY - train: 0.9558, test: 0.9671
norm of g = 0.5512
gamma = 0.4834
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.1317, test: 0.1053
ACCURACY - train: 0.9608, test: 0.9703
norm of g = 0.4983
gamma = 0.5339
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.1119, test: 0.1041
ACCURACY - train: 0.9692, test: 0.9696
norm of g = 0.6760
gamma = 1.1527
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.1222, test: 0.1051
ACCURACY - train: 0.9642, test: 0.9708
norm of g = 0.4396
gamma = 1.3164
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.1108, test: 0.1052
ACCURACY - train: 0.9683, test: 0.9692
norm of g = 0.4630
expanding trust region radius
gamma = 0.5760
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.1137, test: 0.1053
ACCURACY - train: 0.9633, test: 0.9708
norm of g = 0.5266
gamma = 0.5743
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.1219, test: 0.1075
ACCURACY - train: 0.9667, test: 0.9692
norm of g = 0.7275
gamma = 0.8976
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.1053, test: 0.1036
ACCURACY - train: 0.9650, test: 0.9694
norm of g = 0.6274
shrinking trust region radius
gamma = 0.7311
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.1053, test: 0.1036
ACCURACY - train: 0.9650, test: 0.9694
norm of g = 0.6274
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0978, test: 0.1011
ACCURACY - train: 0.9717, test: 0.9708
norm of g = 0.4928
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.1036, test: 0.1012
ACCURACY - train: 0.9708, test: 0.9710
norm of g = 0.4368
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.1002, test: 0.1015
ACCURACY - train: 0.9725, test: 0.9714
norm of g = 0.3257
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0956, test: 0.1008
ACCURACY - train: 0.9750, test: 0.9725
norm of g = 0.3703
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.1145, test: 0.1037
ACCURACY - train: 0.9708, test: 0.9709
norm of g = 0.5910
gamma = 0.0113
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.1305, test: 0.1033
ACCURACY - train: 0.9633, test: 0.9709
norm of g = 0.5732
gamma = 0.0948
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.1360, test: 0.0997
ACCURACY - train: 0.9550, test: 0.9708
norm of g = 0.3910
reached to the max num iteration -- BREAK
20 - 2 - preconditioning -- 1
2018-06-28 05:05:41.045504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 05:05:41.350234: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x50da350 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 05:05:41.351402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 05:05:41.637883: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x50de830 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 05:05:41.638754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 05:05:41.933306: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x50e2d10 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 05:05:41.934261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 05:05:41.934582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 05:05:41.934609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 05:05:41.934653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 05:05:41.934672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 05:05:41.934688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 05:05:41.934703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 05:05:41.934955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 05:05:41.934977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 05:05:41.935085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 05:05:41.935097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 05:05:41.935105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 05:05:41.935119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 05:05:41.935126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 05:05:41.935142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 05:05:41.935151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 05:05:41.935159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 05:05:41.935165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3772, test: 2.3783
ACCURACY - train: 0.0974, test: 0.0982
norm of g = 1.0076
Backtracking line search satisfied for alpha = 0.5905
initial gamma = 4.7849
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3262, test: 2.3248
ACCURACY - train: 0.1082, test: 0.1062
norm of g = 1.0913
gamma = 1.5784
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2639, test: 2.2637
ACCURACY - train: 0.2190, test: 0.2141
norm of g = 0.4543
gamma = 0.3914
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.2147, test: 2.2112
ACCURACY - train: 0.3177, test: 0.3248
norm of g = 0.6222
shrinking trust region radius
gamma = 0.0948
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.2147, test: 2.2112
ACCURACY - train: 0.3177, test: 0.3248
norm of g = 0.6222
no need for safe gaurding
gamma = 4.9129
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 2.0115, test: 2.0059
ACCURACY - train: 0.4915, test: 0.5003
norm of g = 1.1334
expanding trust region radius
no need for safe gaurding
gamma = 3.3808
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.7328, test: 1.7230
ACCURACY - train: 0.4670, test: 0.4705
norm of g = 2.2640
no need for safe gaurding
gamma = 1.1343
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.3310, test: 1.3123
ACCURACY - train: 0.5612, test: 0.5641
norm of g = 5.8204
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.3310, test: 1.3123
ACCURACY - train: 0.5612, test: 0.5641
norm of g = 5.8204
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.3310, test: 1.3123
ACCURACY - train: 0.5612, test: 0.5641
norm of g = 5.8204
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.0730, test: 1.0494
ACCURACY - train: 0.6700, test: 0.6804
norm of g = 2.4388
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 10
LOSS     - train: 1.0730, test: 1.0494
ACCURACY - train: 0.6700, test: 0.6804
norm of g = 2.4388
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 1.0083, test: 0.9832
ACCURACY - train: 0.7040, test: 0.7169
norm of g = 1.6187
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.9465, test: 0.9206
ACCURACY - train: 0.7449, test: 0.7560
norm of g = 1.6348
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.8901, test: 0.8634
ACCURACY - train: 0.7574, test: 0.7714
norm of g = 1.5664
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.8467, test: 0.8164
ACCURACY - train: 0.7604, test: 0.7744
norm of g = 1.5819
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.7919, test: 0.7630
ACCURACY - train: 0.7783, test: 0.7917
norm of g = 1.2478
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.7649, test: 0.7355
ACCURACY - train: 0.7905, test: 0.8032
norm of g = 1.9637
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.7338, test: 0.7057
ACCURACY - train: 0.7886, test: 0.7981
norm of g = 2.2862
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.7017, test: 0.6712
ACCURACY - train: 0.7898, test: 0.7996
norm of g = 1.8139
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.7017, test: 0.6712
ACCURACY - train: 0.7898, test: 0.7996
norm of g = 1.8139
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.6783, test: 0.6483
ACCURACY - train: 0.8056, test: 0.8167
norm of g = 1.0376
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.6548, test: 0.6252
ACCURACY - train: 0.8193, test: 0.8314
norm of g = 0.6841
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.6360, test: 0.6059
ACCURACY - train: 0.8231, test: 0.8344
norm of g = 0.6096
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.5999, test: 0.5702
ACCURACY - train: 0.8323, test: 0.8439
norm of g = 0.5252
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.5675, test: 0.5325
ACCURACY - train: 0.8351, test: 0.8469
norm of g = 1.8395
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.5132, test: 0.4811
ACCURACY - train: 0.8480, test: 0.8615
norm of g = 1.6510
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.5132, test: 0.4811
ACCURACY - train: 0.8480, test: 0.8615
norm of g = 1.6510
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4870, test: 0.4562
ACCURACY - train: 0.8594, test: 0.8705
norm of g = 0.6780
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4792, test: 0.4498
ACCURACY - train: 0.8620, test: 0.8748
norm of g = 0.9064
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4650, test: 0.4351
ACCURACY - train: 0.8664, test: 0.8785
norm of g = 0.4612
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4589, test: 0.4301
ACCURACY - train: 0.8680, test: 0.8775
norm of g = 0.7646
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4462, test: 0.4168
ACCURACY - train: 0.8718, test: 0.8822
norm of g = 0.4972
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.4371, test: 0.4072
ACCURACY - train: 0.8740, test: 0.8856
norm of g = 0.5234
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.4265, test: 0.3982
ACCURACY - train: 0.8774, test: 0.8887
norm of g = 0.3329
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.4193, test: 0.3873
ACCURACY - train: 0.8762, test: 0.8878
norm of g = 1.1902
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3930, test: 0.3654
ACCURACY - train: 0.8863, test: 0.8965
norm of g = 0.3878
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3930, test: 0.3654
ACCURACY - train: 0.8863, test: 0.8965
norm of g = 0.3878
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3888, test: 0.3611
ACCURACY - train: 0.8866, test: 0.8981
norm of g = 0.3696
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3857, test: 0.3574
ACCURACY - train: 0.8876, test: 0.8995
norm of g = 0.4640
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3808, test: 0.3531
ACCURACY - train: 0.8892, test: 0.9006
norm of g = 0.2450
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3768, test: 0.3492
ACCURACY - train: 0.8903, test: 0.9016
norm of g = 0.2390
no need for safe gaurding
gamma = 2.3380
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3728, test: 0.3454
ACCURACY - train: 0.8915, test: 0.9032
norm of g = 0.2258
no need for safe gaurding
gamma = 2.1590
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3689, test: 0.3416
ACCURACY - train: 0.8929, test: 0.9052
norm of g = 0.2270
no need for safe gaurding
gamma = 2.0138
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3650, test: 0.3379
ACCURACY - train: 0.8940, test: 0.9058
norm of g = 0.2196
no need for safe gaurding
gamma = 4.0033
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3612, test: 0.3342
ACCURACY - train: 0.8949, test: 0.9067
norm of g = 0.2162
expanding trust region radius
no need for safe gaurding
gamma = 2.7060
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3575, test: 0.3306
ACCURACY - train: 0.8960, test: 0.9078
norm of g = 0.2151
no need for safe gaurding
gamma = 3.4234
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3502, test: 0.3234
ACCURACY - train: 0.8980, test: 0.9089
norm of g = 0.2202
no need for safe gaurding
gamma = 1.4306
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.3432, test: 0.3171
ACCURACY - train: 0.9004, test: 0.9110
norm of g = 0.2408
no need for safe gaurding
gamma = 1.3340
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3363, test: 0.3101
ACCURACY - train: 0.9020, test: 0.9124
norm of g = 0.2359
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3303, test: 0.3037
ACCURACY - train: 0.9031, test: 0.9133
norm of g = 0.3731
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3229, test: 0.2972
ACCURACY - train: 0.9055, test: 0.9147
norm of g = 0.1897
expanding trust region radius
no need for safe gaurding
gamma = 4.7430
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.3103, test: 0.2848
ACCURACY - train: 0.9091, test: 0.9179
norm of g = 0.2246
expanding trust region radius
no need for safe gaurding
gamma = 2.0504
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2888, test: 0.2650
ACCURACY - train: 0.9155, test: 0.9223
norm of g = 0.5138
no need for safe gaurding
gamma = 4.3189
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2478, test: 0.2258
ACCURACY - train: 0.9277, test: 0.9343
norm of g = 0.2918
no need for safe gaurding
gamma = 3.7971
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2202, test: 0.1956
ACCURACY - train: 0.9357, test: 0.9434
norm of g = 0.5105
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2202, test: 0.1956
ACCURACY - train: 0.9357, test: 0.9434
norm of g = 0.5105
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2202, test: 0.1956
ACCURACY - train: 0.9357, test: 0.9434
norm of g = 0.5105
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2168, test: 0.1950
ACCURACY - train: 0.9362, test: 0.9433
norm of g = 0.3221
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2143, test: 0.1936
ACCURACY - train: 0.9373, test: 0.9443
norm of g = 0.2042
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2124, test: 0.1909
ACCURACY - train: 0.9379, test: 0.9441
norm of g = 0.2411
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2106, test: 0.1895
ACCURACY - train: 0.9385, test: 0.9460
norm of g = 0.2514
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2106, test: 0.1895
ACCURACY - train: 0.9385, test: 0.9460
norm of g = 0.2514
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2098, test: 0.1889
ACCURACY - train: 0.9385, test: 0.9453
norm of g = 0.1329
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2088, test: 0.1877
ACCURACY - train: 0.9387, test: 0.9453
norm of g = 0.1294
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2078, test: 0.1871
ACCURACY - train: 0.9390, test: 0.9456
norm of g = 0.1179
expanding trust region radius
no need for safe gaurding
gamma = 1.6833
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2068, test: 0.1862
ACCURACY - train: 0.9394, test: 0.9460
norm of g = 0.1152
expanding trust region radius
no need for safe gaurding
gamma = 1.5153
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2049, test: 0.1843
ACCURACY - train: 0.9400, test: 0.9476
norm of g = 0.1420
expanding trust region radius
no need for safe gaurding
gamma = 5.3913
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2010, test: 0.1808
ACCURACY - train: 0.9413, test: 0.9486
norm of g = 0.1125
no need for safe gaurding
gamma = 12.4344
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.1936, test: 0.1739
ACCURACY - train: 0.9436, test: 0.9505
norm of g = 0.1053
no need for safe gaurding
gamma = 13.5217
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.1864, test: 0.1673
ACCURACY - train: 0.9460, test: 0.9525
norm of g = 0.1080
no need for safe gaurding
gamma = 8.2417
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.1797, test: 0.1610
ACCURACY - train: 0.9479, test: 0.9544
norm of g = 0.1266
no need for safe gaurding
gamma = 5.9125
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.1731, test: 0.1551
ACCURACY - train: 0.9498, test: 0.9566
norm of g = 0.1206
no need for safe gaurding
gamma = 4.6356
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.1670, test: 0.1490
ACCURACY - train: 0.9513, test: 0.9585
norm of g = 0.1793
no need for safe gaurding
gamma = 2.6499
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.1610, test: 0.1441
ACCURACY - train: 0.9535, test: 0.9603
norm of g = 0.1581
no need for safe gaurding
gamma = 3.6541
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.1553, test: 0.1393
ACCURACY - train: 0.9554, test: 0.9608
norm of g = 0.1645
no need for safe gaurding
gamma = 1.3562
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.1501, test: 0.1332
ACCURACY - train: 0.9565, test: 0.9625
norm of g = 0.2352
no need for safe gaurding
gamma = 3.1534
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.1441, test: 0.1283
ACCURACY - train: 0.9587, test: 0.9652
norm of g = 0.1186
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.1441, test: 0.1283
ACCURACY - train: 0.9587, test: 0.9652
norm of g = 0.1186
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.1429, test: 0.1275
ACCURACY - train: 0.9589, test: 0.9646
norm of g = 0.1341
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.1408, test: 0.1266
ACCURACY - train: 0.9596, test: 0.9653
norm of g = 0.2681
expanding trust region radius
no need for safe gaurding
gamma = 1.0504
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.1376, test: 0.1229
ACCURACY - train: 0.9604, test: 0.9664
norm of g = 0.0853
expanding trust region radius
no need for safe gaurding
gamma = 3.0872
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.1331, test: 0.1189
ACCURACY - train: 0.9616, test: 0.9672
norm of g = 0.2519
no need for safe gaurding
gamma = 6.7455
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.1235, test: 0.1096
ACCURACY - train: 0.9645, test: 0.9684
norm of g = 0.1278
no need for safe gaurding
gamma = 16.4732
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.1151, test: 0.1019
ACCURACY - train: 0.9671, test: 0.9709
norm of g = 0.0801
no need for safe gaurding
gamma = 20.0498
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.1076, test: 0.0951
ACCURACY - train: 0.9688, test: 0.9728
norm of g = 0.0598
no need for safe gaurding
gamma = 21.3107
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.1009, test: 0.0888
ACCURACY - train: 0.9708, test: 0.9738
norm of g = 0.0590
expanding trust region radius
no need for safe gaurding
gamma = 21.0338
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.0951, test: 0.0833
ACCURACY - train: 0.9724, test: 0.9750
norm of g = 0.0625
expanding trust region radius
no need for safe gaurding
gamma = 21.6776
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.0858, test: 0.0738
ACCURACY - train: 0.9744, test: 0.9775
norm of g = 0.0874
expanding trust region radius
no need for safe gaurding
gamma = 21.4606
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.0771, test: 0.0646
ACCURACY - train: 0.9770, test: 0.9800
norm of g = 0.2272
no need for safe gaurding
gamma = 7.3775
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.0758, test: 0.0628
ACCURACY - train: 0.9769, test: 0.9799
norm of g = 0.1495
no need for safe gaurding
gamma = 5.2056
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.0749, test: 0.0602
ACCURACY - train: 0.9771, test: 0.9816
norm of g = 0.2424
no need for safe gaurding
gamma = 4.2215
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.0735, test: 0.0613
ACCURACY - train: 0.9775, test: 0.9803
norm of g = 0.3562
shrinking trust region radius
no need for safe gaurding
gamma = 1.7523
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.0735, test: 0.0613
ACCURACY - train: 0.9775, test: 0.9803
norm of g = 0.3562
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.0735, test: 0.0613
ACCURACY - train: 0.9775, test: 0.9803
norm of g = 0.3562
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.0735, test: 0.0613
ACCURACY - train: 0.9775, test: 0.9803
norm of g = 0.3562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.0717, test: 0.0576
ACCURACY - train: 0.9782, test: 0.9815
norm of g = 0.2764
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.0709, test: 0.0578
ACCURACY - train: 0.9783, test: 0.9811
norm of g = 0.2820
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.0709, test: 0.0578
ACCURACY - train: 0.9783, test: 0.9811
norm of g = 0.2820
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.0701, test: 0.0572
ACCURACY - train: 0.9785, test: 0.9811
norm of g = 0.1153
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.0697, test: 0.0569
ACCURACY - train: 0.9786, test: 0.9814
norm of g = 0.0691
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.0693, test: 0.0569
ACCURACY - train: 0.9790, test: 0.9815
norm of g = 0.0845
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.0683, test: 0.0561
ACCURACY - train: 0.9796, test: 0.9820
norm of g = 0.0907
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.0675, test: 0.0554
ACCURACY - train: 0.9796, test: 0.9822
norm of g = 0.0973
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.0675, test: 0.0554
ACCURACY - train: 0.9796, test: 0.9822
norm of g = 0.0973
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.0672, test: 0.0555
ACCURACY - train: 0.9796, test: 0.9822
norm of g = 0.0509
expanding trust region radius
no need for safe gaurding
gamma = 4.1122
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.0668, test: 0.0553
ACCURACY - train: 0.9797, test: 0.9821
norm of g = 0.0486
no need for safe gaurding
gamma = 3.8714
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.0659, test: 0.0549
ACCURACY - train: 0.9801, test: 0.9821
norm of g = 0.0558
expanding trust region radius
no need for safe gaurding
gamma = 1.3968
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.0652, test: 0.0544
ACCURACY - train: 0.9803, test: 0.9824
norm of g = 0.0683
expanding trust region radius
no need for safe gaurding
gamma = 4.7221
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.0637, test: 0.0537
ACCURACY - train: 0.9807, test: 0.9828
norm of g = 0.0473
expanding trust region radius
no need for safe gaurding
gamma = 8.3157
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.0613, test: 0.0524
ACCURACY - train: 0.9816, test: 0.9831
norm of g = 0.0437
no need for safe gaurding
gamma = 12.2126
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.0579, test: 0.0510
ACCURACY - train: 0.9825, test: 0.9835
norm of g = 0.0584
expanding trust region radius
no need for safe gaurding
gamma = 16.7068
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.0558, test: 0.0502
ACCURACY - train: 0.9831, test: 0.9842
norm of g = 0.1086
expanding trust region radius
no need for safe gaurding
gamma = 19.0238
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.0537, test: 0.0505
ACCURACY - train: 0.9833, test: 0.9836
norm of g = 0.1503
no need for safe gaurding
gamma = 12.5066
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.0528, test: 0.0502
ACCURACY - train: 0.9836, test: 0.9836
norm of g = 0.0854
no need for safe gaurding
gamma = 26.8663
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.0518, test: 0.0494
ACCURACY - train: 0.9838, test: 0.9839
norm of g = 0.1136
no need for safe gaurding
gamma = 28.4541
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.0493, test: 0.0479
ACCURACY - train: 0.9845, test: 0.9842
norm of g = 0.1443
no need for safe gaurding
gamma = 9.9059
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.0485, test: 0.0474
ACCURACY - train: 0.9848, test: 0.9843
norm of g = 0.0897
no need for safe gaurding
gamma = 5.1629
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.0478, test: 0.0469
ACCURACY - train: 0.9849, test: 0.9846
norm of g = 0.1159
shrinking trust region radius
no need for safe gaurding
gamma = 2.1966
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.0478, test: 0.0469
ACCURACY - train: 0.9849, test: 0.9846
norm of g = 0.1159
no need for safe gaurding
gamma = 7.1362
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.0455, test: 0.0453
ACCURACY - train: 0.9853, test: 0.9851
norm of g = 0.0652
no need for safe gaurding
gamma = 8.4512
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.0447, test: 0.0453
ACCURACY - train: 0.9857, test: 0.9859
norm of g = 0.1445
shrinking trust region radius
no need for safe gaurding
gamma = 2.9333
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.0447, test: 0.0453
ACCURACY - train: 0.9857, test: 0.9859
norm of g = 0.1445
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.0436, test: 0.0440
ACCURACY - train: 0.9859, test: 0.9865
norm of g = 0.1784
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.0436, test: 0.0440
ACCURACY - train: 0.9859, test: 0.9865
norm of g = 0.1784
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.0436, test: 0.0440
ACCURACY - train: 0.9859, test: 0.9865
norm of g = 0.1784
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.0433, test: 0.0441
ACCURACY - train: 0.9863, test: 0.9866
norm of g = 0.0688
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.0431, test: 0.0443
ACCURACY - train: 0.9863, test: 0.9863
norm of g = 0.0582
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.0429, test: 0.0441
ACCURACY - train: 0.9862, test: 0.9868
norm of g = 0.0586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.0428, test: 0.0436
ACCURACY - train: 0.9863, test: 0.9866
norm of g = 0.1102
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.0425, test: 0.0443
ACCURACY - train: 0.9865, test: 0.9866
norm of g = 0.0987
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.0425, test: 0.0443
ACCURACY - train: 0.9865, test: 0.9866
norm of g = 0.0987
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.0424, test: 0.0440
ACCURACY - train: 0.9865, test: 0.9868
norm of g = 0.0452
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.0422, test: 0.0437
ACCURACY - train: 0.9865, test: 0.9868
norm of g = 0.0383
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.0421, test: 0.0439
ACCURACY - train: 0.9865, test: 0.9867
norm of g = 0.0868
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.0417, test: 0.0436
ACCURACY - train: 0.9869, test: 0.9868
norm of g = 0.0370
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.0415, test: 0.0433
ACCURACY - train: 0.9870, test: 0.9866
norm of g = 0.1287
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.0409, test: 0.0430
ACCURACY - train: 0.9871, test: 0.9868
norm of g = 0.0518
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.0409, test: 0.0430
ACCURACY - train: 0.9871, test: 0.9868
norm of g = 0.0518
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.0407, test: 0.0431
ACCURACY - train: 0.9871, test: 0.9868
norm of g = 0.0267
no need for safe gaurding
gamma = 6.8993
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.0405, test: 0.0430
ACCURACY - train: 0.9872, test: 0.9866
norm of g = 0.0254
expanding trust region radius
no need for safe gaurding
gamma = 5.7061
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.0403, test: 0.0429
ACCURACY - train: 0.9873, test: 0.9866
norm of g = 0.0270
expanding trust region radius
no need for safe gaurding
gamma = 7.3358
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.0399, test: 0.0426
ACCURACY - train: 0.9874, test: 0.9866
norm of g = 0.0315
expanding trust region radius
no need for safe gaurding
gamma = 15.4862
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.0391, test: 0.0422
ACCURACY - train: 0.9878, test: 0.9868
norm of g = 0.0246
expanding trust region radius
no need for safe gaurding
gamma = 16.2898
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.0378, test: 0.0414
ACCURACY - train: 0.9881, test: 0.9868
norm of g = 0.0277
expanding trust region radius
no need for safe gaurding
gamma = 16.3936
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.0360, test: 0.0407
ACCURACY - train: 0.9889, test: 0.9870
norm of g = 0.0706
no need for safe gaurding
gamma = 14.0748
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.0352, test: 0.0408
ACCURACY - train: 0.9894, test: 0.9870
norm of g = 0.1489
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.0349, test: 0.0404
ACCURACY - train: 0.9896, test: 0.9871
norm of g = 0.0687
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.0349, test: 0.0404
ACCURACY - train: 0.9896, test: 0.9871
norm of g = 0.0687
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.0349, test: 0.0404
ACCURACY - train: 0.9896, test: 0.9871
norm of g = 0.0687
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0345, test: 0.0401
ACCURACY - train: 0.9897, test: 0.9867
norm of g = 0.1216
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.0345, test: 0.0401
ACCURACY - train: 0.9897, test: 0.9867
norm of g = 0.1216
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.0343, test: 0.0403
ACCURACY - train: 0.9898, test: 0.9869
norm of g = 0.0459
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0342, test: 0.0400
ACCURACY - train: 0.9897, test: 0.9871
norm of g = 0.0433
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0340, test: 0.0401
ACCURACY - train: 0.9899, test: 0.9870
norm of g = 0.0317
expanding trust region radius
no need for safe gaurding
gamma = 1.0098
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.0338, test: 0.0397
ACCURACY - train: 0.9899, test: 0.9872
norm of g = 0.0450
no need for safe gaurding
gamma = 1.7607
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.0334, test: 0.0397
ACCURACY - train: 0.9900, test: 0.9872
norm of g = 0.0366
expanding trust region radius
no need for safe gaurding
gamma = 2.0895
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.0331, test: 0.0395
ACCURACY - train: 0.9901, test: 0.9870
norm of g = 0.0484
no need for safe gaurding
gamma = 1.6920
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.0326, test: 0.0388
ACCURACY - train: 0.9903, test: 0.9875
norm of g = 0.0966
no need for safe gaurding
gamma = 1.4148
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.0322, test: 0.0389
ACCURACY - train: 0.9904, test: 0.9869
norm of g = 0.1472
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0322, test: 0.0389
ACCURACY - train: 0.9904, test: 0.9869
norm of g = 0.1472
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0318, test: 0.0385
ACCURACY - train: 0.9906, test: 0.9876
norm of g = 0.0293
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0318, test: 0.0385
ACCURACY - train: 0.9906, test: 0.9876
norm of g = 0.0293
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0317, test: 0.0385
ACCURACY - train: 0.9907, test: 0.9873
norm of g = 0.0188
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0317, test: 0.0384
ACCURACY - train: 0.9906, test: 0.9875
norm of g = 0.0293
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0316, test: 0.0384
ACCURACY - train: 0.9907, test: 0.9873
norm of g = 0.0190
no need for safe gaurding
gamma = 5.8459
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0315, test: 0.0384
ACCURACY - train: 0.9907, test: 0.9873
norm of g = 0.0175
expanding trust region radius
no need for safe gaurding
gamma = 7.9825
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0314, test: 0.0384
ACCURACY - train: 0.9906, test: 0.9874
norm of g = 0.0165
no need for safe gaurding
gamma = 19.5759
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.0313, test: 0.0383
ACCURACY - train: 0.9906, test: 0.9874
norm of g = 0.0164
no need for safe gaurding
gamma = 19.8329
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.0312, test: 0.0383
ACCURACY - train: 0.9906, test: 0.9874
norm of g = 0.0161
no need for safe gaurding
gamma = 17.6120
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.0310, test: 0.0382
ACCURACY - train: 0.9907, test: 0.9874
norm of g = 0.0158
no need for safe gaurding
gamma = 25.6599
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0309, test: 0.0382
ACCURACY - train: 0.9908, test: 0.9875
norm of g = 0.0156
no need for safe gaurding
gamma = 23.7293
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.0308, test: 0.0381
ACCURACY - train: 0.9908, test: 0.9875
norm of g = 0.0154
no need for safe gaurding
gamma = 22.9756
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.0306, test: 0.0381
ACCURACY - train: 0.9908, test: 0.9874
norm of g = 0.0152
no need for safe gaurding
gamma = 30.4257
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0305, test: 0.0380
ACCURACY - train: 0.9909, test: 0.9875
norm of g = 0.0153
no need for safe gaurding
gamma = 29.1069
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0304, test: 0.0380
ACCURACY - train: 0.9910, test: 0.9874
norm of g = 0.0151
no need for safe gaurding
gamma = 31.1010
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0303, test: 0.0380
ACCURACY - train: 0.9910, test: 0.9875
norm of g = 0.0150
no need for safe gaurding
gamma = 22.3860
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0301, test: 0.0379
ACCURACY - train: 0.9911, test: 0.9877
norm of g = 0.0149
no need for safe gaurding
gamma = 28.3707
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0300, test: 0.0379
ACCURACY - train: 0.9911, test: 0.9877
norm of g = 0.0148
no need for safe gaurding
gamma = 53.7437
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0299, test: 0.0379
ACCURACY - train: 0.9911, test: 0.9877
norm of g = 0.0146
expanding trust region radius
no need for safe gaurding
gamma = 36.2283
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0298, test: 0.0378
ACCURACY - train: 0.9912, test: 0.9877
norm of g = 0.0147
expanding trust region radius
no need for safe gaurding
gamma = 43.0644
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.0295, test: 0.0378
ACCURACY - train: 0.9912, test: 0.9877
norm of g = 0.0150
expanding trust region radius
no need for safe gaurding
gamma = 51.3116
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0291, test: 0.0376
ACCURACY - train: 0.9914, test: 0.9877
norm of g = 0.0157
expanding trust region radius
no need for safe gaurding
gamma = 53.8100
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0282, test: 0.0374
ACCURACY - train: 0.9916, test: 0.9880
norm of g = 0.0178
no need for safe gaurding
gamma = 52.0575
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.0268, test: 0.0370
ACCURACY - train: 0.9923, test: 0.9883
norm of g = 0.0239
expanding trust region radius
no need for safe gaurding
gamma = 60.1564
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0257, test: 0.0367
ACCURACY - train: 0.9928, test: 0.9884
norm of g = 0.0307
no need for safe gaurding
gamma = 65.9237
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0243, test: 0.0365
ACCURACY - train: 0.9932, test: 0.9884
norm of g = 0.0537
no need for safe gaurding
gamma = 67.2364
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0240, test: 0.0366
ACCURACY - train: 0.9933, test: 0.9882
norm of g = 0.0623
no need for safe gaurding
gamma = 35.6775
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0239, test: 0.0366
ACCURACY - train: 0.9932, test: 0.9883
norm of g = 0.0582
no need for safe gaurding
gamma = 39.5907
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0235, test: 0.0368
ACCURACY - train: 0.9934, test: 0.9885
norm of g = 0.0748
no need for safe gaurding
gamma = 12.1494
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0231, test: 0.0367
ACCURACY - train: 0.9933, test: 0.9885
norm of g = 0.1027
no need for safe gaurding
gamma = 15.8294
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0229, test: 0.0373
ACCURACY - train: 0.9933, test: 0.9881
norm of g = 0.1847
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0225, test: 0.0364
ACCURACY - train: 0.9934, test: 0.9884
norm of g = 0.1520
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0225, test: 0.0364
ACCURACY - train: 0.9934, test: 0.9884
norm of g = 0.1520
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0225, test: 0.0364
ACCURACY - train: 0.9934, test: 0.9884
norm of g = 0.1520
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.0218, test: 0.0362
ACCURACY - train: 0.9938, test: 0.9890
norm of g = 0.1495
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.0218, test: 0.0362
ACCURACY - train: 0.9938, test: 0.9890
norm of g = 0.1495
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0215, test: 0.0359
ACCURACY - train: 0.9939, test: 0.9885
norm of g = 0.0553
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0214, test: 0.0359
ACCURACY - train: 0.9938, test: 0.9891
norm of g = 0.0665
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0212, test: 0.0358
ACCURACY - train: 0.9940, test: 0.9890
norm of g = 0.0368
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0210, test: 0.0356
ACCURACY - train: 0.9942, test: 0.9890
norm of g = 0.0767
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0208, test: 0.0357
ACCURACY - train: 0.9943, test: 0.9891
norm of g = 0.0577
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0208, test: 0.0357
ACCURACY - train: 0.9943, test: 0.9891
norm of g = 0.0577
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0207, test: 0.0355
ACCURACY - train: 0.9942, test: 0.9889
norm of g = 0.0326
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0206, test: 0.0356
ACCURACY - train: 0.9944, test: 0.9889
norm of g = 0.0426
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0203, test: 0.0352
ACCURACY - train: 0.9943, test: 0.9889
norm of g = 0.0373
expanding trust region radius
no need for safe gaurding
gamma = 1.7399
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0200, test: 0.0354
ACCURACY - train: 0.9945, test: 0.9889
norm of g = 0.0584
no need for safe gaurding
gamma = 1.4659
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0194, test: 0.0349
ACCURACY - train: 0.9948, test: 0.9886
norm of g = 0.0992
no need for safe gaurding
gamma = 2.8571
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0187, test: 0.0346
ACCURACY - train: 0.9949, test: 0.9888
norm of g = 0.0380
no need for safe gaurding
gamma = 8.4513
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0182, test: 0.0343
ACCURACY - train: 0.9951, test: 0.9890
norm of g = 0.0207
expanding trust region radius
no need for safe gaurding
gamma = 15.0543
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0178, test: 0.0341
ACCURACY - train: 0.9952, test: 0.9890
norm of g = 0.0260
no need for safe gaurding
gamma = 19.2391
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0172, test: 0.0339
ACCURACY - train: 0.9955, test: 0.9886
norm of g = 0.0427
no need for safe gaurding
gamma = 29.7959
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0168, test: 0.0338
ACCURACY - train: 0.9955, test: 0.9886
norm of g = 0.0547
no need for safe gaurding
gamma = 41.9337
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0164, test: 0.0338
ACCURACY - train: 0.9955, test: 0.9886
norm of g = 0.0511
no need for safe gaurding
gamma = 34.2798
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0160, test: 0.0338
ACCURACY - train: 0.9956, test: 0.9886
norm of g = 0.0297
no need for safe gaurding
gamma = 48.9525
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0158, test: 0.0339
ACCURACY - train: 0.9957, test: 0.9889
norm of g = 0.0341
no need for safe gaurding
gamma = 42.7186
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0155, test: 0.0339
ACCURACY - train: 0.9959, test: 0.9889
norm of g = 0.0430
expanding trust region radius
no need for safe gaurding
gamma = 43.9929
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0152, test: 0.0340
ACCURACY - train: 0.9960, test: 0.9888
norm of g = 0.0508
no need for safe gaurding
gamma = 45.5424
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0148, test: 0.0343
ACCURACY - train: 0.9962, test: 0.9888
norm of g = 0.0615
no need for safe gaurding
gamma = 70.7207
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0145, test: 0.0345
ACCURACY - train: 0.9962, test: 0.9886
norm of g = 0.0627
no need for safe gaurding
gamma = 56.4295
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0139, test: 0.0347
ACCURACY - train: 0.9963, test: 0.9889
norm of g = 0.0587
no need for safe gaurding
gamma = 39.7639
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0135, test: 0.0349
ACCURACY - train: 0.9964, test: 0.9893
norm of g = 0.0624
no need for safe gaurding
gamma = 17.7479
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0133, test: 0.0351
ACCURACY - train: 0.9965, test: 0.9891
norm of g = 0.0548
no need for safe gaurding
gamma = 16.6878
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0130, test: 0.0352
ACCURACY - train: 0.9967, test: 0.9892
norm of g = 0.0503
no need for safe gaurding
gamma = 21.1700
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0128, test: 0.0354
ACCURACY - train: 0.9967, test: 0.9891
norm of g = 0.0796
no need for safe gaurding
gamma = 21.3710
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0125, test: 0.0357
ACCURACY - train: 0.9967, test: 0.9886
norm of g = 0.0743
no need for safe gaurding
gamma = 20.7361
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0122, test: 0.0359
ACCURACY - train: 0.9967, test: 0.9890
norm of g = 0.0545
no need for safe gaurding
gamma = 22.4034
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0119, test: 0.0359
ACCURACY - train: 0.9968, test: 0.9892
norm of g = 0.0668
no need for safe gaurding
gamma = 14.0152
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0117, test: 0.0362
ACCURACY - train: 0.9968, test: 0.9885
norm of g = 0.0565
no need for safe gaurding
gamma = 18.6182
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0114, test: 0.0366
ACCURACY - train: 0.9969, test: 0.9890
norm of g = 0.0692
no need for safe gaurding
gamma = 14.7084
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0112, test: 0.0371
ACCURACY - train: 0.9969, test: 0.9886
norm of g = 0.0505
no need for safe gaurding
gamma = 10.4389
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0110, test: 0.0370
ACCURACY - train: 0.9970, test: 0.9890
norm of g = 0.0665
no need for safe gaurding
gamma = 8.9029
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0109, test: 0.0375
ACCURACY - train: 0.9971, test: 0.9885
norm of g = 0.1073
no need for safe gaurding
gamma = 3.0369
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0107, test: 0.0378
ACCURACY - train: 0.9972, test: 0.9890
norm of g = 0.1010
shrinking trust region radius
no need for safe gaurding
gamma = 5.5353
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0107, test: 0.0378
ACCURACY - train: 0.9972, test: 0.9890
norm of g = 0.1010
no need for safe gaurding
gamma = 1.0267
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0103, test: 0.0362
ACCURACY - train: 0.9971, test: 0.9888
norm of g = 0.1018
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0103, test: 0.0362
ACCURACY - train: 0.9971, test: 0.9888
norm of g = 0.1018
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0100, test: 0.0367
ACCURACY - train: 0.9974, test: 0.9893
norm of g = 0.0700
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0100, test: 0.0367
ACCURACY - train: 0.9974, test: 0.9893
norm of g = 0.0700
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0099, test: 0.0366
ACCURACY - train: 0.9973, test: 0.9892
norm of g = 0.0334
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0099, test: 0.0363
ACCURACY - train: 0.9973, test: 0.9890
norm of g = 0.0327
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0098, test: 0.0362
ACCURACY - train: 0.9976, test: 0.9890
norm of g = 0.0610
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0097, test: 0.0364
ACCURACY - train: 0.9975, test: 0.9890
norm of g = 0.0601
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0097, test: 0.0364
ACCURACY - train: 0.9975, test: 0.9890
norm of g = 0.0601
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0096, test: 0.0360
ACCURACY - train: 0.9976, test: 0.9890
norm of g = 0.0248
no need for safe gaurding
gamma = 1.9139
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0095, test: 0.0360
ACCURACY - train: 0.9977, test: 0.9892
norm of g = 0.0261
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0094, test: 0.0360
ACCURACY - train: 0.9977, test: 0.9895
norm of g = 0.0705
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0092, test: 0.0357
ACCURACY - train: 0.9978, test: 0.9891
norm of g = 0.0293
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0091, test: 0.0357
ACCURACY - train: 0.9978, test: 0.9893
norm of g = 0.0385
no need for safe gaurding
gamma = 2.9981
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0090, test: 0.0356
ACCURACY - train: 0.9978, test: 0.9891
norm of g = 0.0168
expanding trust region radius
no need for safe gaurding
gamma = 2.9157
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0089, test: 0.0355
ACCURACY - train: 0.9979, test: 0.9894
norm of g = 0.0186
expanding trust region radius
no need for safe gaurding
gamma = 12.7627
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0087, test: 0.0353
ACCURACY - train: 0.9979, test: 0.9893
norm of g = 0.0165
expanding trust region radius
no need for safe gaurding
gamma = 27.9229
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0084, test: 0.0350
ACCURACY - train: 0.9981, test: 0.9895
norm of g = 0.0144
no need for safe gaurding
gamma = 24.0543
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0079, test: 0.0347
ACCURACY - train: 0.9983, test: 0.9894
norm of g = 0.0143
no need for safe gaurding
gamma = 33.9437
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0075, test: 0.0344
ACCURACY - train: 0.9983, test: 0.9897
norm of g = 0.0133
expanding trust region radius
no need for safe gaurding
gamma = 35.3576
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0073, test: 0.0343
ACCURACY - train: 0.9984, test: 0.9901
norm of g = 0.0159
no need for safe gaurding
gamma = 39.1745
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0071, test: 0.0342
ACCURACY - train: 0.9983, test: 0.9899
norm of g = 0.0192
no need for safe gaurding
gamma = 36.9884
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0071, test: 0.0342
ACCURACY - train: 0.9984, test: 0.9898
norm of g = 0.0192
no need for safe gaurding
gamma = 40.8653
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0070, test: 0.0343
ACCURACY - train: 0.9984, test: 0.9899
norm of g = 0.0306
no need for safe gaurding
gamma = 50.2407
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0069, test: 0.0344
ACCURACY - train: 0.9985, test: 0.9903
norm of g = 0.0387
no need for safe gaurding
gamma = 37.6283
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0068, test: 0.0347
ACCURACY - train: 0.9985, test: 0.9903
norm of g = 0.0407
no need for safe gaurding
gamma = 18.2672
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0066, test: 0.0351
ACCURACY - train: 0.9986, test: 0.9906
norm of g = 0.0349
no need for safe gaurding
gamma = 9.0477
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0065, test: 0.0351
ACCURACY - train: 0.9986, test: 0.9905
norm of g = 0.0288
no need for safe gaurding
gamma = 5.7562
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0064, test: 0.0350
ACCURACY - train: 0.9986, test: 0.9905
norm of g = 0.0323
shrinking trust region radius
no need for safe gaurding
gamma = 4.6338
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0064, test: 0.0350
ACCURACY - train: 0.9986, test: 0.9905
norm of g = 0.0323
expanding trust region radius
no need for safe gaurding
gamma = 3.4756
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0060, test: 0.0350
ACCURACY - train: 0.9987, test: 0.9909
norm of g = 0.0522
shrinking trust region radius
no need for safe gaurding
gamma = 2.1869
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0060, test: 0.0350
ACCURACY - train: 0.9987, test: 0.9909
norm of g = 0.0522
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0059, test: 0.0353
ACCURACY - train: 0.9988, test: 0.9903
norm of g = 0.0801
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0059, test: 0.0353
ACCURACY - train: 0.9988, test: 0.9903
norm of g = 0.0801
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0058, test: 0.0346
ACCURACY - train: 0.9988, test: 0.9907
norm of g = 0.0467
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0058, test: 0.0346
ACCURACY - train: 0.9988, test: 0.9907
norm of g = 0.0467
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0058, test: 0.0347
ACCURACY - train: 0.9988, test: 0.9907
norm of g = 0.0236
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0058, test: 0.0348
ACCURACY - train: 0.9989, test: 0.9906
norm of g = 0.0319
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0058, test: 0.0350
ACCURACY - train: 0.9989, test: 0.9908
norm of g = 0.0385
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0057, test: 0.0349
ACCURACY - train: 0.9989, test: 0.9907
norm of g = 0.0211
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0057, test: 0.0348
ACCURACY - train: 0.9989, test: 0.9908
norm of g = 0.0153
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0057, test: 0.0347
ACCURACY - train: 0.9989, test: 0.9907
norm of g = 0.0150
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0057, test: 0.0348
ACCURACY - train: 0.9989, test: 0.9908
norm of g = 0.0109
expanding trust region radius
no need for safe gaurding
gamma = 1.9813
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0057, test: 0.0348
ACCURACY - train: 0.9989, test: 0.9907
norm of g = 0.0113
expanding trust region radius
no need for safe gaurding
gamma = 2.5513
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0056, test: 0.0348
ACCURACY - train: 0.9990, test: 0.9910
norm of g = 0.0123
no need for safe gaurding
gamma = 4.5064
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0056, test: 0.0349
ACCURACY - train: 0.9990, test: 0.9906
norm of g = 0.0126
no need for safe gaurding
gamma = 3.2935
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0055, test: 0.0347
ACCURACY - train: 0.9990, test: 0.9907
norm of g = 0.0141
no need for safe gaurding
gamma = 6.3591
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0054, test: 0.0348
ACCURACY - train: 0.9990, test: 0.9906
norm of g = 0.0094
expanding trust region radius
no need for safe gaurding
gamma = 7.5814
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0054, test: 0.0347
ACCURACY - train: 0.9990, test: 0.9908
norm of g = 0.0095
expanding trust region radius
no need for safe gaurding
gamma = 15.8242
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0053, test: 0.0348
ACCURACY - train: 0.9990, test: 0.9907
norm of g = 0.0097
no need for safe gaurding
gamma = 22.0852
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0051, test: 0.0348
ACCURACY - train: 0.9991, test: 0.9905
norm of g = 0.0117
expanding trust region radius
no need for safe gaurding
gamma = 27.7932
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0050, test: 0.0349
ACCURACY - train: 0.9991, test: 0.9905
norm of g = 0.0128
expanding trust region radius
no need for safe gaurding
gamma = 35.0295
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0048, test: 0.0352
ACCURACY - train: 0.9991, test: 0.9894
norm of g = 0.0159
no need for safe gaurding
gamma = 41.2702
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0048, test: 0.0355
ACCURACY - train: 0.9991, test: 0.9895
norm of g = 0.0178
no need for safe gaurding
gamma = 48.5529
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0047, test: 0.0357
ACCURACY - train: 0.9991, test: 0.9895
norm of g = 0.0187
no need for safe gaurding
gamma = 58.7603
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0047, test: 0.0360
ACCURACY - train: 0.9991, test: 0.9896
norm of g = 0.0233
no need for safe gaurding
gamma = 53.8402
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0046, test: 0.0363
ACCURACY - train: 0.9992, test: 0.9897
norm of g = 0.0319
no need for safe gaurding
gamma = 30.1647
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0045, test: 0.0366
ACCURACY - train: 0.9992, test: 0.9896
norm of g = 0.0368
no need for safe gaurding
gamma = 7.0425
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0044, test: 0.0366
ACCURACY - train: 0.9993, test: 0.9900
norm of g = 0.0325
no need for safe gaurding
gamma = 6.7440
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0042, test: 0.0364
ACCURACY - train: 0.9993, test: 0.9902
norm of g = 0.0303
shrinking trust region radius
no need for safe gaurding
gamma = 3.4423
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0042, test: 0.0364
ACCURACY - train: 0.9993, test: 0.9902
norm of g = 0.0303
no need for safe gaurding
gamma = 2.7353
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0040, test: 0.0364
ACCURACY - train: 0.9994, test: 0.9899
norm of g = 0.0656
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0040, test: 0.0364
ACCURACY - train: 0.9994, test: 0.9899
norm of g = 0.0656
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0040, test: 0.0364
ACCURACY - train: 0.9994, test: 0.9899
norm of g = 0.0656
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0039, test: 0.0364
ACCURACY - train: 0.9995, test: 0.9900
norm of g = 0.0327
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0039, test: 0.0363
ACCURACY - train: 0.9995, test: 0.9902
norm of g = 0.0202
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0039, test: 0.0362
ACCURACY - train: 0.9995, test: 0.9903
norm of g = 0.0149
reached to the max num iteration -- BREAK
20 - 5 - preconditioning -- 1
2018-06-28 06:46:17.136025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 06:46:17.386505: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3d996d0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 06:46:17.387375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 06:46:17.647907: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3d9dbb0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 06:46:17.648775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 06:46:17.901690: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3da2090 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 06:46:17.902424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 06:46:17.902687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 06:46:17.902705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 06:46:17.902729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 06:46:17.902739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 06:46:17.902749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 06:46:17.902758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 06:46:17.902948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 06:46:17.902962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 06:46:17.903029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 06:46:17.903037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 06:46:17.903041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 06:46:17.903046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 06:46:17.903050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 06:46:17.903064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 06:46:17.903070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 06:46:17.903076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 06:46:17.903080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.4084, test: 2.4059
ACCURACY - train: 0.0898, test: 0.0896
norm of g = 1.3527
Backtracking line search satisfied for alpha = 0.4305
initial gamma = 4.9840
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3716, test: 2.3742
ACCURACY - train: 0.1865, test: 0.1851
norm of g = 1.1441
gamma = 1.5945
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2683, test: 2.2672
ACCURACY - train: 0.2145, test: 0.2108
norm of g = 0.4350
gamma = 0.3285
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1791, test: 2.1762
ACCURACY - train: 0.4380, test: 0.4449
norm of g = 0.5628
no need for safe gaurding
gamma = 4.4617
weights are updated
------------------------------------------------------------
iteration: 3
LOSS     - train: 1.4781, test: 1.4542
ACCURACY - train: 0.4742, test: 0.4800
norm of g = 4.0254
no need for safe gaurding
gamma = 1.6528
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.1238, test: 1.0901
ACCURACY - train: 0.6672, test: 0.6769
norm of g = 7.9392
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.1238, test: 1.0901
ACCURACY - train: 0.6672, test: 0.6769
norm of g = 7.9392
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.1238, test: 1.0901
ACCURACY - train: 0.6672, test: 0.6769
norm of g = 7.9392
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 0.7904, test: 0.7569
ACCURACY - train: 0.7571, test: 0.7673
norm of g = 2.4552
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 8
LOSS     - train: 0.7904, test: 0.7569
ACCURACY - train: 0.7571, test: 0.7673
norm of g = 2.4552
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.7234, test: 0.6925
ACCURACY - train: 0.7727, test: 0.7878
norm of g = 1.4918
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.6902, test: 0.6605
ACCURACY - train: 0.7810, test: 0.7976
norm of g = 1.1691
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.6446, test: 0.6295
ACCURACY - train: 0.7950, test: 0.8050
norm of g = 1.0134
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.6325, test: 0.6056
ACCURACY - train: 0.8008, test: 0.8120
norm of g = 1.0378
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.6111, test: 0.5814
ACCURACY - train: 0.8098, test: 0.8229
norm of g = 0.7833
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.5706, test: 0.5436
ACCURACY - train: 0.8200, test: 0.8304
norm of g = 1.0164
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.5398, test: 0.5109
ACCURACY - train: 0.8356, test: 0.8466
norm of g = 1.2956
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.4998, test: 0.4843
ACCURACY - train: 0.8474, test: 0.8553
norm of g = 1.0877
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.4998, test: 0.4843
ACCURACY - train: 0.8474, test: 0.8553
norm of g = 1.0877
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.4958, test: 0.4720
ACCURACY - train: 0.8496, test: 0.8621
norm of g = 0.6208
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.4857, test: 0.4587
ACCURACY - train: 0.8547, test: 0.8652
norm of g = 0.5254
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.4703, test: 0.4457
ACCURACY - train: 0.8579, test: 0.8693
norm of g = 0.4736
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.4500, test: 0.4220
ACCURACY - train: 0.8658, test: 0.8769
norm of g = 0.6738
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.4048, test: 0.3937
ACCURACY - train: 0.8822, test: 0.8881
norm of g = 1.0397
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4048, test: 0.3937
ACCURACY - train: 0.8822, test: 0.8881
norm of g = 1.0397
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.3992, test: 0.3770
ACCURACY - train: 0.8818, test: 0.8911
norm of g = 0.5960
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.3958, test: 0.3709
ACCURACY - train: 0.8842, test: 0.8934
norm of g = 0.5965
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.3812, test: 0.3593
ACCURACY - train: 0.8871, test: 0.8974
norm of g = 0.3537
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.3742, test: 0.3518
ACCURACY - train: 0.8896, test: 0.8983
norm of g = 0.3734
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.3511, test: 0.3373
ACCURACY - train: 0.8965, test: 0.9036
norm of g = 0.6073
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.3368, test: 0.3145
ACCURACY - train: 0.8988, test: 0.9062
norm of g = 1.1329
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3338, test: 0.3118
ACCURACY - train: 0.9054, test: 0.9103
norm of g = 1.5401
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3051, test: 0.2863
ACCURACY - train: 0.9084, test: 0.9154
norm of g = 0.5893
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.2965, test: 0.2759
ACCURACY - train: 0.9127, test: 0.9186
norm of g = 0.3160
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.2813, test: 0.2701
ACCURACY - train: 0.9175, test: 0.9219
norm of g = 0.2128
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.2823, test: 0.2654
ACCURACY - train: 0.9160, test: 0.9233
norm of g = 0.3115
expanding trust region radius
no need for safe gaurding
gamma = 1.2654
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.2775, test: 0.2538
ACCURACY - train: 0.9192, test: 0.9254
norm of g = 0.2800
expanding trust region radius
no need for safe gaurding
gamma = 2.0469
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.2517, test: 0.2335
ACCURACY - train: 0.9262, test: 0.9325
norm of g = 0.3637
no need for safe gaurding
gamma = 3.3331
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.2178, test: 0.2005
ACCURACY - train: 0.9359, test: 0.9408
norm of g = 0.5053
no need for safe gaurding
gamma = 2.0127
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.1877, test: 0.1795
ACCURACY - train: 0.9436, test: 0.9452
norm of g = 0.8501
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.1877, test: 0.1795
ACCURACY - train: 0.9436, test: 0.9452
norm of g = 0.8501
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.1877, test: 0.1795
ACCURACY - train: 0.9436, test: 0.9452
norm of g = 0.8501
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.1866, test: 0.1718
ACCURACY - train: 0.9446, test: 0.9475
norm of g = 0.3397
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.1866, test: 0.1718
ACCURACY - train: 0.9446, test: 0.9475
norm of g = 0.3397
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.1907, test: 0.1700
ACCURACY - train: 0.9447, test: 0.9492
norm of g = 0.1682
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.1846, test: 0.1687
ACCURACY - train: 0.9447, test: 0.9502
norm of g = 0.1672
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.1821, test: 0.1670
ACCURACY - train: 0.9454, test: 0.9507
norm of g = 0.1508
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.1752, test: 0.1656
ACCURACY - train: 0.9487, test: 0.9512
norm of g = 0.1727
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.1792, test: 0.1637
ACCURACY - train: 0.9476, test: 0.9520
norm of g = 0.2524
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.1837, test: 0.1630
ACCURACY - train: 0.9464, test: 0.9521
norm of g = 0.1621
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.1764, test: 0.1603
ACCURACY - train: 0.9472, test: 0.9519
norm of g = 0.2853
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.1729, test: 0.1574
ACCURACY - train: 0.9481, test: 0.9544
norm of g = 0.2852
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.1641, test: 0.1556
ACCURACY - train: 0.9517, test: 0.9535
norm of g = 0.1635
no need for safe gaurding
gamma = 1.0913
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.1663, test: 0.1523
ACCURACY - train: 0.9505, test: 0.9551
norm of g = 0.2264
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.1717, test: 0.1510
ACCURACY - train: 0.9500, test: 0.9569
norm of g = 0.3822
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.1624, test: 0.1465
ACCURACY - train: 0.9517, test: 0.9581
norm of g = 0.2132
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.1604, test: 0.1482
ACCURACY - train: 0.9512, test: 0.9557
norm of g = 0.4642
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.1516, test: 0.1437
ACCURACY - train: 0.9550, test: 0.9570
norm of g = 0.2683
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.1516, test: 0.1437
ACCURACY - train: 0.9550, test: 0.9570
norm of g = 0.2683
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.1549, test: 0.1417
ACCURACY - train: 0.9540, test: 0.9584
norm of g = 0.1749
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.1600, test: 0.1404
ACCURACY - train: 0.9533, test: 0.9593
norm of g = 0.1241
no need for safe gaurding
gamma = 1.1753
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.1532, test: 0.1390
ACCURACY - train: 0.9547, test: 0.9596
norm of g = 0.1450
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.1508, test: 0.1378
ACCURACY - train: 0.9549, test: 0.9601
norm of g = 0.1357
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.1448, test: 0.1372
ACCURACY - train: 0.9571, test: 0.9604
norm of g = 0.1808
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.1488, test: 0.1358
ACCURACY - train: 0.9559, test: 0.9603
norm of g = 0.2323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.1547, test: 0.1353
ACCURACY - train: 0.9550, test: 0.9600
norm of g = 0.2424
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.1475, test: 0.1335
ACCURACY - train: 0.9560, test: 0.9609
norm of g = 0.1600
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.1439, test: 0.1322
ACCURACY - train: 0.9568, test: 0.9609
norm of g = 0.2106
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.1369, test: 0.1298
ACCURACY - train: 0.9594, test: 0.9619
norm of g = 0.1835
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.1403, test: 0.1280
ACCURACY - train: 0.9581, test: 0.9620
norm of g = 0.2468
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.1449, test: 0.1259
ACCURACY - train: 0.9575, test: 0.9622
norm of g = 0.1678
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.1370, test: 0.1243
ACCURACY - train: 0.9597, test: 0.9627
norm of g = 0.1966
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.1337, test: 0.1213
ACCURACY - train: 0.9597, test: 0.9641
norm of g = 0.1927
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.1286, test: 0.1230
ACCURACY - train: 0.9620, test: 0.9621
norm of g = 0.4268
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.1302, test: 0.1194
ACCURACY - train: 0.9611, test: 0.9640
norm of g = 0.1742
no need for safe gaurding
gamma = 1.1841
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.1334, test: 0.1142
ACCURACY - train: 0.9611, test: 0.9669
norm of g = 0.2240
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.1260, test: 0.1124
ACCURACY - train: 0.9632, test: 0.9664
norm of g = 0.4275
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.1227, test: 0.1145
ACCURACY - train: 0.9635, test: 0.9650
norm of g = 0.3929
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.1227, test: 0.1145
ACCURACY - train: 0.9635, test: 0.9650
norm of g = 0.3929
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.1166, test: 0.1097
ACCURACY - train: 0.9660, test: 0.9669
norm of g = 0.1858
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.1189, test: 0.1082
ACCURACY - train: 0.9647, test: 0.9668
norm of g = 0.1926
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.1239, test: 0.1083
ACCURACY - train: 0.9647, test: 0.9684
norm of g = 0.3708
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.1158, test: 0.1053
ACCURACY - train: 0.9669, test: 0.9684
norm of g = 0.1561
no need for safe gaurding
gamma = 1.3389
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.1123, test: 0.1023
ACCURACY - train: 0.9669, test: 0.9689
norm of g = 0.1947
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.1060, test: 0.1013
ACCURACY - train: 0.9682, test: 0.9702
norm of g = 0.3165
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.1060, test: 0.1013
ACCURACY - train: 0.9682, test: 0.9702
norm of g = 0.3165
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.1092, test: 0.0986
ACCURACY - train: 0.9668, test: 0.9706
norm of g = 0.1548
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.1139, test: 0.0984
ACCURACY - train: 0.9665, test: 0.9704
norm of g = 0.1582
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.1066, test: 0.0975
ACCURACY - train: 0.9688, test: 0.9709
norm of g = 0.1363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1045, test: 0.0967
ACCURACY - train: 0.9691, test: 0.9712
norm of g = 0.1770
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1009, test: 0.0964
ACCURACY - train: 0.9696, test: 0.9706
norm of g = 0.2792
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.1040, test: 0.0941
ACCURACY - train: 0.9680, test: 0.9716
norm of g = 0.2884
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.1100, test: 0.0945
ACCURACY - train: 0.9679, test: 0.9722
norm of g = 0.5849
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1010, test: 0.0921
ACCURACY - train: 0.9707, test: 0.9727
norm of g = 0.4484
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1010, test: 0.0921
ACCURACY - train: 0.9707, test: 0.9727
norm of g = 0.4484
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.0976, test: 0.0892
ACCURACY - train: 0.9712, test: 0.9733
norm of g = 0.1579
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.0923, test: 0.0884
ACCURACY - train: 0.9720, test: 0.9729
norm of g = 0.1202
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.0951, test: 0.0876
ACCURACY - train: 0.9712, test: 0.9738
norm of g = 0.2366
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1015, test: 0.0885
ACCURACY - train: 0.9703, test: 0.9721
norm of g = 0.3169
gamma = 0.0241
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.0939, test: 0.0850
ACCURACY - train: 0.9726, test: 0.9734
norm of g = 0.1942
shrinking trust region radius
gamma = 0.0275
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.0939, test: 0.0850
ACCURACY - train: 0.9726, test: 0.9734
norm of g = 0.1942
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.0924, test: 0.0852
ACCURACY - train: 0.9728, test: 0.9732
norm of g = 0.1658
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.0883, test: 0.0848
ACCURACY - train: 0.9730, test: 0.9742
norm of g = 0.1198
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.0917, test: 0.0851
ACCURACY - train: 0.9718, test: 0.9736
norm of g = 0.2359
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.0968, test: 0.0844
ACCURACY - train: 0.9715, test: 0.9738
norm of g = 0.1242
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.0918, test: 0.0836
ACCURACY - train: 0.9735, test: 0.9746
norm of g = 0.1747
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.0899, test: 0.0839
ACCURACY - train: 0.9730, test: 0.9740
norm of g = 0.2306
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.0860, test: 0.0818
ACCURACY - train: 0.9739, test: 0.9748
norm of g = 0.2388
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.0860, test: 0.0818
ACCURACY - train: 0.9739, test: 0.9748
norm of g = 0.2388
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.0890, test: 0.0817
ACCURACY - train: 0.9728, test: 0.9750
norm of g = 0.1365
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.0936, test: 0.0815
ACCURACY - train: 0.9726, test: 0.9746
norm of g = 0.1340
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.0881, test: 0.0816
ACCURACY - train: 0.9736, test: 0.9746
norm of g = 0.2799
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.0858, test: 0.0804
ACCURACY - train: 0.9742, test: 0.9751
norm of g = 0.1513
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.0833, test: 0.0810
ACCURACY - train: 0.9745, test: 0.9758
norm of g = 0.4545
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.0841, test: 0.0774
ACCURACY - train: 0.9738, test: 0.9768
norm of g = 0.2535
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.0841, test: 0.0774
ACCURACY - train: 0.9738, test: 0.9768
norm of g = 0.2535
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.0894, test: 0.0767
ACCURACY - train: 0.9735, test: 0.9763
norm of g = 0.1472
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.0823, test: 0.0762
ACCURACY - train: 0.9751, test: 0.9767
norm of g = 0.1689
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.0820, test: 0.0782
ACCURACY - train: 0.9751, test: 0.9754
norm of g = 0.4159
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.0789, test: 0.0768
ACCURACY - train: 0.9757, test: 0.9763
norm of g = 0.4444
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.0825, test: 0.0745
ACCURACY - train: 0.9746, test: 0.9770
norm of g = 0.4610
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.0825, test: 0.0745
ACCURACY - train: 0.9746, test: 0.9770
norm of g = 0.4610
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.0851, test: 0.0736
ACCURACY - train: 0.9751, test: 0.9770
norm of g = 0.2109
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.0851, test: 0.0736
ACCURACY - train: 0.9751, test: 0.9770
norm of g = 0.2109
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.0779, test: 0.0728
ACCURACY - train: 0.9770, test: 0.9774
norm of g = 0.1738
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.0745, test: 0.0725
ACCURACY - train: 0.9778, test: 0.9775
norm of g = 0.1677
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.0727, test: 0.0728
ACCURACY - train: 0.9778, test: 0.9774
norm of g = 0.1844
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.0777, test: 0.0721
ACCURACY - train: 0.9761, test: 0.9775
norm of g = 0.1601
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.0829, test: 0.0718
ACCURACY - train: 0.9757, test: 0.9778
norm of g = 0.1140
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.0761, test: 0.0716
ACCURACY - train: 0.9776, test: 0.9773
norm of g = 0.1538
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.0734, test: 0.0713
ACCURACY - train: 0.9778, test: 0.9778
norm of g = 0.1251
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.0734, test: 0.0713
ACCURACY - train: 0.9778, test: 0.9778
norm of g = 0.1251
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.0719, test: 0.0711
ACCURACY - train: 0.9778, test: 0.9781
norm of g = 0.1098
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.0761, test: 0.0710
ACCURACY - train: 0.9770, test: 0.9779
norm of g = 0.1356
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.0808, test: 0.0707
ACCURACY - train: 0.9765, test: 0.9782
norm of g = 0.1378
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.0808, test: 0.0707
ACCURACY - train: 0.9765, test: 0.9782
norm of g = 0.1378
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.0749, test: 0.0705
ACCURACY - train: 0.9776, test: 0.9779
norm of g = 0.1470
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.0727, test: 0.0704
ACCURACY - train: 0.9784, test: 0.9775
norm of g = 0.1020
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.0706, test: 0.0704
ACCURACY - train: 0.9783, test: 0.9783
norm of g = 0.1442
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.0745, test: 0.0698
ACCURACY - train: 0.9771, test: 0.9777
norm of g = 0.1375
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.0790, test: 0.0692
ACCURACY - train: 0.9767, test: 0.9784
norm of g = 0.1481
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.0734, test: 0.0693
ACCURACY - train: 0.9782, test: 0.9784
norm of g = 0.1858
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.0734, test: 0.0693
ACCURACY - train: 0.9782, test: 0.9784
norm of g = 0.1858
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.0715, test: 0.0685
ACCURACY - train: 0.9785, test: 0.9785
norm of g = 0.1225
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.0690, test: 0.0688
ACCURACY - train: 0.9788, test: 0.9785
norm of g = 0.1452
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.0720, test: 0.0686
ACCURACY - train: 0.9782, test: 0.9784
norm of g = 0.1930
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.0768, test: 0.0678
ACCURACY - train: 0.9773, test: 0.9790
norm of g = 0.1367
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.0722, test: 0.0687
ACCURACY - train: 0.9785, test: 0.9784
norm of g = 0.1481
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.0705, test: 0.0682
ACCURACY - train: 0.9784, test: 0.9782
norm of g = 0.0924
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.0680, test: 0.0678
ACCURACY - train: 0.9793, test: 0.9791
norm of g = 0.1444
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0711, test: 0.0678
ACCURACY - train: 0.9780, test: 0.9784
norm of g = 0.1624
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.0758, test: 0.0673
ACCURACY - train: 0.9772, test: 0.9791
norm of g = 0.1225
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.0712, test: 0.0670
ACCURACY - train: 0.9787, test: 0.9791
norm of g = 0.2359
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0690, test: 0.0674
ACCURACY - train: 0.9788, test: 0.9786
norm of g = 0.1920
expanding trust region radius
no need for safe gaurding
gamma = 1.2095
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0659, test: 0.0667
ACCURACY - train: 0.9799, test: 0.9791
norm of g = 0.1863
no need for safe gaurding
gamma = 1.5452
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.0691, test: 0.0666
ACCURACY - train: 0.9782, test: 0.9786
norm of g = 0.4524
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.0691, test: 0.0666
ACCURACY - train: 0.9782, test: 0.9786
norm of g = 0.4524
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.0742, test: 0.0650
ACCURACY - train: 0.9779, test: 0.9797
norm of g = 0.3496
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.0675, test: 0.0638
ACCURACY - train: 0.9791, test: 0.9803
norm of g = 0.3568
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.0675, test: 0.0638
ACCURACY - train: 0.9791, test: 0.9803
norm of g = 0.3568
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0633, test: 0.0629
ACCURACY - train: 0.9807, test: 0.9801
norm of g = 0.1406
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0601, test: 0.0627
ACCURACY - train: 0.9820, test: 0.9803
norm of g = 0.2442
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0641, test: 0.0628
ACCURACY - train: 0.9804, test: 0.9805
norm of g = 0.2471
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0697, test: 0.0624
ACCURACY - train: 0.9791, test: 0.9804
norm of g = 0.1428
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0649, test: 0.0618
ACCURACY - train: 0.9802, test: 0.9801
norm of g = 0.1674
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0613, test: 0.0609
ACCURACY - train: 0.9815, test: 0.9808
norm of g = 0.1248
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0613, test: 0.0609
ACCURACY - train: 0.9815, test: 0.9808
norm of g = 0.1248
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0589, test: 0.0620
ACCURACY - train: 0.9822, test: 0.9806
norm of g = 0.1364
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.0589, test: 0.0620
ACCURACY - train: 0.9822, test: 0.9806
norm of g = 0.1364
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.0628, test: 0.0612
ACCURACY - train: 0.9803, test: 0.9810
norm of g = 0.1378
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.0678, test: 0.0610
ACCURACY - train: 0.9793, test: 0.9807
norm of g = 0.1042
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0625, test: 0.0608
ACCURACY - train: 0.9808, test: 0.9805
norm of g = 0.1347
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.0603, test: 0.0610
ACCURACY - train: 0.9822, test: 0.9807
norm of g = 0.0904
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.0585, test: 0.0609
ACCURACY - train: 0.9822, test: 0.9807
norm of g = 0.1257
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0624, test: 0.0609
ACCURACY - train: 0.9808, test: 0.9808
norm of g = 0.1816
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0676, test: 0.0605
ACCURACY - train: 0.9794, test: 0.9807
norm of g = 0.1517
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0623, test: 0.0606
ACCURACY - train: 0.9809, test: 0.9806
norm of g = 0.1338
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0599, test: 0.0604
ACCURACY - train: 0.9820, test: 0.9810
norm of g = 0.0886
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0579, test: 0.0606
ACCURACY - train: 0.9824, test: 0.9804
norm of g = 0.1337
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0620, test: 0.0604
ACCURACY - train: 0.9810, test: 0.9815
norm of g = 0.2002
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0670, test: 0.0602
ACCURACY - train: 0.9796, test: 0.9806
norm of g = 0.1899
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.0619, test: 0.0596
ACCURACY - train: 0.9814, test: 0.9809
norm of g = 0.2118
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0597, test: 0.0612
ACCURACY - train: 0.9816, test: 0.9806
norm of g = 0.2199
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0575, test: 0.0601
ACCURACY - train: 0.9828, test: 0.9810
norm of g = 0.1807
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.0607, test: 0.0597
ACCURACY - train: 0.9814, test: 0.9808
norm of g = 0.1505
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0656, test: 0.0595
ACCURACY - train: 0.9801, test: 0.9811
norm of g = 0.1596
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0610, test: 0.0597
ACCURACY - train: 0.9818, test: 0.9805
norm of g = 0.1815
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0587, test: 0.0595
ACCURACY - train: 0.9824, test: 0.9809
norm of g = 0.0866
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0568, test: 0.0593
ACCURACY - train: 0.9830, test: 0.9806
norm of g = 0.1304
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0602, test: 0.0591
ACCURACY - train: 0.9817, test: 0.9809
norm of g = 0.1591
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0650, test: 0.0590
ACCURACY - train: 0.9805, test: 0.9810
norm of g = 0.1444
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0607, test: 0.0585
ACCURACY - train: 0.9819, test: 0.9813
norm of g = 0.3301
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0595, test: 0.0623
ACCURACY - train: 0.9821, test: 0.9807
norm of g = 0.3509
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0595, test: 0.0623
ACCURACY - train: 0.9821, test: 0.9807
norm of g = 0.3509
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0572, test: 0.0595
ACCURACY - train: 0.9825, test: 0.9811
norm of g = 0.1267
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.0593, test: 0.0583
ACCURACY - train: 0.9818, test: 0.9815
norm of g = 0.1177
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.0627, test: 0.0581
ACCURACY - train: 0.9815, test: 0.9813
norm of g = 0.1286
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0584, test: 0.0582
ACCURACY - train: 0.9830, test: 0.9814
norm of g = 0.1795
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0573, test: 0.0578
ACCURACY - train: 0.9828, test: 0.9811
norm of g = 0.1255
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0560, test: 0.0586
ACCURACY - train: 0.9831, test: 0.9810
norm of g = 0.2439
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0560, test: 0.0586
ACCURACY - train: 0.9831, test: 0.9810
norm of g = 0.2439
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0586, test: 0.0573
ACCURACY - train: 0.9822, test: 0.9813
norm of g = 0.1500
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0625, test: 0.0578
ACCURACY - train: 0.9817, test: 0.9815
norm of g = 0.1621
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0571, test: 0.0572
ACCURACY - train: 0.9834, test: 0.9820
norm of g = 0.1414
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0557, test: 0.0576
ACCURACY - train: 0.9829, test: 0.9812
norm of g = 0.1272
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0553, test: 0.0577
ACCURACY - train: 0.9838, test: 0.9815
norm of g = 0.2213
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0586, test: 0.0573
ACCURACY - train: 0.9819, test: 0.9821
norm of g = 0.2905
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0623, test: 0.0577
ACCURACY - train: 0.9813, test: 0.9815
norm of g = 0.2747
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0562, test: 0.0565
ACCURACY - train: 0.9835, test: 0.9817
norm of g = 0.1271
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0547, test: 0.0569
ACCURACY - train: 0.9838, test: 0.9816
norm of g = 0.1220
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0539, test: 0.0567
ACCURACY - train: 0.9837, test: 0.9820
norm of g = 0.1317
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0567, test: 0.0561
ACCURACY - train: 0.9826, test: 0.9818
norm of g = 0.1949
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0605, test: 0.0579
ACCURACY - train: 0.9820, test: 0.9817
norm of g = 0.2389
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0575, test: 0.0567
ACCURACY - train: 0.9837, test: 0.9824
norm of g = 0.4959
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0552, test: 0.0563
ACCURACY - train: 0.9834, test: 0.9817
norm of g = 0.2926
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0530, test: 0.0561
ACCURACY - train: 0.9837, test: 0.9822
norm of g = 0.3158
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0530, test: 0.0561
ACCURACY - train: 0.9837, test: 0.9822
norm of g = 0.3158
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0546, test: 0.0540
ACCURACY - train: 0.9830, test: 0.9827
norm of g = 0.1236
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0571, test: 0.0536
ACCURACY - train: 0.9832, test: 0.9829
norm of g = 0.1577
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0518, test: 0.0533
ACCURACY - train: 0.9847, test: 0.9827
norm of g = 0.1485
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0507, test: 0.0540
ACCURACY - train: 0.9853, test: 0.9823
norm of g = 0.1021
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0507, test: 0.0540
ACCURACY - train: 0.9853, test: 0.9823
norm of g = 0.1021
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0506, test: 0.0534
ACCURACY - train: 0.9846, test: 0.9829
norm of g = 0.0941
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0531, test: 0.0533
ACCURACY - train: 0.9839, test: 0.9826
norm of g = 0.1293
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0560, test: 0.0538
ACCURACY - train: 0.9834, test: 0.9829
norm of g = 0.1933
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0512, test: 0.0531
ACCURACY - train: 0.9850, test: 0.9831
norm of g = 0.2021
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0512, test: 0.0531
ACCURACY - train: 0.9850, test: 0.9831
norm of g = 0.2021
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0504, test: 0.0531
ACCURACY - train: 0.9852, test: 0.9831
norm of g = 0.1036
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0499, test: 0.0531
ACCURACY - train: 0.9848, test: 0.9828
norm of g = 0.1142
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0520, test: 0.0527
ACCURACY - train: 0.9838, test: 0.9823
norm of g = 0.1748
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0551, test: 0.0523
ACCURACY - train: 0.9838, test: 0.9830
norm of g = 0.1452
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0512, test: 0.0534
ACCURACY - train: 0.9852, test: 0.9824
norm of g = 0.2323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0499, test: 0.0526
ACCURACY - train: 0.9850, test: 0.9830
norm of g = 0.1091
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0491, test: 0.0521
ACCURACY - train: 0.9848, test: 0.9829
norm of g = 0.2081
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0517, test: 0.0544
ACCURACY - train: 0.9842, test: 0.9829
norm of g = 0.3004
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0541, test: 0.0519
ACCURACY - train: 0.9838, test: 0.9836
norm of g = 0.1366
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0491, test: 0.0518
ACCURACY - train: 0.9855, test: 0.9830
norm of g = 0.1029
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0478, test: 0.0515
ACCURACY - train: 0.9860, test: 0.9832
norm of g = 0.0923
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0474, test: 0.0513
ACCURACY - train: 0.9857, test: 0.9832
norm of g = 0.1198
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0503, test: 0.0517
ACCURACY - train: 0.9844, test: 0.9828
norm of g = 0.2040
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0533, test: 0.0512
ACCURACY - train: 0.9840, test: 0.9829
norm of g = 0.1349
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0486, test: 0.0506
ACCURACY - train: 0.9861, test: 0.9835
norm of g = 0.1978
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0481, test: 0.0518
ACCURACY - train: 0.9857, test: 0.9839
norm of g = 0.2166
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0473, test: 0.0519
ACCURACY - train: 0.9858, test: 0.9828
norm of g = 0.2130
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0473, test: 0.0519
ACCURACY - train: 0.9858, test: 0.9828
norm of g = 0.2130
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0493, test: 0.0507
ACCURACY - train: 0.9851, test: 0.9832
norm of g = 0.1304
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0517, test: 0.0504
ACCURACY - train: 0.9848, test: 0.9836
norm of g = 0.0942
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0517, test: 0.0504
ACCURACY - train: 0.9848, test: 0.9836
norm of g = 0.0942
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0469, test: 0.0503
ACCURACY - train: 0.9866, test: 0.9834
norm of g = 0.1438
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0459, test: 0.0506
ACCURACY - train: 0.9865, test: 0.9832
norm of g = 0.0946
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0463, test: 0.0504
ACCURACY - train: 0.9859, test: 0.9835
norm of g = 0.1232
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0491, test: 0.0501
ACCURACY - train: 0.9851, test: 0.9838
norm of g = 0.1976
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0514, test: 0.0503
ACCURACY - train: 0.9846, test: 0.9833
norm of g = 0.1123
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0465, test: 0.0500
ACCURACY - train: 0.9864, test: 0.9836
norm of g = 0.1207
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0456, test: 0.0501
ACCURACY - train: 0.9866, test: 0.9835
norm of g = 0.1055
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0460, test: 0.0505
ACCURACY - train: 0.9858, test: 0.9835
norm of g = 0.1496
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0489, test: 0.0497
ACCURACY - train: 0.9848, test: 0.9834
norm of g = 0.2480
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0511, test: 0.0497
ACCURACY - train: 0.9845, test: 0.9836
norm of g = 0.1472
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0463, test: 0.0515
ACCURACY - train: 0.9865, test: 0.9832
norm of g = 0.2020
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0456, test: 0.0497
ACCURACY - train: 0.9865, test: 0.9841
norm of g = 0.2038
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0461, test: 0.0504
ACCURACY - train: 0.9858, test: 0.9838
norm of g = 0.2677
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0476, test: 0.0495
ACCURACY - train: 0.9855, test: 0.9836
norm of g = 0.1377
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0500, test: 0.0492
ACCURACY - train: 0.9851, test: 0.9836
norm of g = 0.1820
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0500, test: 0.0492
ACCURACY - train: 0.9851, test: 0.9836
norm of g = 0.1820
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0451, test: 0.0486
ACCURACY - train: 0.9865, test: 0.9838
norm of g = 0.1092
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0438, test: 0.0490
ACCURACY - train: 0.9869, test: 0.9835
norm of g = 0.0893
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0434, test: 0.0486
ACCURACY - train: 0.9870, test: 0.9842
norm of g = 0.1148
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0434, test: 0.0486
ACCURACY - train: 0.9870, test: 0.9842
norm of g = 0.1148
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0461, test: 0.0485
ACCURACY - train: 0.9860, test: 0.9840
norm of g = 0.1088
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0491, test: 0.0485
ACCURACY - train: 0.9853, test: 0.9842
norm of g = 0.0974
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0443, test: 0.0485
ACCURACY - train: 0.9871, test: 0.9844
norm of g = 0.1297
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0430, test: 0.0485
ACCURACY - train: 0.9872, test: 0.9839
norm of g = 0.0877
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0437, test: 0.0496
ACCURACY - train: 0.9868, test: 0.9840
norm of g = 0.2380
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0466, test: 0.0487
ACCURACY - train: 0.9855, test: 0.9836
norm of g = 0.2490
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0503, test: 0.0492
ACCURACY - train: 0.9850, test: 0.9834
norm of g = 0.3469
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0447, test: 0.0486
ACCURACY - train: 0.9875, test: 0.9839
norm of g = 0.2648
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0421, test: 0.0488
ACCURACY - train: 0.9877, test: 0.9843
norm of g = 0.1896
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0430, test: 0.0471
ACCURACY - train: 0.9866, test: 0.9846
norm of g = 0.2363
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0430, test: 0.0471
ACCURACY - train: 0.9866, test: 0.9846
norm of g = 0.2363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0455, test: 0.0476
ACCURACY - train: 0.9865, test: 0.9838
norm of g = 0.1329
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0476, test: 0.0475
ACCURACY - train: 0.9857, test: 0.9840
norm of g = 0.1186
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0420, test: 0.0474
ACCURACY - train: 0.9877, test: 0.9843
norm of g = 0.1620
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0410, test: 0.0475
ACCURACY - train: 0.9880, test: 0.9847
norm of g = 0.1320
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0421, test: 0.0480
ACCURACY - train: 0.9875, test: 0.9839
norm of g = 0.1485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0446, test: 0.0472
ACCURACY - train: 0.9863, test: 0.9841
norm of g = 0.1786
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0469, test: 0.0469
ACCURACY - train: 0.9863, test: 0.9845
norm of g = 0.1712
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0421, test: 0.0468
ACCURACY - train: 0.9879, test: 0.9844
norm of g = 0.2198
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0421, test: 0.0468
ACCURACY - train: 0.9879, test: 0.9844
norm of g = 0.2198
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0407, test: 0.0469
ACCURACY - train: 0.9877, test: 0.9842
norm of g = 0.1341
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0410, test: 0.0468
ACCURACY - train: 0.9878, test: 0.9845
norm of g = 0.1124
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0435, test: 0.0468
ACCURACY - train: 0.9870, test: 0.9840
norm of g = 0.1259
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0459, test: 0.0468
ACCURACY - train: 0.9866, test: 0.9842
norm of g = 0.0974
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0415, test: 0.0468
ACCURACY - train: 0.9877, test: 0.9843
norm of g = 0.1227
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0403, test: 0.0470
ACCURACY - train: 0.9883, test: 0.9842
norm of g = 0.0837
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0408, test: 0.0467
ACCURACY - train: 0.9878, test: 0.9848
norm of g = 0.1045
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0436, test: 0.0469
ACCURACY - train: 0.9867, test: 0.9841
norm of g = 0.1888
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0466, test: 0.0471
ACCURACY - train: 0.9861, test: 0.9838
norm of g = 0.2073
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0414, test: 0.0466
ACCURACY - train: 0.9883, test: 0.9846
norm of g = 0.1707
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0414, test: 0.0466
ACCURACY - train: 0.9883, test: 0.9846
norm of g = 0.1707
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0399, test: 0.0466
ACCURACY - train: 0.9885, test: 0.9843
norm of g = 0.1053
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0403, test: 0.0474
ACCURACY - train: 0.9880, test: 0.9844
norm of g = 0.1362
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0433, test: 0.0461
ACCURACY - train: 0.9870, test: 0.9848
norm of g = 0.2364
reached to the max num iteration -- BREAK
20 - 10 - preconditioning -- 1
2018-06-28 07:25:24.310489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:25:24.564974: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x424a7f0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:25:24.565808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:25:24.829298: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x424ecd0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:25:24.830150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:25:25.074382: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x42531b0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:25:25.075131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:25:25.075385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 07:25:25.075403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 07:25:25.075427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 07:25:25.075437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 07:25:25.075448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 07:25:25.075458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 07:25:25.075653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 07:25:25.075668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 07:25:25.075736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 07:25:25.075745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 07:25:25.075751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 07:25:25.075755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 07:25:25.075760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 07:25:25.075776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 07:25:25.075783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 07:25:25.075793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 07:25:25.075799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3974, test: 2.3976
ACCURACY - train: 0.0293, test: 0.0321
norm of g = 0.8616
Backtracking line search satisfied for alpha = 1.0000
initial gamma = 2.6143
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3104, test: 2.3133
ACCURACY - train: 0.1152, test: 0.1131
norm of g = 0.8593
gamma = 0.8398
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2533, test: 2.2526
ACCURACY - train: 0.2560, test: 0.2573
norm of g = 0.4851
gamma = 0.1585
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1125, test: 2.1041
ACCURACY - train: 0.3688, test: 0.3745
norm of g = 0.7289
shrinking trust region radius
gamma = 0.0667
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.1125, test: 2.1041
ACCURACY - train: 0.3687, test: 0.3745
norm of g = 0.7289
no need for safe gaurding
gamma = 33.9838
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.7388, test: 1.7260
ACCURACY - train: 0.6132, test: 0.6206
norm of g = 1.1323
no need for safe gaurding
gamma = 1.7462
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.4445, test: 1.4187
ACCURACY - train: 0.5400, test: 0.5520
norm of g = 2.0065
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.1282, test: 1.0852
ACCURACY - train: 0.6774, test: 0.7017
norm of g = 2.0945
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.1282, test: 1.0852
ACCURACY - train: 0.6774, test: 0.7017
norm of g = 2.0945
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 0.9953, test: 0.9590
ACCURACY - train: 0.7477, test: 0.7633
norm of g = 1.4916
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 0.9088, test: 0.8773
ACCURACY - train: 0.7595, test: 0.7693
norm of g = 1.6176
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.8153, test: 0.7902
ACCURACY - train: 0.7812, test: 0.7948
norm of g = 1.6290
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.7767, test: 0.7563
ACCURACY - train: 0.7844, test: 0.7871
norm of g = 2.0831
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.7188, test: 0.6798
ACCURACY - train: 0.8023, test: 0.8146
norm of g = 2.1424
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.6803, test: 0.6301
ACCURACY - train: 0.7966, test: 0.8203
norm of g = 1.7726
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.6803, test: 0.6301
ACCURACY - train: 0.7966, test: 0.8203
norm of g = 1.7726
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6267, test: 0.5884
ACCURACY - train: 0.8290, test: 0.8430
norm of g = 1.0257
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.5906, test: 0.5642
ACCURACY - train: 0.8446, test: 0.8540
norm of g = 0.6146
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.5793, test: 0.5492
ACCURACY - train: 0.8451, test: 0.8562
norm of g = 0.5416
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5779, test: 0.5345
ACCURACY - train: 0.8434, test: 0.8624
norm of g = 0.6094
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5644, test: 0.5200
ACCURACY - train: 0.8480, test: 0.8629
norm of g = 0.5096
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5402, test: 0.5058
ACCURACY - train: 0.8542, test: 0.8670
norm of g = 0.5045
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5148, test: 0.4917
ACCURACY - train: 0.8597, test: 0.8706
norm of g = 0.4541
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.5010, test: 0.4792
ACCURACY - train: 0.8636, test: 0.8731
norm of g = 0.4217
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4883, test: 0.4562
ACCURACY - train: 0.8640, test: 0.8760
norm of g = 0.4226
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4729, test: 0.4330
ACCURACY - train: 0.8669, test: 0.8815
norm of g = 0.4104
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4426, test: 0.4123
ACCURACY - train: 0.8725, test: 0.8870
norm of g = 0.3320
expanding trust region radius
no need for safe gaurding
gamma = 1.7508
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4177, test: 0.3933
ACCURACY - train: 0.8807, test: 0.8893
norm of g = 0.3298
no need for safe gaurding
gamma = 1.6096
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.3896, test: 0.3622
ACCURACY - train: 0.8872, test: 0.8982
norm of g = 0.4155
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.3856, test: 0.3509
ACCURACY - train: 0.8844, test: 0.8964
norm of g = 1.2562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.3497, test: 0.3130
ACCURACY - train: 0.8978, test: 0.9118
norm of g = 0.6626
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3317, test: 0.3049
ACCURACY - train: 0.9027, test: 0.9134
norm of g = 1.2717
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3022, test: 0.2908
ACCURACY - train: 0.9121, test: 0.9136
norm of g = 1.2632
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3022, test: 0.2908
ACCURACY - train: 0.9121, test: 0.9136
norm of g = 1.2632
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.2850, test: 0.2713
ACCURACY - train: 0.9152, test: 0.9224
norm of g = 0.3797
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.2944, test: 0.2703
ACCURACY - train: 0.9127, test: 0.9223
norm of g = 0.8033
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.2867, test: 0.2544
ACCURACY - train: 0.9159, test: 0.9262
norm of g = 0.4136
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.2867, test: 0.2544
ACCURACY - train: 0.9159, test: 0.9262
norm of g = 0.4136
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.2740, test: 0.2507
ACCURACY - train: 0.9185, test: 0.9271
norm of g = 0.2208
no need for safe gaurding
gamma = 1.1170
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.2688, test: 0.2465
ACCURACY - train: 0.9222, test: 0.9280
norm of g = 0.2165
no need for safe gaurding
gamma = 1.0755
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.2662, test: 0.2421
ACCURACY - train: 0.9216, test: 0.9292
norm of g = 0.2116
no need for safe gaurding
gamma = 1.0727
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.2608, test: 0.2379
ACCURACY - train: 0.9220, test: 0.9300
norm of g = 0.2542
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.2603, test: 0.2346
ACCURACY - train: 0.9254, test: 0.9311
norm of g = 0.2275
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.2526, test: 0.2298
ACCURACY - train: 0.9277, test: 0.9318
norm of g = 0.4130
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.2383, test: 0.2266
ACCURACY - train: 0.9309, test: 0.9333
norm of g = 0.3064
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.2341, test: 0.2247
ACCURACY - train: 0.9302, test: 0.9332
norm of g = 0.2999
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.2435, test: 0.2208
ACCURACY - train: 0.9291, test: 0.9360
norm of g = 0.3197
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.2458, test: 0.2154
ACCURACY - train: 0.9289, test: 0.9364
norm of g = 0.2396
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.2332, test: 0.2120
ACCURACY - train: 0.9312, test: 0.9374
norm of g = 0.2319
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.2314, test: 0.2096
ACCURACY - train: 0.9334, test: 0.9389
norm of g = 0.3144
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.2279, test: 0.2052
ACCURACY - train: 0.9342, test: 0.9397
norm of g = 0.1934
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.2213, test: 0.2021
ACCURACY - train: 0.9360, test: 0.9414
norm of g = 0.2522
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2213, test: 0.1992
ACCURACY - train: 0.9369, test: 0.9426
norm of g = 0.2443
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2143, test: 0.1953
ACCURACY - train: 0.9390, test: 0.9443
norm of g = 0.3143
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2024, test: 0.1926
ACCURACY - train: 0.9431, test: 0.9452
norm of g = 0.2908
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.1977, test: 0.1897
ACCURACY - train: 0.9433, test: 0.9449
norm of g = 0.1791
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2081, test: 0.1876
ACCURACY - train: 0.9396, test: 0.9466
norm of g = 0.2624
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2116, test: 0.1834
ACCURACY - train: 0.9389, test: 0.9484
norm of g = 0.2577
gamma = 0.0375
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.1993, test: 0.1799
ACCURACY - train: 0.9416, test: 0.9468
norm of g = 0.2404
shrinking trust region radius
gamma = 0.0350
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.1993, test: 0.1799
ACCURACY - train: 0.9416, test: 0.9468
norm of g = 0.2404
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2004, test: 0.1795
ACCURACY - train: 0.9423, test: 0.9483
norm of g = 0.1788
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.1993, test: 0.1779
ACCURACY - train: 0.9422, test: 0.9487
norm of g = 0.1831
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.1933, test: 0.1770
ACCURACY - train: 0.9448, test: 0.9490
norm of g = 0.2049
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.1947, test: 0.1755
ACCURACY - train: 0.9445, test: 0.9504
norm of g = 0.2015
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.1906, test: 0.1739
ACCURACY - train: 0.9452, test: 0.9509
norm of g = 0.3043
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.1815, test: 0.1726
ACCURACY - train: 0.9484, test: 0.9512
norm of g = 0.2307
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.1768, test: 0.1707
ACCURACY - train: 0.9493, test: 0.9507
norm of g = 0.1587
no need for safe gaurding
gamma = 1.4511
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.1865, test: 0.1677
ACCURACY - train: 0.9466, test: 0.9517
norm of g = 0.1928
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.1908, test: 0.1644
ACCURACY - train: 0.9450, test: 0.9531
norm of g = 0.2248
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.1794, test: 0.1614
ACCURACY - train: 0.9471, test: 0.9545
norm of g = 0.1873
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.1796, test: 0.1608
ACCURACY - train: 0.9473, test: 0.9533
norm of g = 0.2617
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.1768, test: 0.1569
ACCURACY - train: 0.9490, test: 0.9555
norm of g = 0.2181
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.1688, test: 0.1552
ACCURACY - train: 0.9515, test: 0.9556
norm of g = 0.1998
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.1690, test: 0.1526
ACCURACY - train: 0.9518, test: 0.9576
norm of g = 0.2333
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.1642, test: 0.1506
ACCURACY - train: 0.9542, test: 0.9585
norm of g = 0.3573
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.1545, test: 0.1481
ACCURACY - train: 0.9570, test: 0.9589
norm of g = 0.2144
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.1512, test: 0.1465
ACCURACY - train: 0.9577, test: 0.9594
norm of g = 0.1877
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.1609, test: 0.1441
ACCURACY - train: 0.9548, test: 0.9608
norm of g = 0.2498
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.1650, test: 0.1407
ACCURACY - train: 0.9518, test: 0.9610
norm of g = 0.1790
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.1541, test: 0.1387
ACCURACY - train: 0.9536, test: 0.9615
norm of g = 0.1923
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.1553, test: 0.1386
ACCURACY - train: 0.9547, test: 0.9615
norm of g = 0.3388
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.1529, test: 0.1353
ACCURACY - train: 0.9565, test: 0.9631
norm of g = 0.2357
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.1454, test: 0.1346
ACCURACY - train: 0.9598, test: 0.9625
norm of g = 0.3218
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.1448, test: 0.1316
ACCURACY - train: 0.9582, test: 0.9645
norm of g = 0.1710
no need for safe gaurding
gamma = 1.1348
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.1405, test: 0.1293
ACCURACY - train: 0.9612, test: 0.9657
norm of g = 0.2774
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.1343, test: 0.1301
ACCURACY - train: 0.9629, test: 0.9640
norm of g = 0.3957
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.1309, test: 0.1277
ACCURACY - train: 0.9620, test: 0.9646
norm of g = 0.2794
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.1397, test: 0.1249
ACCURACY - train: 0.9605, test: 0.9654
norm of g = 0.4882
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.1415, test: 0.1189
ACCURACY - train: 0.9581, test: 0.9676
norm of g = 0.2634
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1299, test: 0.1169
ACCURACY - train: 0.9608, test: 0.9679
norm of g = 0.1769
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1298, test: 0.1151
ACCURACY - train: 0.9617, test: 0.9678
norm of g = 0.3122
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.1278, test: 0.1120
ACCURACY - train: 0.9630, test: 0.9679
norm of g = 0.3740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.1171, test: 0.1106
ACCURACY - train: 0.9672, test: 0.9695
norm of g = 0.3004
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1167, test: 0.1059
ACCURACY - train: 0.9670, test: 0.9704
norm of g = 0.2536
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1125, test: 0.1041
ACCURACY - train: 0.9688, test: 0.9710
norm of g = 0.3720
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.1125, test: 0.1041
ACCURACY - train: 0.9688, test: 0.9710
norm of g = 0.3720
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.1062, test: 0.1034
ACCURACY - train: 0.9693, test: 0.9708
norm of g = 0.2035
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.1051, test: 0.1029
ACCURACY - train: 0.9688, test: 0.9706
norm of g = 0.1419
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1147, test: 0.1017
ACCURACY - train: 0.9682, test: 0.9707
norm of g = 0.2928
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1196, test: 0.0996
ACCURACY - train: 0.9651, test: 0.9721
norm of g = 0.3058
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.1112, test: 0.0999
ACCURACY - train: 0.9656, test: 0.9716
norm of g = 0.3761
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.1123, test: 0.1002
ACCURACY - train: 0.9683, test: 0.9709
norm of g = 0.4126
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.1123, test: 0.1002
ACCURACY - train: 0.9683, test: 0.9709
norm of g = 0.4126
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.1116, test: 0.0980
ACCURACY - train: 0.9681, test: 0.9719
norm of g = 0.2209
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.1034, test: 0.0976
ACCURACY - train: 0.9695, test: 0.9719
norm of g = 0.1781
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.1057, test: 0.0972
ACCURACY - train: 0.9696, test: 0.9723
norm of g = 0.1577
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1048, test: 0.0963
ACCURACY - train: 0.9711, test: 0.9724
norm of g = 0.2173
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.0982, test: 0.0962
ACCURACY - train: 0.9708, test: 0.9724
norm of g = 0.2336
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.0956, test: 0.0955
ACCURACY - train: 0.9709, test: 0.9720
norm of g = 0.2515
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.1068, test: 0.0935
ACCURACY - train: 0.9683, test: 0.9727
norm of g = 0.4650
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1093, test: 0.0902
ACCURACY - train: 0.9682, test: 0.9735
norm of g = 0.3060
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1093, test: 0.0902
ACCURACY - train: 0.9683, test: 0.9735
norm of g = 0.3060
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1004, test: 0.0892
ACCURACY - train: 0.9702, test: 0.9739
norm of g = 0.1580
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1026, test: 0.0892
ACCURACY - train: 0.9705, test: 0.9742
norm of g = 0.1786
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1023, test: 0.0901
ACCURACY - train: 0.9704, test: 0.9738
norm of g = 0.3068
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.0928, test: 0.0870
ACCURACY - train: 0.9727, test: 0.9747
norm of g = 0.2335
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.0941, test: 0.0866
ACCURACY - train: 0.9721, test: 0.9749
norm of g = 0.1828
no need for safe gaurding
gamma = 1.4568
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.0905, test: 0.0854
ACCURACY - train: 0.9749, test: 0.9753
norm of g = 0.2377
no need for safe gaurding
gamma = 1.1406
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.0843, test: 0.0850
ACCURACY - train: 0.9762, test: 0.9761
norm of g = 0.2278
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.0834, test: 0.0849
ACCURACY - train: 0.9744, test: 0.9749
norm of g = 0.3452
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.0924, test: 0.0809
ACCURACY - train: 0.9731, test: 0.9764
norm of g = 0.2611
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.0924, test: 0.0809
ACCURACY - train: 0.9731, test: 0.9764
norm of g = 0.2611
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.0976, test: 0.0796
ACCURACY - train: 0.9714, test: 0.9781
norm of g = 0.1807
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.0902, test: 0.0794
ACCURACY - train: 0.9732, test: 0.9775
norm of g = 0.1905
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.0921, test: 0.0794
ACCURACY - train: 0.9734, test: 0.9772
norm of g = 0.1743
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.0910, test: 0.0790
ACCURACY - train: 0.9730, test: 0.9773
norm of g = 0.1500
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.0816, test: 0.0781
ACCURACY - train: 0.9750, test: 0.9774
norm of g = 0.1483
no need for safe gaurding
gamma = 1.0396
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.0832, test: 0.0775
ACCURACY - train: 0.9750, test: 0.9781
norm of g = 0.1665
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.0822, test: 0.0771
ACCURACY - train: 0.9771, test: 0.9783
norm of g = 0.2481
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.0764, test: 0.0770
ACCURACY - train: 0.9772, test: 0.9775
norm of g = 0.3297
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.0756, test: 0.0776
ACCURACY - train: 0.9768, test: 0.9782
norm of g = 0.2682
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.0865, test: 0.0763
ACCURACY - train: 0.9749, test: 0.9775
norm of g = 0.3036
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.0923, test: 0.0741
ACCURACY - train: 0.9730, test: 0.9782
norm of g = 0.3380
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.0835, test: 0.0747
ACCURACY - train: 0.9746, test: 0.9775
norm of g = 0.1354
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.0846, test: 0.0742
ACCURACY - train: 0.9753, test: 0.9779
norm of g = 0.1617
expanding trust region radius
no need for safe gaurding
gamma = 1.2206
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.0825, test: 0.0722
ACCURACY - train: 0.9747, test: 0.9783
norm of g = 0.2652
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.0825, test: 0.0722
ACCURACY - train: 0.9747, test: 0.9783
norm of g = 0.2652
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.0750, test: 0.0723
ACCURACY - train: 0.9773, test: 0.9782
norm of g = 0.3336
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.0764, test: 0.0729
ACCURACY - train: 0.9771, test: 0.9800
norm of g = 0.2432
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.0768, test: 0.0713
ACCURACY - train: 0.9779, test: 0.9789
norm of g = 0.3258
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.0706, test: 0.0707
ACCURACY - train: 0.9796, test: 0.9797
norm of g = 0.2600
expanding trust region radius
gamma = 0.0265
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.0688, test: 0.0713
ACCURACY - train: 0.9794, test: 0.9784
norm of g = 0.2232
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.0688, test: 0.0713
ACCURACY - train: 0.9794, test: 0.9784
norm of g = 0.2232
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.0788, test: 0.0688
ACCURACY - train: 0.9763, test: 0.9798
norm of g = 0.2247
shrinking trust region radius
gamma = 0.0199
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.0788, test: 0.0688
ACCURACY - train: 0.9763, test: 0.9798
norm of g = 0.2247
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.0788, test: 0.0688
ACCURACY - train: 0.9763, test: 0.9798
norm of g = 0.2247
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.0843, test: 0.0684
ACCURACY - train: 0.9748, test: 0.9800
norm of g = 0.1037
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.0776, test: 0.0684
ACCURACY - train: 0.9763, test: 0.9798
norm of g = 0.1392
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.0789, test: 0.0685
ACCURACY - train: 0.9771, test: 0.9795
norm of g = 0.1640
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.0775, test: 0.0689
ACCURACY - train: 0.9768, test: 0.9788
norm of g = 0.1758
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0701, test: 0.0686
ACCURACY - train: 0.9793, test: 0.9795
norm of g = 0.1883
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.0722, test: 0.0681
ACCURACY - train: 0.9788, test: 0.9799
norm of g = 0.1814
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.0721, test: 0.0671
ACCURACY - train: 0.9790, test: 0.9804
norm of g = 0.2323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0656, test: 0.0681
ACCURACY - train: 0.9803, test: 0.9802
norm of g = 0.2734
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0655, test: 0.0683
ACCURACY - train: 0.9799, test: 0.9796
norm of g = 0.1767
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.0773, test: 0.0677
ACCURACY - train: 0.9768, test: 0.9796
norm of g = 0.2562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.0824, test: 0.0667
ACCURACY - train: 0.9757, test: 0.9802
norm of g = 0.2303
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.0753, test: 0.0670
ACCURACY - train: 0.9764, test: 0.9797
norm of g = 0.1737
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.0753, test: 0.0670
ACCURACY - train: 0.9764, test: 0.9797
norm of g = 0.1737
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.0764, test: 0.0668
ACCURACY - train: 0.9777, test: 0.9798
norm of g = 0.1645
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0754, test: 0.0668
ACCURACY - train: 0.9784, test: 0.9799
norm of g = 0.1682
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0683, test: 0.0668
ACCURACY - train: 0.9797, test: 0.9798
norm of g = 0.1695
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0705, test: 0.0670
ACCURACY - train: 0.9793, test: 0.9805
norm of g = 0.1567
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0703, test: 0.0666
ACCURACY - train: 0.9793, test: 0.9809
norm of g = 0.1944
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0641, test: 0.0668
ACCURACY - train: 0.9803, test: 0.9805
norm of g = 0.2091
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0640, test: 0.0670
ACCURACY - train: 0.9803, test: 0.9793
norm of g = 0.2008
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0754, test: 0.0666
ACCURACY - train: 0.9770, test: 0.9803
norm of g = 0.2986
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0814, test: 0.0670
ACCURACY - train: 0.9755, test: 0.9799
norm of g = 0.3804
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.0742, test: 0.0658
ACCURACY - train: 0.9774, test: 0.9806
norm of g = 0.1900
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.0754, test: 0.0667
ACCURACY - train: 0.9788, test: 0.9793
norm of g = 0.2127
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.0740, test: 0.0658
ACCURACY - train: 0.9785, test: 0.9805
norm of g = 0.1759
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0667, test: 0.0657
ACCURACY - train: 0.9799, test: 0.9802
norm of g = 0.1792
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.0688, test: 0.0655
ACCURACY - train: 0.9795, test: 0.9809
norm of g = 0.1352
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.0689, test: 0.0649
ACCURACY - train: 0.9798, test: 0.9811
norm of g = 0.3037
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0626, test: 0.0662
ACCURACY - train: 0.9817, test: 0.9808
norm of g = 0.2485
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0630, test: 0.0670
ACCURACY - train: 0.9809, test: 0.9795
norm of g = 0.2784
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0630, test: 0.0670
ACCURACY - train: 0.9809, test: 0.9795
norm of g = 0.2784
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0742, test: 0.0650
ACCURACY - train: 0.9778, test: 0.9804
norm of g = 0.2307
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0787, test: 0.0641
ACCURACY - train: 0.9762, test: 0.9806
norm of g = 0.1381
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0722, test: 0.0641
ACCURACY - train: 0.9778, test: 0.9814
norm of g = 0.1562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0730, test: 0.0640
ACCURACY - train: 0.9798, test: 0.9807
norm of g = 0.1583
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.0716, test: 0.0641
ACCURACY - train: 0.9790, test: 0.9806
norm of g = 0.1583
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0642, test: 0.0640
ACCURACY - train: 0.9803, test: 0.9809
norm of g = 0.1625
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0658, test: 0.0638
ACCURACY - train: 0.9805, test: 0.9810
norm of g = 0.1362
no need for safe gaurding
gamma = 1.0470
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.0656, test: 0.0638
ACCURACY - train: 0.9813, test: 0.9815
norm of g = 0.2007
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0605, test: 0.0636
ACCURACY - train: 0.9828, test: 0.9818
norm of g = 0.2313
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0617, test: 0.0654
ACCURACY - train: 0.9814, test: 0.9798
norm of g = 0.2973
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0743, test: 0.0650
ACCURACY - train: 0.9775, test: 0.9807
norm of g = 0.5032
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0796, test: 0.0633
ACCURACY - train: 0.9758, test: 0.9814
norm of g = 0.4775
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0721, test: 0.0641
ACCURACY - train: 0.9784, test: 0.9800
norm of g = 0.4889
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0727, test: 0.0656
ACCURACY - train: 0.9798, test: 0.9789
norm of g = 0.4657
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0702, test: 0.0631
ACCURACY - train: 0.9792, test: 0.9801
norm of g = 0.1925
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0622, test: 0.0623
ACCURACY - train: 0.9812, test: 0.9808
norm of g = 0.1840
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0633, test: 0.0623
ACCURACY - train: 0.9813, test: 0.9817
norm of g = 0.1541
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0636, test: 0.0616
ACCURACY - train: 0.9814, test: 0.9819
norm of g = 0.1785
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.0578, test: 0.0615
ACCURACY - train: 0.9829, test: 0.9815
norm of g = 0.1762
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.0578, test: 0.0612
ACCURACY - train: 0.9828, test: 0.9818
norm of g = 0.1605
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0695, test: 0.0622
ACCURACY - train: 0.9796, test: 0.9811
norm of g = 0.2961
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0738, test: 0.0606
ACCURACY - train: 0.9775, test: 0.9820
norm of g = 0.1642
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0675, test: 0.0607
ACCURACY - train: 0.9788, test: 0.9820
norm of g = 0.1328
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0694, test: 0.0623
ACCURACY - train: 0.9803, test: 0.9811
norm of g = 0.3090
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0677, test: 0.0603
ACCURACY - train: 0.9795, test: 0.9814
norm of g = 0.2060
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0591, test: 0.0604
ACCURACY - train: 0.9826, test: 0.9814
norm of g = 0.1906
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0630, test: 0.0615
ACCURACY - train: 0.9817, test: 0.9825
norm of g = 0.3449
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0627, test: 0.0621
ACCURACY - train: 0.9812, test: 0.9816
norm of g = 0.4330
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0573, test: 0.0612
ACCURACY - train: 0.9825, test: 0.9818
norm of g = 0.2676
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0573, test: 0.0595
ACCURACY - train: 0.9829, test: 0.9831
norm of g = 0.4134
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0573, test: 0.0595
ACCURACY - train: 0.9829, test: 0.9831
norm of g = 0.4134
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0670, test: 0.0573
ACCURACY - train: 0.9800, test: 0.9825
norm of g = 0.2026
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0714, test: 0.0575
ACCURACY - train: 0.9785, test: 0.9827
norm of g = 0.1649
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0646, test: 0.0571
ACCURACY - train: 0.9802, test: 0.9827
norm of g = 0.1386
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0646, test: 0.0578
ACCURACY - train: 0.9818, test: 0.9826
norm of g = 0.1975
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0627, test: 0.0582
ACCURACY - train: 0.9813, test: 0.9818
norm of g = 0.2163
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0546, test: 0.0567
ACCURACY - train: 0.9838, test: 0.9827
norm of g = 0.1616
expanding trust region radius
no need for safe gaurding
gamma = 1.0255
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0562, test: 0.0566
ACCURACY - train: 0.9836, test: 0.9831
norm of g = 0.1575
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0570, test: 0.0574
ACCURACY - train: 0.9827, test: 0.9824
norm of g = 0.2363
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0570, test: 0.0574
ACCURACY - train: 0.9827, test: 0.9824
norm of g = 0.2363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0536, test: 0.0573
ACCURACY - train: 0.9838, test: 0.9821
norm of g = 0.2402
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0543, test: 0.0576
ACCURACY - train: 0.9836, test: 0.9824
norm of g = 0.2010
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0641, test: 0.0560
ACCURACY - train: 0.9809, test: 0.9828
norm of g = 0.2377
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0678, test: 0.0553
ACCURACY - train: 0.9793, test: 0.9831
norm of g = 0.1486
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0611, test: 0.0553
ACCURACY - train: 0.9816, test: 0.9829
norm of g = 0.1120
no need for safe gaurding
gamma = 1.0162
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0608, test: 0.0549
ACCURACY - train: 0.9830, test: 0.9835
norm of g = 0.1733
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0600, test: 0.0573
ACCURACY - train: 0.9822, test: 0.9825
norm of g = 0.2729
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0600, test: 0.0573
ACCURACY - train: 0.9822, test: 0.9825
norm of g = 0.2729
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0523, test: 0.0552
ACCURACY - train: 0.9842, test: 0.9831
norm of g = 0.1546
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0534, test: 0.0553
ACCURACY - train: 0.9843, test: 0.9835
norm of g = 0.1441
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0563, test: 0.0558
ACCURACY - train: 0.9830, test: 0.9833
norm of g = 0.3441
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0528, test: 0.0562
ACCURACY - train: 0.9848, test: 0.9827
norm of g = 0.3649
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0512, test: 0.0547
ACCURACY - train: 0.9843, test: 0.9829
norm of g = 0.1472
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0613, test: 0.0544
ACCURACY - train: 0.9813, test: 0.9833
norm of g = 0.2749
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0666, test: 0.0538
ACCURACY - train: 0.9796, test: 0.9842
norm of g = 0.3547
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0584, test: 0.0543
ACCURACY - train: 0.9823, test: 0.9833
norm of g = 0.1955
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0584, test: 0.0543
ACCURACY - train: 0.9823, test: 0.9833
norm of g = 0.1955
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0594, test: 0.0538
ACCURACY - train: 0.9826, test: 0.9839
norm of g = 0.1456
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0586, test: 0.0538
ACCURACY - train: 0.9824, test: 0.9838
norm of g = 0.1604
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0515, test: 0.0541
ACCURACY - train: 0.9854, test: 0.9836
norm of g = 0.1851
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0519, test: 0.0538
ACCURACY - train: 0.9850, test: 0.9838
norm of g = 0.1541
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0530, test: 0.0536
ACCURACY - train: 0.9851, test: 0.9838
norm of g = 0.1883
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0490, test: 0.0538
ACCURACY - train: 0.9858, test: 0.9834
norm of g = 0.2140
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0496, test: 0.0539
ACCURACY - train: 0.9844, test: 0.9831
norm of g = 0.2098
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0590, test: 0.0527
ACCURACY - train: 0.9822, test: 0.9838
norm of g = 0.2472
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0590, test: 0.0527
ACCURACY - train: 0.9822, test: 0.9838
norm of g = 0.2472
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0628, test: 0.0520
ACCURACY - train: 0.9812, test: 0.9840
norm of g = 0.1284
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0574, test: 0.0523
ACCURACY - train: 0.9830, test: 0.9842
norm of g = 0.1397
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0579, test: 0.0532
ACCURACY - train: 0.9838, test: 0.9838
norm of g = 0.1460
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0561, test: 0.0528
ACCURACY - train: 0.9837, test: 0.9828
norm of g = 0.1448
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0561, test: 0.0528
ACCURACY - train: 0.9837, test: 0.9828
norm of g = 0.1448
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0502, test: 0.0525
ACCURACY - train: 0.9848, test: 0.9838
norm of g = 0.1755
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0505, test: 0.0536
ACCURACY - train: 0.9851, test: 0.9844
norm of g = 0.2331
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0524, test: 0.0526
ACCURACY - train: 0.9843, test: 0.9840
norm of g = 0.3628
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0483, test: 0.0529
ACCURACY - train: 0.9863, test: 0.9830
norm of g = 0.3014
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0475, test: 0.0519
ACCURACY - train: 0.9858, test: 0.9842
norm of g = 0.1702
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0573, test: 0.0504
ACCURACY - train: 0.9827, test: 0.9848
norm of g = 0.2357
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0603, test: 0.0509
ACCURACY - train: 0.9822, test: 0.9843
norm of g = 0.1401
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0603, test: 0.0509
ACCURACY - train: 0.9822, test: 0.9843
norm of g = 0.1401
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0543, test: 0.0509
ACCURACY - train: 0.9843, test: 0.9844
norm of g = 0.1389
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0554, test: 0.0511
ACCURACY - train: 0.9845, test: 0.9840
norm of g = 0.2610
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0540, test: 0.0512
ACCURACY - train: 0.9843, test: 0.9845
norm of g = 0.1417
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0469, test: 0.0509
ACCURACY - train: 0.9864, test: 0.9850
norm of g = 0.2277
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0501, test: 0.0548
ACCURACY - train: 0.9857, test: 0.9830
norm of g = 0.4628
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0523, test: 0.0540
ACCURACY - train: 0.9846, test: 0.9839
norm of g = 0.3785
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0523, test: 0.0540
ACCURACY - train: 0.9846, test: 0.9839
norm of g = 0.3785
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0473, test: 0.0516
ACCURACY - train: 0.9863, test: 0.9839
norm of g = 0.1889
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0449, test: 0.0500
ACCURACY - train: 0.9863, test: 0.9842
norm of g = 0.1427
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0449, test: 0.0500
ACCURACY - train: 0.9863, test: 0.9842
norm of g = 0.1427
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0553, test: 0.0494
ACCURACY - train: 0.9836, test: 0.9848
norm of g = 0.2013
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0593, test: 0.0490
ACCURACY - train: 0.9816, test: 0.9849
norm of g = 0.1164
expanding trust region radius
no need for safe gaurding
gamma = 1.0220
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0519, test: 0.0490
ACCURACY - train: 0.9849, test: 0.9847
norm of g = 0.1221
expanding trust region radius
no need for safe gaurding
gamma = 1.4253
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0515, test: 0.0492
ACCURACY - train: 0.9855, test: 0.9844
norm of g = 0.1872
shrinking trust region radius
no need for safe gaurding
gamma = 1.0723
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0515, test: 0.0492
ACCURACY - train: 0.9855, test: 0.9844
norm of g = 0.1872
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0507, test: 0.0496
ACCURACY - train: 0.9849, test: 0.9843
norm of g = 0.1747
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0507, test: 0.0496
ACCURACY - train: 0.9849, test: 0.9843
norm of g = 0.1747
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0448, test: 0.0496
ACCURACY - train: 0.9867, test: 0.9852
norm of g = 0.2133
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0465, test: 0.0496
ACCURACY - train: 0.9869, test: 0.9850
norm of g = 0.2613
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0490, test: 0.0488
ACCURACY - train: 0.9856, test: 0.9850
norm of g = 0.2321
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0444, test: 0.0486
ACCURACY - train: 0.9872, test: 0.9849
norm of g = 0.2036
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0430, test: 0.0484
ACCURACY - train: 0.9867, test: 0.9849
norm of g = 0.1562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0535, test: 0.0495
ACCURACY - train: 0.9840, test: 0.9851
norm of g = 0.3241
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0535, test: 0.0495
ACCURACY - train: 0.9840, test: 0.9851
norm of g = 0.3241
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0580, test: 0.0494
ACCURACY - train: 0.9830, test: 0.9847
norm of g = 0.2493
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0502, test: 0.0476
ACCURACY - train: 0.9852, test: 0.9855
norm of g = 0.1655
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0501, test: 0.0479
ACCURACY - train: 0.9860, test: 0.9852
norm of g = 0.1868
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0493, test: 0.0482
ACCURACY - train: 0.9853, test: 0.9851
norm of g = 0.1252
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0438, test: 0.0474
ACCURACY - train: 0.9870, test: 0.9853
norm of g = 0.1435
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0453, test: 0.0487
ACCURACY - train: 0.9865, test: 0.9852
norm of g = 0.1802
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0471, test: 0.0481
ACCURACY - train: 0.9864, test: 0.9851
norm of g = 0.2227
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0417, test: 0.0477
ACCURACY - train: 0.9881, test: 0.9851
norm of g = 0.1814
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0409, test: 0.0479
ACCURACY - train: 0.9877, test: 0.9851
norm of g = 0.2105
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0523, test: 0.0476
ACCURACY - train: 0.9848, test: 0.9847
norm of g = 0.3183
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0559, test: 0.0471
ACCURACY - train: 0.9838, test: 0.9855
norm of g = 0.1970
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0486, test: 0.0469
ACCURACY - train: 0.9861, test: 0.9850
norm of g = 0.1537
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0492, test: 0.0485
ACCURACY - train: 0.9864, test: 0.9848
norm of g = 0.2165
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0482, test: 0.0477
ACCURACY - train: 0.9864, test: 0.9851
norm of g = 0.1608
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0429, test: 0.0476
ACCURACY - train: 0.9872, test: 0.9852
norm of g = 0.2030
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0439, test: 0.0478
ACCURACY - train: 0.9870, test: 0.9861
norm of g = 0.1607
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0453, test: 0.0487
ACCURACY - train: 0.9869, test: 0.9848
norm of g = 0.2923
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0415, test: 0.0493
ACCURACY - train: 0.9883, test: 0.9844
norm of g = 0.2486
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0438, test: 0.0488
ACCURACY - train: 0.9871, test: 0.9851
norm of g = 0.4197
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0438, test: 0.0488
ACCURACY - train: 0.9871, test: 0.9851
norm of g = 0.4197
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0527, test: 0.0463
ACCURACY - train: 0.9833, test: 0.9853
norm of g = 0.2164
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0542, test: 0.0456
ACCURACY - train: 0.9838, test: 0.9858
norm of g = 0.1537
reached to the max num iteration -- BREAK
20 - 25 - preconditioning -- 1
2018-06-28 07:50:33.311119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:50:33.588665: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4bf0850 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:50:33.589514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:50:33.857414: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4bf4d30 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:50:33.858291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:50:34.148285: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x4bf9210 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 07:50:34.149303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 07:50:34.149621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 07:50:34.149659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 07:50:34.149697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 07:50:34.149715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 07:50:34.149733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 07:50:34.149749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 07:50:34.149990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 07:50:34.150015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 07:50:34.150115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 07:50:34.150128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 07:50:34.150135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 07:50:34.150148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 07:50:34.150155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 07:50:34.150173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 07:50:34.150183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 07:50:34.150190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 07:50:34.150197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3755, test: 2.3762
ACCURACY - train: 0.1046, test: 0.0957
norm of g = 0.7399
Backtracking line search satisfied for alpha = 0.8100
initial gamma = 4.2204
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3296, test: 2.3328
ACCURACY - train: 0.1569, test: 0.1574
norm of g = 0.9776
gamma = 1.3149
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2722, test: 2.2687
ACCURACY - train: 0.1100, test: 0.1145
norm of g = 0.3871
gamma = 0.3804
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.2222, test: 2.2208
ACCURACY - train: 0.1542, test: 0.1502
norm of g = 0.6392
no need for safe gaurding
gamma = 4.4691
weights are updated
------------------------------------------------------------
iteration: 3
LOSS     - train: 1.7226, test: 1.7231
ACCURACY - train: 0.4387, test: 0.4301
norm of g = 6.8217
shrinking trust region radius
no need for safe gaurding
gamma = 1.1234
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.7226, test: 1.7231
ACCURACY - train: 0.4387, test: 0.4301
norm of g = 6.8217
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.7226, test: 1.7231
ACCURACY - train: 0.4387, test: 0.4301
norm of g = 6.8217
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.2581, test: 1.2446
ACCURACY - train: 0.6692, test: 0.6717
norm of g = 2.6050
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.2581, test: 1.2446
ACCURACY - train: 0.6692, test: 0.6717
norm of g = 2.6050
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.1780, test: 1.1640
ACCURACY - train: 0.7173, test: 0.7241
norm of g = 1.8077
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.0962, test: 1.0617
ACCURACY - train: 0.7483, test: 0.7566
norm of g = 1.3586
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 1.0301, test: 0.9865
ACCURACY - train: 0.7429, test: 0.7545
norm of g = 1.4852
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.8819, test: 0.8643
ACCURACY - train: 0.7613, test: 0.7674
norm of g = 1.9205
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.8819, test: 0.8643
ACCURACY - train: 0.7612, test: 0.7674
norm of g = 1.9205
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.8366, test: 0.8224
ACCURACY - train: 0.7910, test: 0.7911
norm of g = 1.0310
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.7822, test: 0.7709
ACCURACY - train: 0.8019, test: 0.8031
norm of g = 1.1448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.7327, test: 0.7237
ACCURACY - train: 0.8094, test: 0.8143
norm of g = 1.1642
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.7206, test: 0.7014
ACCURACY - train: 0.7967, test: 0.7984
norm of g = 1.7369
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.6782, test: 0.6584
ACCURACY - train: 0.8038, test: 0.8154
norm of g = 1.6102
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.6411, test: 0.6263
ACCURACY - train: 0.8223, test: 0.8355
norm of g = 1.2773
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.6213, test: 0.5827
ACCURACY - train: 0.8267, test: 0.8432
norm of g = 0.9085
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.6165, test: 0.5544
ACCURACY - train: 0.8158, test: 0.8431
norm of g = 1.1771
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5770, test: 0.5285
ACCURACY - train: 0.8323, test: 0.8561
norm of g = 1.0859
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.5770, test: 0.5285
ACCURACY - train: 0.8323, test: 0.8561
norm of g = 1.0859
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.5538, test: 0.5160
ACCURACY - train: 0.8515, test: 0.8581
norm of g = 0.6560
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.5435, test: 0.5053
ACCURACY - train: 0.8448, test: 0.8594
norm of g = 0.8927
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.5219, test: 0.4935
ACCURACY - train: 0.8540, test: 0.8614
norm of g = 0.7279
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.5123, test: 0.4804
ACCURACY - train: 0.8594, test: 0.8678
norm of g = 0.5379
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.5022, test: 0.4682
ACCURACY - train: 0.8613, test: 0.8716
norm of g = 0.5803
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4690, test: 0.4598
ACCURACY - train: 0.8681, test: 0.8718
norm of g = 0.5215
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4549, test: 0.4469
ACCURACY - train: 0.8696, test: 0.8757
norm of g = 0.4954
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4561, test: 0.4387
ACCURACY - train: 0.8710, test: 0.8783
norm of g = 0.7549
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4495, test: 0.4281
ACCURACY - train: 0.8748, test: 0.8819
norm of g = 0.7442
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.4392, test: 0.4218
ACCURACY - train: 0.8760, test: 0.8827
norm of g = 0.5663
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.4449, test: 0.4096
ACCURACY - train: 0.8785, test: 0.8852
norm of g = 0.4424
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.4459, test: 0.4038
ACCURACY - train: 0.8758, test: 0.8872
norm of g = 0.8270
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.4154, test: 0.3952
ACCURACY - train: 0.8806, test: 0.8892
norm of g = 0.7896
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.4232, test: 0.3904
ACCURACY - train: 0.8771, test: 0.8906
norm of g = 1.1592
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.4182, test: 0.3827
ACCURACY - train: 0.8844, test: 0.8926
norm of g = 0.7158
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.4182, test: 0.3827
ACCURACY - train: 0.8844, test: 0.8926
norm of g = 0.7158
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.4043, test: 0.3786
ACCURACY - train: 0.8825, test: 0.8932
norm of g = 0.3648
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3966, test: 0.3756
ACCURACY - train: 0.8881, test: 0.8942
norm of g = 0.3867
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3844, test: 0.3732
ACCURACY - train: 0.8952, test: 0.8948
norm of g = 0.3880
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3821, test: 0.3712
ACCURACY - train: 0.8927, test: 0.8959
norm of g = 0.5151
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3937, test: 0.3695
ACCURACY - train: 0.8842, test: 0.8961
norm of g = 0.4028
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3863, test: 0.3662
ACCURACY - train: 0.8869, test: 0.8974
norm of g = 0.4227
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3740, test: 0.3634
ACCURACY - train: 0.8910, test: 0.8984
norm of g = 0.3421
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.3908, test: 0.3599
ACCURACY - train: 0.8883, test: 0.8991
norm of g = 0.4918
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.4059, test: 0.3551
ACCURACY - train: 0.8771, test: 0.9006
norm of g = 0.5229
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.3833, test: 0.3490
ACCURACY - train: 0.8852, test: 0.9026
norm of g = 0.4798
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.3741, test: 0.3431
ACCURACY - train: 0.8946, test: 0.9032
norm of g = 0.6303
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.3710, test: 0.3360
ACCURACY - train: 0.8946, test: 0.9046
norm of g = 0.6254
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.3489, test: 0.3314
ACCURACY - train: 0.9000, test: 0.9066
norm of g = 0.5977
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.3506, test: 0.3266
ACCURACY - train: 0.9002, test: 0.9099
norm of g = 0.4448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.3482, test: 0.3196
ACCURACY - train: 0.9015, test: 0.9098
norm of g = 0.4886
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.3210, test: 0.3160
ACCURACY - train: 0.9071, test: 0.9117
norm of g = 0.4217
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.3146, test: 0.3103
ACCURACY - train: 0.9083, test: 0.9130
norm of g = 0.5656
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.3116, test: 0.3037
ACCURACY - train: 0.9098, test: 0.9149
norm of g = 0.4200
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.3048, test: 0.2973
ACCURACY - train: 0.9127, test: 0.9160
norm of g = 0.3960
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.3043, test: 0.2937
ACCURACY - train: 0.9119, test: 0.9165
norm of g = 0.5757
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.3215, test: 0.2880
ACCURACY - train: 0.9137, test: 0.9167
norm of g = 0.2993
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.3222, test: 0.2831
ACCURACY - train: 0.9115, test: 0.9197
norm of g = 0.4150
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.2948, test: 0.2775
ACCURACY - train: 0.9123, test: 0.9216
norm of g = 0.4103
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.3005, test: 0.2727
ACCURACY - train: 0.9133, test: 0.9220
norm of g = 0.5532
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2963, test: 0.2693
ACCURACY - train: 0.9192, test: 0.9229
norm of g = 0.3269
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2852, test: 0.2647
ACCURACY - train: 0.9206, test: 0.9233
norm of g = 0.4108
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.2795, test: 0.2602
ACCURACY - train: 0.9194, test: 0.9255
norm of g = 0.3818
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.2694, test: 0.2557
ACCURACY - train: 0.9233, test: 0.9269
norm of g = 0.3336
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.2688, test: 0.2547
ACCURACY - train: 0.9244, test: 0.9267
norm of g = 0.7729
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2761, test: 0.2501
ACCURACY - train: 0.9217, test: 0.9284
norm of g = 0.6391
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2683, test: 0.2476
ACCURACY - train: 0.9185, test: 0.9292
norm of g = 0.4441
expanding trust region radius
gamma = 0.0162
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.2503, test: 0.2435
ACCURACY - train: 0.9269, test: 0.9300
norm of g = 0.2582
gamma = 0.1035
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.2664, test: 0.2423
ACCURACY - train: 0.9254, test: 0.9287
norm of g = 0.9804
gamma = 0.1193
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.2747, test: 0.2377
ACCURACY - train: 0.9198, test: 0.9328
norm of g = 1.0422
shrinking trust region radius
gamma = 0.1241
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.2747, test: 0.2377
ACCURACY - train: 0.9198, test: 0.9328
norm of g = 1.0422
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.2530, test: 0.2321
ACCURACY - train: 0.9248, test: 0.9330
norm of g = 0.3955
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.2513, test: 0.2281
ACCURACY - train: 0.9254, test: 0.9337
norm of g = 0.3966
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2494, test: 0.2243
ACCURACY - train: 0.9260, test: 0.9350
norm of g = 0.5535
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2494, test: 0.2243
ACCURACY - train: 0.9260, test: 0.9350
norm of g = 0.5535
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.2330, test: 0.2232
ACCURACY - train: 0.9296, test: 0.9361
norm of g = 0.2880
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.2429, test: 0.2228
ACCURACY - train: 0.9279, test: 0.9353
norm of g = 0.3070
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.2437, test: 0.2221
ACCURACY - train: 0.9294, test: 0.9362
norm of g = 0.2744
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.2231, test: 0.2198
ACCURACY - train: 0.9352, test: 0.9375
norm of g = 0.2972
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.2217, test: 0.2183
ACCURACY - train: 0.9371, test: 0.9383
norm of g = 0.4512
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.2181, test: 0.2145
ACCURACY - train: 0.9369, test: 0.9391
norm of g = 0.3978
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.2042, test: 0.2092
ACCURACY - train: 0.9417, test: 0.9403
norm of g = 0.4272
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.2080, test: 0.2013
ACCURACY - train: 0.9379, test: 0.9392
norm of g = 0.6628
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.2280, test: 0.1979
ACCURACY - train: 0.9390, test: 0.9421
norm of g = 0.4044
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.2216, test: 0.1911
ACCURACY - train: 0.9381, test: 0.9458
norm of g = 0.6970
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1944, test: 0.1790
ACCURACY - train: 0.9419, test: 0.9482
norm of g = 0.6492
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1944, test: 0.1790
ACCURACY - train: 0.9419, test: 0.9482
norm of g = 0.6492
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.2001, test: 0.1752
ACCURACY - train: 0.9423, test: 0.9494
norm of g = 0.6033
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.2001, test: 0.1752
ACCURACY - train: 0.9423, test: 0.9494
norm of g = 0.6033
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1954, test: 0.1733
ACCURACY - train: 0.9427, test: 0.9491
norm of g = 0.4250
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1882, test: 0.1717
ACCURACY - train: 0.9492, test: 0.9498
norm of g = 0.2727
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.1877, test: 0.1708
ACCURACY - train: 0.9460, test: 0.9490
norm of g = 0.4541
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.1869, test: 0.1716
ACCURACY - train: 0.9450, test: 0.9484
norm of g = 0.9972
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.1771, test: 0.1647
ACCURACY - train: 0.9483, test: 0.9518
norm of g = 0.5019
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1871, test: 0.1650
ACCURACY - train: 0.9444, test: 0.9520
norm of g = 0.4101
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1824, test: 0.1625
ACCURACY - train: 0.9469, test: 0.9527
norm of g = 0.2743
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.1678, test: 0.1624
ACCURACY - train: 0.9517, test: 0.9523
norm of g = 0.3466
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.1809, test: 0.1619
ACCURACY - train: 0.9477, test: 0.9530
norm of g = 0.3025
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.1889, test: 0.1602
ACCURACY - train: 0.9435, test: 0.9537
norm of g = 0.5194
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.1889, test: 0.1602
ACCURACY - train: 0.9435, test: 0.9537
norm of g = 0.5194
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.1727, test: 0.1588
ACCURACY - train: 0.9479, test: 0.9547
norm of g = 0.3502
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.1748, test: 0.1577
ACCURACY - train: 0.9465, test: 0.9555
norm of g = 0.4526
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1753, test: 0.1558
ACCURACY - train: 0.9488, test: 0.9553
norm of g = 0.4867
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.1603, test: 0.1553
ACCURACY - train: 0.9529, test: 0.9556
norm of g = 0.2400
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.1685, test: 0.1566
ACCURACY - train: 0.9510, test: 0.9560
norm of g = 0.4262
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.1699, test: 0.1560
ACCURACY - train: 0.9506, test: 0.9550
norm of g = 0.2480
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1573, test: 0.1549
ACCURACY - train: 0.9538, test: 0.9550
norm of g = 0.2834
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1567, test: 0.1546
ACCURACY - train: 0.9550, test: 0.9552
norm of g = 0.4247
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1590, test: 0.1626
ACCURACY - train: 0.9544, test: 0.9544
norm of g = 0.8176
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1393, test: 0.1491
ACCURACY - train: 0.9613, test: 0.9572
norm of g = 0.4164
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1412, test: 0.1432
ACCURACY - train: 0.9598, test: 0.9588
norm of g = 0.4138
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.1682, test: 0.1420
ACCURACY - train: 0.9540, test: 0.9587
norm of g = 0.6085
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.1698, test: 0.1425
ACCURACY - train: 0.9498, test: 0.9574
norm of g = 0.7680
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1508, test: 0.1349
ACCURACY - train: 0.9560, test: 0.9608
norm of g = 0.3647
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.1569, test: 0.1308
ACCURACY - train: 0.9533, test: 0.9624
norm of g = 0.6753
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.1506, test: 0.1398
ACCURACY - train: 0.9540, test: 0.9573
norm of g = 0.6862
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1397, test: 0.1295
ACCURACY - train: 0.9627, test: 0.9606
norm of g = 0.7363
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1397, test: 0.1295
ACCURACY - train: 0.9627, test: 0.9606
norm of g = 0.7363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1384, test: 0.1211
ACCURACY - train: 0.9596, test: 0.9636
norm of g = 0.3127
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1331, test: 0.1185
ACCURACY - train: 0.9619, test: 0.9651
norm of g = 0.3331
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.1241, test: 0.1194
ACCURACY - train: 0.9650, test: 0.9642
norm of g = 0.4614
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1366, test: 0.1169
ACCURACY - train: 0.9621, test: 0.9661
norm of g = 0.7076
shrinking trust region radius
gamma = 0.0302
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1366, test: 0.1169
ACCURACY - train: 0.9621, test: 0.9661
norm of g = 0.7076
gamma = 0.0465
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1346, test: 0.1138
ACCURACY - train: 0.9623, test: 0.9661
norm of g = 0.4695
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.1179, test: 0.1147
ACCURACY - train: 0.9673, test: 0.9654
norm of g = 0.3071
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1282, test: 0.1139
ACCURACY - train: 0.9635, test: 0.9670
norm of g = 0.3334
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1340, test: 0.1119
ACCURACY - train: 0.9600, test: 0.9683
norm of g = 0.3837
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1198, test: 0.1107
ACCURACY - train: 0.9640, test: 0.9690
norm of g = 0.3927
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1252, test: 0.1115
ACCURACY - train: 0.9617, test: 0.9682
norm of g = 0.5058
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1267, test: 0.1094
ACCURACY - train: 0.9627, test: 0.9680
norm of g = 0.4156
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1144, test: 0.1107
ACCURACY - train: 0.9688, test: 0.9666
norm of g = 0.2462
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1180, test: 0.1104
ACCURACY - train: 0.9685, test: 0.9666
norm of g = 0.2804
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1196, test: 0.1106
ACCURACY - train: 0.9660, test: 0.9672
norm of g = 0.1895
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.1094, test: 0.1101
ACCURACY - train: 0.9681, test: 0.9669
norm of g = 0.2149
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.1083, test: 0.1108
ACCURACY - train: 0.9677, test: 0.9679
norm of g = 0.3503
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1086, test: 0.1119
ACCURACY - train: 0.9694, test: 0.9678
norm of g = 0.5005
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1003, test: 0.1073
ACCURACY - train: 0.9723, test: 0.9671
norm of g = 0.6436
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1054, test: 0.1092
ACCURACY - train: 0.9698, test: 0.9681
norm of g = 0.7592
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1224, test: 0.1028
ACCURACY - train: 0.9660, test: 0.9701
norm of g = 0.2258
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1200, test: 0.1008
ACCURACY - train: 0.9637, test: 0.9698
norm of g = 0.4025
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1135, test: 0.1010
ACCURACY - train: 0.9669, test: 0.9704
norm of g = 0.3280
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.1178, test: 0.0966
ACCURACY - train: 0.9652, test: 0.9729
norm of g = 0.4602
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.1111, test: 0.0999
ACCURACY - train: 0.9681, test: 0.9693
norm of g = 0.4218
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1081, test: 0.0999
ACCURACY - train: 0.9698, test: 0.9701
norm of g = 0.5724
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.1122, test: 0.0995
ACCURACY - train: 0.9671, test: 0.9699
norm of g = 0.8392
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.1033, test: 0.0969
ACCURACY - train: 0.9688, test: 0.9696
norm of g = 0.4684
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0949, test: 0.0946
ACCURACY - train: 0.9729, test: 0.9725
norm of g = 0.3197
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.1081, test: 0.0916
ACCURACY - train: 0.9706, test: 0.9723
norm of g = 0.4154
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.1066, test: 0.0894
ACCURACY - train: 0.9690, test: 0.9720
norm of g = 0.3853
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0922, test: 0.0915
ACCURACY - train: 0.9737, test: 0.9727
norm of g = 0.5266
shrinking trust region radius
gamma = 0.1046
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0922, test: 0.0915
ACCURACY - train: 0.9737, test: 0.9727
norm of g = 0.5266
gamma = 0.1155
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.1022, test: 0.0886
ACCURACY - train: 0.9708, test: 0.9729
norm of g = 0.3033
gamma = 0.0992
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.1058, test: 0.0869
ACCURACY - train: 0.9671, test: 0.9742
norm of g = 0.3613
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.0918, test: 0.0862
ACCURACY - train: 0.9723, test: 0.9741
norm of g = 0.3068
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.0982, test: 0.0871
ACCURACY - train: 0.9696, test: 0.9745
norm of g = 0.4406
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.1004, test: 0.0856
ACCURACY - train: 0.9702, test: 0.9736
norm of g = 0.3899
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0897, test: 0.0853
ACCURACY - train: 0.9754, test: 0.9738
norm of g = 0.2091
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0923, test: 0.0864
ACCURACY - train: 0.9735, test: 0.9731
norm of g = 0.2768
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0937, test: 0.0869
ACCURACY - train: 0.9725, test: 0.9734
norm of g = 0.2010
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0843, test: 0.0863
ACCURACY - train: 0.9756, test: 0.9733
norm of g = 0.2210
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0816, test: 0.0863
ACCURACY - train: 0.9760, test: 0.9736
norm of g = 0.2579
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0824, test: 0.0869
ACCURACY - train: 0.9756, test: 0.9736
norm of g = 0.3363
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0824, test: 0.0869
ACCURACY - train: 0.9756, test: 0.9736
norm of g = 0.3363
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0764, test: 0.0840
ACCURACY - train: 0.9773, test: 0.9742
norm of g = 0.2439
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.0805, test: 0.0828
ACCURACY - train: 0.9777, test: 0.9752
norm of g = 0.2466
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.0984, test: 0.0822
ACCURACY - train: 0.9704, test: 0.9744
norm of g = 0.1758
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.0962, test: 0.0824
ACCURACY - train: 0.9710, test: 0.9744
norm of g = 0.2717
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0987, test: 0.0862
ACCURACY - train: 0.9721, test: 0.9726
norm of g = 0.6323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.1062, test: 0.0867
ACCURACY - train: 0.9673, test: 0.9732
norm of g = 0.9776
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.1062, test: 0.0867
ACCURACY - train: 0.9673, test: 0.9732
norm of g = 0.9776
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0938, test: 0.0815
ACCURACY - train: 0.9725, test: 0.9753
norm of g = 0.3190
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0916, test: 0.0817
ACCURACY - train: 0.9744, test: 0.9751
norm of g = 0.2320
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0922, test: 0.0809
ACCURACY - train: 0.9723, test: 0.9748
norm of g = 0.2827
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0845, test: 0.0812
ACCURACY - train: 0.9744, test: 0.9752
norm of g = 0.2863
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0823, test: 0.0861
ACCURACY - train: 0.9765, test: 0.9726
norm of g = 0.5853
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0959, test: 0.0820
ACCURACY - train: 0.9742, test: 0.9759
norm of g = 0.6375
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0959, test: 0.0820
ACCURACY - train: 0.9742, test: 0.9759
norm of g = 0.6375
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.0954, test: 0.0785
ACCURACY - train: 0.9727, test: 0.9754
norm of g = 0.2739
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0816, test: 0.0796
ACCURACY - train: 0.9773, test: 0.9746
norm of g = 0.4310
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0888, test: 0.0804
ACCURACY - train: 0.9733, test: 0.9740
norm of g = 0.3956
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1006, test: 0.0841
ACCURACY - train: 0.9677, test: 0.9728
norm of g = 0.8298
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0840, test: 0.0823
ACCURACY - train: 0.9738, test: 0.9759
norm of g = 0.5847
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0840, test: 0.0823
ACCURACY - train: 0.9738, test: 0.9759
norm of g = 0.5847
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0863, test: 0.0771
ACCURACY - train: 0.9738, test: 0.9767
norm of g = 0.2661
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0908, test: 0.0764
ACCURACY - train: 0.9715, test: 0.9769
norm of g = 0.5537
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0800, test: 0.0775
ACCURACY - train: 0.9783, test: 0.9751
norm of g = 0.4597
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0784, test: 0.0773
ACCURACY - train: 0.9767, test: 0.9753
norm of g = 0.3010
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0805, test: 0.0770
ACCURACY - train: 0.9767, test: 0.9758
norm of g = 0.2969
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0730, test: 0.0758
ACCURACY - train: 0.9792, test: 0.9766
norm of g = 0.3105
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0710, test: 0.0772
ACCURACY - train: 0.9790, test: 0.9766
norm of g = 0.3113
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0721, test: 0.0746
ACCURACY - train: 0.9796, test: 0.9768
norm of g = 0.2629
gamma = 0.0278
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.0649, test: 0.0739
ACCURACY - train: 0.9798, test: 0.9766
norm of g = 0.2175
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.0649, test: 0.0739
ACCURACY - train: 0.9798, test: 0.9766
norm of g = 0.2175
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0711, test: 0.0724
ACCURACY - train: 0.9790, test: 0.9772
norm of g = 0.2545
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0853, test: 0.0720
ACCURACY - train: 0.9731, test: 0.9781
norm of g = 0.2345
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0836, test: 0.0720
ACCURACY - train: 0.9744, test: 0.9776
norm of g = 0.3010
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0823, test: 0.0721
ACCURACY - train: 0.9775, test: 0.9777
norm of g = 0.2154
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0885, test: 0.0714
ACCURACY - train: 0.9738, test: 0.9776
norm of g = 0.4280
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0885, test: 0.0714
ACCURACY - train: 0.9738, test: 0.9776
norm of g = 0.4280
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0833, test: 0.0724
ACCURACY - train: 0.9765, test: 0.9770
norm of g = 0.2681
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0823, test: 0.0729
ACCURACY - train: 0.9763, test: 0.9775
norm of g = 0.3638
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0805, test: 0.0712
ACCURACY - train: 0.9742, test: 0.9772
norm of g = 0.2893
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0735, test: 0.0709
ACCURACY - train: 0.9756, test: 0.9765
norm of g = 0.2977
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0688, test: 0.0729
ACCURACY - train: 0.9792, test: 0.9775
norm of g = 0.4087
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0824, test: 0.0722
ACCURACY - train: 0.9765, test: 0.9773
norm of g = 0.3903
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0830, test: 0.0699
ACCURACY - train: 0.9756, test: 0.9782
norm of g = 0.2689
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0717, test: 0.0720
ACCURACY - train: 0.9798, test: 0.9779
norm of g = 0.5003
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0784, test: 0.0713
ACCURACY - train: 0.9773, test: 0.9775
norm of g = 0.3640
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0784, test: 0.0713
ACCURACY - train: 0.9773, test: 0.9775
norm of g = 0.3640
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0833, test: 0.0697
ACCURACY - train: 0.9748, test: 0.9788
norm of g = 0.3536
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0717, test: 0.0694
ACCURACY - train: 0.9798, test: 0.9788
norm of g = 0.2993
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0785, test: 0.0704
ACCURACY - train: 0.9756, test: 0.9785
norm of g = 0.3848
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0819, test: 0.0692
ACCURACY - train: 0.9760, test: 0.9789
norm of g = 0.3942
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0710, test: 0.0688
ACCURACY - train: 0.9792, test: 0.9786
norm of g = 0.2548
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0712, test: 0.0695
ACCURACY - train: 0.9798, test: 0.9776
norm of g = 0.2278
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0732, test: 0.0698
ACCURACY - train: 0.9792, test: 0.9776
norm of g = 0.1571
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0660, test: 0.0699
ACCURACY - train: 0.9804, test: 0.9777
norm of g = 0.2465
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0635, test: 0.0702
ACCURACY - train: 0.9813, test: 0.9785
norm of g = 0.2951
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0653, test: 0.0704
ACCURACY - train: 0.9806, test: 0.9780
norm of g = 0.2883
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0601, test: 0.0680
ACCURACY - train: 0.9813, test: 0.9781
norm of g = 0.2250
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0647, test: 0.0673
ACCURACY - train: 0.9819, test: 0.9790
norm of g = 0.2746
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0777, test: 0.0670
ACCURACY - train: 0.9754, test: 0.9794
norm of g = 0.1880
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0751, test: 0.0696
ACCURACY - train: 0.9771, test: 0.9786
norm of g = 0.3196
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0796, test: 0.0704
ACCURACY - train: 0.9767, test: 0.9780
norm of g = 0.4419
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0862, test: 0.0700
ACCURACY - train: 0.9727, test: 0.9781
norm of g = 0.7408
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0862, test: 0.0700
ACCURACY - train: 0.9727, test: 0.9781
norm of g = 0.7408
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0791, test: 0.0662
ACCURACY - train: 0.9760, test: 0.9782
norm of g = 0.2940
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0769, test: 0.0671
ACCURACY - train: 0.9785, test: 0.9786
norm of g = 0.3157
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0742, test: 0.0662
ACCURACY - train: 0.9769, test: 0.9784
norm of g = 0.3038
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0665, test: 0.0657
ACCURACY - train: 0.9775, test: 0.9791
norm of g = 0.2468
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0629, test: 0.0661
ACCURACY - train: 0.9806, test: 0.9789
norm of g = 0.3749
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0755, test: 0.0655
ACCURACY - train: 0.9779, test: 0.9799
norm of g = 0.2605
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0769, test: 0.0649
ACCURACY - train: 0.9790, test: 0.9802
norm of g = 0.2077
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0657, test: 0.0673
ACCURACY - train: 0.9815, test: 0.9789
norm of g = 0.4001
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0766, test: 0.0695
ACCURACY - train: 0.9763, test: 0.9776
norm of g = 0.6517
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0781, test: 0.0668
ACCURACY - train: 0.9748, test: 0.9789
norm of g = 0.4411
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0781, test: 0.0668
ACCURACY - train: 0.9748, test: 0.9789
norm of g = 0.4411
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0680, test: 0.0648
ACCURACY - train: 0.9802, test: 0.9804
norm of g = 0.3478
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0723, test: 0.0649
ACCURACY - train: 0.9804, test: 0.9801
norm of g = 0.2249
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0762, test: 0.0638
ACCURACY - train: 0.9783, test: 0.9802
norm of g = 0.2793
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0661, test: 0.0635
ACCURACY - train: 0.9813, test: 0.9799
norm of g = 0.1991
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0659, test: 0.0644
ACCURACY - train: 0.9808, test: 0.9797
norm of g = 0.2010
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0677, test: 0.0650
ACCURACY - train: 0.9794, test: 0.9792
norm of g = 0.2014
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0608, test: 0.0671
ACCURACY - train: 0.9815, test: 0.9793
norm of g = 0.3248
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0584, test: 0.0650
ACCURACY - train: 0.9831, test: 0.9805
norm of g = 0.2420
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0606, test: 0.0649
ACCURACY - train: 0.9819, test: 0.9799
norm of g = 0.3114
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0548, test: 0.0641
ACCURACY - train: 0.9823, test: 0.9799
norm of g = 0.2451
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0583, test: 0.0626
ACCURACY - train: 0.9838, test: 0.9798
norm of g = 0.2760
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0687, test: 0.0625
ACCURACY - train: 0.9781, test: 0.9803
norm of g = 0.2013
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0670, test: 0.0627
ACCURACY - train: 0.9796, test: 0.9796
norm of g = 0.2454
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0703, test: 0.0647
ACCURACY - train: 0.9800, test: 0.9795
norm of g = 0.4108
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0703, test: 0.0647
ACCURACY - train: 0.9800, test: 0.9795
norm of g = 0.4108
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0781, test: 0.0626
ACCURACY - train: 0.9765, test: 0.9803
norm of g = 0.3392
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0740, test: 0.0637
ACCURACY - train: 0.9769, test: 0.9804
norm of g = 0.3092
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0725, test: 0.0639
ACCURACY - train: 0.9794, test: 0.9796
norm of g = 0.3792
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0698, test: 0.0625
ACCURACY - train: 0.9781, test: 0.9802
norm of g = 0.3377
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0622, test: 0.0620
ACCURACY - train: 0.9794, test: 0.9803
norm of g = 0.2503
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0585, test: 0.0624
ACCURACY - train: 0.9823, test: 0.9803
norm of g = 0.2755
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0715, test: 0.0622
ACCURACY - train: 0.9792, test: 0.9809
norm of g = 0.2878
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0722, test: 0.0614
ACCURACY - train: 0.9794, test: 0.9810
norm of g = 0.1917
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0614, test: 0.0623
ACCURACY - train: 0.9823, test: 0.9804
norm of g = 0.3486
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0688, test: 0.0633
ACCURACY - train: 0.9790, test: 0.9807
norm of g = 0.3520
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0727, test: 0.0609
ACCURACY - train: 0.9779, test: 0.9817
norm of g = 0.3087
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0621, test: 0.0621
ACCURACY - train: 0.9817, test: 0.9808
norm of g = 0.2336
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0689, test: 0.0659
ACCURACY - train: 0.9783, test: 0.9803
norm of g = 0.5301
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0721, test: 0.0646
ACCURACY - train: 0.9788, test: 0.9792
norm of g = 0.4616
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0721, test: 0.0646
ACCURACY - train: 0.9788, test: 0.9792
norm of g = 0.4616
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0626, test: 0.0621
ACCURACY - train: 0.9813, test: 0.9806
norm of g = 0.2658
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0618, test: 0.0625
ACCURACY - train: 0.9808, test: 0.9802
norm of g = 0.1999
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0631, test: 0.0627
ACCURACY - train: 0.9810, test: 0.9800
norm of g = 0.1891
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0561, test: 0.0630
ACCURACY - train: 0.9825, test: 0.9802
norm of g = 0.2995
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0534, test: 0.0623
ACCURACY - train: 0.9850, test: 0.9811
norm of g = 0.2528
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0549, test: 0.0626
ACCURACY - train: 0.9852, test: 0.9797
norm of g = 0.3099
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0508, test: 0.0608
ACCURACY - train: 0.9840, test: 0.9800
norm of g = 0.2280
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0557, test: 0.0608
ACCURACY - train: 0.9840, test: 0.9807
norm of g = 0.4304
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0686, test: 0.0640
ACCURACY - train: 0.9769, test: 0.9798
norm of g = 0.6826
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0630, test: 0.0633
ACCURACY - train: 0.9808, test: 0.9805
norm of g = 0.3977
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0630, test: 0.0633
ACCURACY - train: 0.9808, test: 0.9805
norm of g = 0.3977
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0661, test: 0.0603
ACCURACY - train: 0.9798, test: 0.9810
norm of g = 0.2076
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0737, test: 0.0596
ACCURACY - train: 0.9773, test: 0.9811
norm of g = 0.3283
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0691, test: 0.0601
ACCURACY - train: 0.9788, test: 0.9811
norm of g = 0.2859
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0663, test: 0.0588
ACCURACY - train: 0.9798, test: 0.9804
norm of g = 0.3048
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0636, test: 0.0577
ACCURACY - train: 0.9798, test: 0.9819
norm of g = 0.3586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0578, test: 0.0596
ACCURACY - train: 0.9823, test: 0.9805
norm of g = 0.2754
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0547, test: 0.0604
ACCURACY - train: 0.9842, test: 0.9815
norm of g = 0.2991
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0663, test: 0.0573
ACCURACY - train: 0.9806, test: 0.9824
norm of g = 0.2749
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0678, test: 0.0579
ACCURACY - train: 0.9800, test: 0.9814
norm of g = 0.2921
gamma = 0.0212
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0568, test: 0.0585
ACCURACY - train: 0.9840, test: 0.9825
norm of g = 0.3381
shrinking trust region radius
gamma = 0.1747
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0568, test: 0.0585
ACCURACY - train: 0.9840, test: 0.9825
norm of g = 0.3381
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0650, test: 0.0580
ACCURACY - train: 0.9785, test: 0.9820
norm of g = 0.2720
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0672, test: 0.0571
ACCURACY - train: 0.9794, test: 0.9824
norm of g = 0.3324
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0557, test: 0.0562
ACCURACY - train: 0.9840, test: 0.9827
norm of g = 0.2315
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0609, test: 0.0572
ACCURACY - train: 0.9813, test: 0.9821
norm of g = 0.2101
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0660, test: 0.0564
ACCURACY - train: 0.9804, test: 0.9820
norm of g = 0.3212
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0585, test: 0.0575
ACCURACY - train: 0.9838, test: 0.9802
norm of g = 0.3654
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0575, test: 0.0590
ACCURACY - train: 0.9823, test: 0.9805
norm of g = 0.3424
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0570, test: 0.0575
ACCURACY - train: 0.9817, test: 0.9809
norm of g = 0.2008
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0522, test: 0.0589
ACCURACY - train: 0.9833, test: 0.9810
norm of g = 0.3606
reached to the max num iteration -- BREAK
20 - 50 - preconditioning -- 1
2018-06-28 08:07:11.024465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:07:11.295937: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x45999d0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:07:11.296786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:07:11.559264: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x459de80 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:07:11.560128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:07:11.826833: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x45c23e0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:07:11.827700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:07:11.827997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 08:07:11.828020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 08:07:11.828050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 08:07:11.828063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 08:07:11.828076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 08:07:11.828088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 08:07:11.828313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 08:07:11.828332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 08:07:11.828422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 08:07:11.828433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 08:07:11.828439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 08:07:11.828445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 08:07:11.828457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 08:07:11.828472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 08:07:11.828480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 08:07:11.828486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 08:07:11.828492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3614, test: 2.3584
ACCURACY - train: 0.0858, test: 0.0896
norm of g = 0.7349
Backtracking line search satisfied for alpha = 0.7290
initial gamma = 4.0476
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3223, test: 2.3267
ACCURACY - train: 0.1046, test: 0.0984
norm of g = 0.8683
gamma = 1.1269
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2576, test: 2.2609
ACCURACY - train: 0.2708, test: 0.2591
norm of g = 0.4042
gamma = 0.0824
weights are updated
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.1601, test: 2.1623
ACCURACY - train: 0.1729, test: 0.1765
norm of g = 0.7811
shrinking trust region radius
no need for safe gaurding
gamma = 1.4073
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.1601, test: 2.1623
ACCURACY - train: 0.1729, test: 0.1765
norm of g = 0.7811
no need for safe gaurding
gamma = 331.4394
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.8519, test: 1.8464
ACCURACY - train: 0.5929, test: 0.6074
norm of g = 1.1448
no need for safe gaurding
gamma = 2.2828
weights are updated
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.5826, test: 1.5638
ACCURACY - train: 0.5283, test: 0.5394
norm of g = 1.7653
no need for safe gaurding
gamma = 1.0920
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.2690, test: 1.2310
ACCURACY - train: 0.6213, test: 0.6416
norm of g = 1.9605
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.2690, test: 1.2310
ACCURACY - train: 0.6212, test: 0.6416
norm of g = 1.9605
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.1379, test: 1.0974
ACCURACY - train: 0.7138, test: 0.7389
norm of g = 1.3493
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.0150, test: 0.9852
ACCURACY - train: 0.7629, test: 0.7757
norm of g = 1.3086
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 0.9168, test: 0.8836
ACCURACY - train: 0.7771, test: 0.7808
norm of g = 1.1188
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.8609, test: 0.8135
ACCURACY - train: 0.7608, test: 0.7763
norm of g = 1.3592
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.7669, test: 0.7338
ACCURACY - train: 0.7850, test: 0.8020
norm of g = 1.2832
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.6869, test: 0.6727
ACCURACY - train: 0.8062, test: 0.8108
norm of g = 1.4181
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.6312, test: 0.6311
ACCURACY - train: 0.8038, test: 0.8115
norm of g = 1.8854
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6312, test: 0.6311
ACCURACY - train: 0.8038, test: 0.8115
norm of g = 1.8854
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.6117, test: 0.5848
ACCURACY - train: 0.8258, test: 0.8362
norm of g = 0.9663
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.6031, test: 0.5678
ACCURACY - train: 0.8304, test: 0.8418
norm of g = 0.7165
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5860, test: 0.5459
ACCURACY - train: 0.8321, test: 0.8433
norm of g = 0.8330
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5788, test: 0.5234
ACCURACY - train: 0.8308, test: 0.8482
norm of g = 1.0722
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5491, test: 0.5062
ACCURACY - train: 0.8425, test: 0.8545
norm of g = 1.2400
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5036, test: 0.4759
ACCURACY - train: 0.8550, test: 0.8622
norm of g = 0.5762
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.5036, test: 0.4759
ACCURACY - train: 0.8550, test: 0.8622
norm of g = 0.5762
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.4737, test: 0.4655
ACCURACY - train: 0.8600, test: 0.8643
norm of g = 0.6557
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.4407, test: 0.4538
ACCURACY - train: 0.8746, test: 0.8676
norm of g = 0.5536
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.4482, test: 0.4377
ACCURACY - train: 0.8700, test: 0.8726
norm of g = 0.7021
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4450, test: 0.4235
ACCURACY - train: 0.8642, test: 0.8723
norm of g = 0.7729
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4045, test: 0.3990
ACCURACY - train: 0.8771, test: 0.8792
norm of g = 0.4381
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4002, test: 0.3854
ACCURACY - train: 0.8762, test: 0.8841
norm of g = 0.5711
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.4076, test: 0.3847
ACCURACY - train: 0.8846, test: 0.8857
norm of g = 0.9907
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.4029, test: 0.3656
ACCURACY - train: 0.8825, test: 0.8922
norm of g = 0.7962
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.4029, test: 0.3656
ACCURACY - train: 0.8825, test: 0.8922
norm of g = 0.7962
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3997, test: 0.3567
ACCURACY - train: 0.8879, test: 0.8936
norm of g = 0.5509
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3738, test: 0.3501
ACCURACY - train: 0.8950, test: 0.8945
norm of g = 0.3247
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3423, test: 0.3415
ACCURACY - train: 0.8987, test: 0.8978
norm of g = 0.3862
gamma = 0.0409
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3297, test: 0.3317
ACCURACY - train: 0.9025, test: 0.8983
norm of g = 0.5216
gamma = 0.0559
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3436, test: 0.3285
ACCURACY - train: 0.8929, test: 0.8992
norm of g = 0.7772
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3436, test: 0.3285
ACCURACY - train: 0.8929, test: 0.8992
norm of g = 0.7772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3625, test: 0.3199
ACCURACY - train: 0.8821, test: 0.9020
norm of g = 0.5621
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.3591, test: 0.3153
ACCURACY - train: 0.8900, test: 0.9033
norm of g = 0.5029
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.3504, test: 0.3129
ACCURACY - train: 0.8979, test: 0.9059
norm of g = 0.4248
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.3610, test: 0.3106
ACCURACY - train: 0.8850, test: 0.9057
norm of g = 0.5178
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.3283, test: 0.3051
ACCURACY - train: 0.8967, test: 0.9085
norm of g = 0.5763
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.3115, test: 0.2924
ACCURACY - train: 0.9046, test: 0.9148
norm of g = 0.8195
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.3048, test: 0.2871
ACCURACY - train: 0.9112, test: 0.9111
norm of g = 0.5085
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.3036, test: 0.2787
ACCURACY - train: 0.9129, test: 0.9181
norm of g = 0.5667
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.2901, test: 0.2639
ACCURACY - train: 0.9146, test: 0.9190
norm of g = 0.6602
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.2901, test: 0.2639
ACCURACY - train: 0.9146, test: 0.9190
norm of g = 0.6602
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.2646, test: 0.2517
ACCURACY - train: 0.9167, test: 0.9247
norm of g = 0.4003
expanding trust region radius
gamma = 0.1027
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.2681, test: 0.2464
ACCURACY - train: 0.9133, test: 0.9241
norm of g = 0.3348
gamma = 0.0928
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.2490, test: 0.2517
ACCURACY - train: 0.9258, test: 0.9212
norm of g = 1.1119
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2535, test: 0.2594
ACCURACY - train: 0.9271, test: 0.9231
norm of g = 1.2122
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.2520, test: 0.2242
ACCURACY - train: 0.9262, test: 0.9333
norm of g = 0.6313
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.2520, test: 0.2242
ACCURACY - train: 0.9262, test: 0.9333
norm of g = 0.6313
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.2449, test: 0.2199
ACCURACY - train: 0.9279, test: 0.9345
norm of g = 0.4248
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.2247, test: 0.2115
ACCURACY - train: 0.9287, test: 0.9356
norm of g = 0.3427
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.2122, test: 0.2061
ACCURACY - train: 0.9317, test: 0.9392
norm of g = 0.5819
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.2082, test: 0.2092
ACCURACY - train: 0.9404, test: 0.9369
norm of g = 0.4474
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.2276, test: 0.2031
ACCURACY - train: 0.9358, test: 0.9372
norm of g = 0.4611
expanding trust region radius
gamma = 0.0319
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.2030, test: 0.1941
ACCURACY - train: 0.9392, test: 0.9414
norm of g = 0.5029
shrinking trust region radius
gamma = 0.0379
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.2030, test: 0.1941
ACCURACY - train: 0.9392, test: 0.9414
norm of g = 0.5029
gamma = 0.0352
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.1802, test: 0.1945
ACCURACY - train: 0.9454, test: 0.9424
norm of g = 0.7703
shrinking trust region radius
gamma = 0.0581
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.1802, test: 0.1945
ACCURACY - train: 0.9454, test: 0.9424
norm of g = 0.7703
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.1871, test: 0.1876
ACCURACY - train: 0.9425, test: 0.9445
norm of g = 0.5308
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.1944, test: 0.1849
ACCURACY - train: 0.9363, test: 0.9460
norm of g = 0.2999
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.1814, test: 0.1805
ACCURACY - train: 0.9438, test: 0.9477
norm of g = 0.3778
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.1694, test: 0.1758
ACCURACY - train: 0.9533, test: 0.9465
norm of g = 0.3175
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.1973, test: 0.1837
ACCURACY - train: 0.9446, test: 0.9450
norm of g = 1.1469
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.2335, test: 0.1820
ACCURACY - train: 0.9350, test: 0.9458
norm of g = 0.9256
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.2200, test: 0.1669
ACCURACY - train: 0.9362, test: 0.9527
norm of g = 0.5152
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.1959, test: 0.1644
ACCURACY - train: 0.9412, test: 0.9510
norm of g = 0.7938
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.1634, test: 0.1563
ACCURACY - train: 0.9508, test: 0.9537
norm of g = 0.8783
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.1681, test: 0.1547
ACCURACY - train: 0.9500, test: 0.9567
norm of g = 0.6780
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.1698, test: 0.1432
ACCURACY - train: 0.9467, test: 0.9566
norm of g = 0.4210
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.1635, test: 0.1403
ACCURACY - train: 0.9504, test: 0.9605
norm of g = 0.5102
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.1500, test: 0.1395
ACCURACY - train: 0.9550, test: 0.9589
norm of g = 0.3697
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.1463, test: 0.1354
ACCURACY - train: 0.9583, test: 0.9606
norm of g = 0.5742
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.1429, test: 0.1318
ACCURACY - train: 0.9571, test: 0.9597
norm of g = 0.4289
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.1429, test: 0.1318
ACCURACY - train: 0.9571, test: 0.9597
norm of g = 0.4289
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.1357, test: 0.1263
ACCURACY - train: 0.9592, test: 0.9628
norm of g = 0.3102
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.1352, test: 0.1280
ACCURACY - train: 0.9600, test: 0.9611
norm of g = 0.5030
gamma = 0.1015
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.1410, test: 0.1238
ACCURACY - train: 0.9587, test: 0.9646
norm of g = 0.5941
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.1410, test: 0.1238
ACCURACY - train: 0.9587, test: 0.9646
norm of g = 0.5941
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.1461, test: 0.1217
ACCURACY - train: 0.9558, test: 0.9655
norm of g = 0.4404
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.1445, test: 0.1219
ACCURACY - train: 0.9562, test: 0.9650
norm of g = 0.3777
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.1282, test: 0.1218
ACCURACY - train: 0.9625, test: 0.9648
norm of g = 0.3304
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.1294, test: 0.1233
ACCURACY - train: 0.9600, test: 0.9654
norm of g = 0.5069
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.1359, test: 0.1167
ACCURACY - train: 0.9637, test: 0.9674
norm of g = 0.4359
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1478, test: 0.1172
ACCURACY - train: 0.9596, test: 0.9679
norm of g = 0.3223
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1554, test: 0.1155
ACCURACY - train: 0.9563, test: 0.9676
norm of g = 0.4039
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.1362, test: 0.1157
ACCURACY - train: 0.9633, test: 0.9680
norm of g = 0.3765
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.1169, test: 0.1148
ACCURACY - train: 0.9650, test: 0.9688
norm of g = 0.3540
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1132, test: 0.1157
ACCURACY - train: 0.9658, test: 0.9672
norm of g = 0.4400
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1230, test: 0.1153
ACCURACY - train: 0.9625, test: 0.9666
norm of g = 0.4055
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.1430, test: 0.1100
ACCURACY - train: 0.9542, test: 0.9677
norm of g = 0.4595
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.1361, test: 0.1110
ACCURACY - train: 0.9633, test: 0.9677
norm of g = 0.5234
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.1131, test: 0.1091
ACCURACY - train: 0.9671, test: 0.9716
norm of g = 0.4171
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1295, test: 0.1102
ACCURACY - train: 0.9613, test: 0.9704
norm of g = 0.6064
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1178, test: 0.1090
ACCURACY - train: 0.9621, test: 0.9694
norm of g = 0.4599
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.1030, test: 0.1042
ACCURACY - train: 0.9721, test: 0.9706
norm of g = 0.5931
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.1028, test: 0.1060
ACCURACY - train: 0.9733, test: 0.9701
norm of g = 0.4224
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.1226, test: 0.1054
ACCURACY - train: 0.9638, test: 0.9683
norm of g = 0.4148
gamma = 0.1648
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.1197, test: 0.1035
ACCURACY - train: 0.9638, test: 0.9690
norm of g = 0.2775
gamma = 0.1592
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.1033, test: 0.1010
ACCURACY - train: 0.9704, test: 0.9709
norm of g = 0.3794
gamma = 0.1343
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.1126, test: 0.1052
ACCURACY - train: 0.9629, test: 0.9703
norm of g = 0.4536
gamma = 0.0968
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1006, test: 0.1004
ACCURACY - train: 0.9683, test: 0.9701
norm of g = 0.4703
gamma = 0.1184
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.1031, test: 0.1049
ACCURACY - train: 0.9683, test: 0.9684
norm of g = 0.4598
gamma = 0.1372
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.1081, test: 0.0990
ACCURACY - train: 0.9679, test: 0.9719
norm of g = 0.2785
gamma = 0.1424
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.0994, test: 0.0978
ACCURACY - train: 0.9758, test: 0.9730
norm of g = 0.3295
gamma = 0.1501
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.0981, test: 0.0953
ACCURACY - train: 0.9733, test: 0.9724
norm of g = 0.4232
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.0948, test: 0.0979
ACCURACY - train: 0.9729, test: 0.9723
norm of g = 0.5728
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.0892, test: 0.1004
ACCURACY - train: 0.9704, test: 0.9717
norm of g = 0.3645
gamma = 0.0463
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1031, test: 0.1002
ACCURACY - train: 0.9679, test: 0.9720
norm of g = 0.5193
shrinking trust region radius
gamma = 0.0826
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1051, test: 0.1001
ACCURACY - train: 0.9683, test: 0.9677
norm of g = 0.7204
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.0903, test: 0.0938
ACCURACY - train: 0.9717, test: 0.9718
norm of g = 0.5091
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.0884, test: 0.0919
ACCURACY - train: 0.9738, test: 0.9728
norm of g = 0.3220
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.0924, test: 0.0915
ACCURACY - train: 0.9700, test: 0.9734
norm of g = 0.3249
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.0808, test: 0.0899
ACCURACY - train: 0.9738, test: 0.9747
norm of g = 0.2511
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.0771, test: 0.0879
ACCURACY - train: 0.9767, test: 0.9746
norm of g = 0.2884
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.0964, test: 0.0874
ACCURACY - train: 0.9738, test: 0.9749
norm of g = 0.3432
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1194, test: 0.0923
ACCURACY - train: 0.9671, test: 0.9741
norm of g = 0.3696
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1252, test: 0.0939
ACCURACY - train: 0.9608, test: 0.9728
norm of g = 0.5081
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1046, test: 0.0920
ACCURACY - train: 0.9663, test: 0.9732
norm of g = 0.4206
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.0887, test: 0.0905
ACCURACY - train: 0.9758, test: 0.9730
norm of g = 0.5545
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.1023, test: 0.0863
ACCURACY - train: 0.9721, test: 0.9752
norm of g = 0.3411
gamma = 0.1174
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.1091, test: 0.0852
ACCURACY - train: 0.9679, test: 0.9747
norm of g = 0.4359
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.1076, test: 0.0913
ACCURACY - train: 0.9679, test: 0.9725
norm of g = 0.6651
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.0972, test: 0.0863
ACCURACY - train: 0.9721, test: 0.9758
norm of g = 0.3351
expanding trust region radius
gamma = 0.1220
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.0919, test: 0.0880
ACCURACY - train: 0.9742, test: 0.9749
norm of g = 0.4906
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.0919, test: 0.0880
ACCURACY - train: 0.9742, test: 0.9749
norm of g = 0.4906
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.0975, test: 0.0853
ACCURACY - train: 0.9721, test: 0.9759
norm of g = 0.3052
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.0885, test: 0.0858
ACCURACY - train: 0.9725, test: 0.9740
norm of g = 0.3154
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.0900, test: 0.0865
ACCURACY - train: 0.9704, test: 0.9735
norm of g = 0.3174
gamma = 0.0495
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.0940, test: 0.0882
ACCURACY - train: 0.9725, test: 0.9728
norm of g = 0.5793
shrinking trust region radius
gamma = 0.0122
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.0940, test: 0.0882
ACCURACY - train: 0.9725, test: 0.9728
norm of g = 0.5793
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.1002, test: 0.0888
ACCURACY - train: 0.9683, test: 0.9721
norm of g = 0.4889
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.0946, test: 0.0849
ACCURACY - train: 0.9721, test: 0.9757
norm of g = 0.3290
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.0808, test: 0.0835
ACCURACY - train: 0.9767, test: 0.9761
norm of g = 0.2829
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.0812, test: 0.0837
ACCURACY - train: 0.9754, test: 0.9760
norm of g = 0.4683
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.0930, test: 0.0822
ACCURACY - train: 0.9746, test: 0.9768
norm of g = 0.5092
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1028, test: 0.0803
ACCURACY - train: 0.9712, test: 0.9756
norm of g = 0.3313
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1115, test: 0.0808
ACCURACY - train: 0.9696, test: 0.9758
norm of g = 0.5923
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.0973, test: 0.0821
ACCURACY - train: 0.9738, test: 0.9766
norm of g = 0.6931
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.0819, test: 0.0878
ACCURACY - train: 0.9763, test: 0.9750
norm of g = 0.6482
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.0769, test: 0.0791
ACCURACY - train: 0.9775, test: 0.9767
norm of g = 0.4127
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.0794, test: 0.0777
ACCURACY - train: 0.9771, test: 0.9766
norm of g = 0.2327
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.0932, test: 0.0752
ACCURACY - train: 0.9721, test: 0.9782
norm of g = 0.3037
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.0894, test: 0.0743
ACCURACY - train: 0.9704, test: 0.9784
norm of g = 0.2941
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.0765, test: 0.0752
ACCURACY - train: 0.9750, test: 0.9784
norm of g = 0.2929
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0943, test: 0.0839
ACCURACY - train: 0.9683, test: 0.9764
norm of g = 0.8238
gamma = 0.1514
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.0794, test: 0.0775
ACCURACY - train: 0.9742, test: 0.9781
norm of g = 0.3710
gamma = 0.1418
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.0660, test: 0.0751
ACCURACY - train: 0.9817, test: 0.9778
norm of g = 0.4028
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0660, test: 0.0751
ACCURACY - train: 0.9817, test: 0.9778
norm of g = 0.4028
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0713, test: 0.0758
ACCURACY - train: 0.9817, test: 0.9786
norm of g = 0.2624
gamma = 0.0603
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.0908, test: 0.0748
ACCURACY - train: 0.9733, test: 0.9784
norm of g = 0.3914
gamma = 0.1834
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.0890, test: 0.0726
ACCURACY - train: 0.9713, test: 0.9791
norm of g = 0.2774
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.0765, test: 0.0726
ACCURACY - train: 0.9750, test: 0.9788
norm of g = 0.2967
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.0794, test: 0.0729
ACCURACY - train: 0.9708, test: 0.9782
norm of g = 0.3111
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.0698, test: 0.0728
ACCURACY - train: 0.9758, test: 0.9788
norm of g = 0.3421
gamma = 0.0481
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0736, test: 0.0790
ACCURACY - train: 0.9779, test: 0.9767
norm of g = 0.4741
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0736, test: 0.0790
ACCURACY - train: 0.9779, test: 0.9767
norm of g = 0.4741
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0802, test: 0.0742
ACCURACY - train: 0.9796, test: 0.9780
norm of g = 0.4248
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0740, test: 0.0738
ACCURACY - train: 0.9800, test: 0.9788
norm of g = 0.2369
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0743, test: 0.0722
ACCURACY - train: 0.9771, test: 0.9790
norm of g = 0.2822
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0666, test: 0.0737
ACCURACY - train: 0.9796, test: 0.9780
norm of g = 0.3189
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0635, test: 0.0792
ACCURACY - train: 0.9792, test: 0.9765
norm of g = 0.3647
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0754, test: 0.0799
ACCURACY - train: 0.9754, test: 0.9774
norm of g = 0.4969
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.0773, test: 0.0746
ACCURACY - train: 0.9796, test: 0.9777
norm of g = 0.3981
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.0647, test: 0.0738
ACCURACY - train: 0.9808, test: 0.9775
norm of g = 0.3439
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.0705, test: 0.0791
ACCURACY - train: 0.9779, test: 0.9757
norm of g = 0.5071
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0701, test: 0.0717
ACCURACY - train: 0.9800, test: 0.9784
norm of g = 0.4154
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.0590, test: 0.0707
ACCURACY - train: 0.9808, test: 0.9786
norm of g = 0.3547
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.0547, test: 0.0670
ACCURACY - train: 0.9833, test: 0.9803
norm of g = 0.3022
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0721, test: 0.0688
ACCURACY - train: 0.9808, test: 0.9798
norm of g = 0.4238
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0890, test: 0.0688
ACCURACY - train: 0.9729, test: 0.9801
norm of g = 0.3087
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0894, test: 0.0719
ACCURACY - train: 0.9721, test: 0.9791
norm of g = 0.3305
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0736, test: 0.0708
ACCURACY - train: 0.9808, test: 0.9794
norm of g = 0.2692
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0628, test: 0.0678
ACCURACY - train: 0.9854, test: 0.9801
norm of g = 0.3508
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0812, test: 0.0668
ACCURACY - train: 0.9775, test: 0.9808
norm of g = 0.4142
gamma = 0.2058
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0878, test: 0.0668
ACCURACY - train: 0.9763, test: 0.9790
norm of g = 0.4869
gamma = 0.4631
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.0804, test: 0.0685
ACCURACY - train: 0.9758, test: 0.9792
norm of g = 0.4391
gamma = 0.4608
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0773, test: 0.0690
ACCURACY - train: 0.9754, test: 0.9805
norm of g = 0.3591
expanding trust region radius
gamma = 0.3916
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0712, test: 0.0675
ACCURACY - train: 0.9796, test: 0.9808
norm of g = 0.3655
shrinking trust region radius
gamma = 0.3647
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.0712, test: 0.0675
ACCURACY - train: 0.9796, test: 0.9808
norm of g = 0.3655
expanding trust region radius
gamma = 0.3677
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0757, test: 0.0665
ACCURACY - train: 0.9763, test: 0.9807
norm of g = 0.3962
gamma = 0.1442
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0657, test: 0.0706
ACCURACY - train: 0.9788, test: 0.9778
norm of g = 0.3067
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0668, test: 0.0670
ACCURACY - train: 0.9808, test: 0.9798
norm of g = 0.2720
gamma = 0.1111
weights are updated
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0699, test: 0.0666
ACCURACY - train: 0.9775, test: 0.9793
norm of g = 0.3992
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0719, test: 0.0726
ACCURACY - train: 0.9796, test: 0.9786
norm of g = 0.4813
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0764, test: 0.0745
ACCURACY - train: 0.9758, test: 0.9782
norm of g = 0.6827
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0634, test: 0.0677
ACCURACY - train: 0.9829, test: 0.9793
norm of g = 0.5352
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0629, test: 0.0719
ACCURACY - train: 0.9808, test: 0.9777
norm of g = 0.4059
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0687, test: 0.0647
ACCURACY - train: 0.9800, test: 0.9801
norm of g = 0.4020
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0799, test: 0.0663
ACCURACY - train: 0.9775, test: 0.9796
norm of g = 0.4290
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.0929, test: 0.0711
ACCURACY - train: 0.9758, test: 0.9777
norm of g = 0.6344
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.0929, test: 0.0711
ACCURACY - train: 0.9758, test: 0.9777
norm of g = 0.6344
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0771, test: 0.0648
ACCURACY - train: 0.9829, test: 0.9800
norm of g = 0.3536
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0621, test: 0.0631
ACCURACY - train: 0.9842, test: 0.9806
norm of g = 0.3238
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0611, test: 0.0632
ACCURACY - train: 0.9833, test: 0.9808
norm of g = 0.2543
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0619, test: 0.0618
ACCURACY - train: 0.9812, test: 0.9813
norm of g = 0.1970
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0734, test: 0.0606
ACCURACY - train: 0.9742, test: 0.9820
norm of g = 0.2885
gamma = 0.1275
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0689, test: 0.0619
ACCURACY - train: 0.9771, test: 0.9811
norm of g = 0.3118
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0689, test: 0.0619
ACCURACY - train: 0.9771, test: 0.9811
norm of g = 0.3118
expanding trust region radius
gamma = 0.1178
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0637, test: 0.0616
ACCURACY - train: 0.9813, test: 0.9815
norm of g = 0.3646
gamma = 0.0749
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0694, test: 0.0634
ACCURACY - train: 0.9779, test: 0.9802
norm of g = 0.4514
gamma = 0.0845
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0630, test: 0.0611
ACCURACY - train: 0.9788, test: 0.9817
norm of g = 0.3758
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0524, test: 0.0619
ACCURACY - train: 0.9871, test: 0.9809
norm of g = 0.3159
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0563, test: 0.0631
ACCURACY - train: 0.9871, test: 0.9810
norm of g = 0.2898
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0747, test: 0.0622
ACCURACY - train: 0.9779, test: 0.9819
norm of g = 0.3562
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0726, test: 0.0604
ACCURACY - train: 0.9783, test: 0.9819
norm of g = 0.2149
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0626, test: 0.0607
ACCURACY - train: 0.9800, test: 0.9818
norm of g = 0.3074
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0638, test: 0.0649
ACCURACY - train: 0.9779, test: 0.9809
norm of g = 0.4809
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0638, test: 0.0649
ACCURACY - train: 0.9779, test: 0.9809
norm of g = 0.4809
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0570, test: 0.0610
ACCURACY - train: 0.9804, test: 0.9820
norm of g = 0.4209
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0599, test: 0.0604
ACCURACY - train: 0.9804, test: 0.9822
norm of g = 0.2357
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0642, test: 0.0602
ACCURACY - train: 0.9817, test: 0.9825
norm of g = 0.3296
gamma = 0.1273
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0599, test: 0.0604
ACCURACY - train: 0.9842, test: 0.9820
norm of g = 0.2443
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0643, test: 0.0610
ACCURACY - train: 0.9804, test: 0.9814
norm of g = 0.5532
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0544, test: 0.0603
ACCURACY - train: 0.9821, test: 0.9823
norm of g = 0.2956
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0505, test: 0.0643
ACCURACY - train: 0.9838, test: 0.9813
norm of g = 0.2189
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0609, test: 0.0627
ACCURACY - train: 0.9800, test: 0.9818
norm of g = 0.3073
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0618, test: 0.0623
ACCURACY - train: 0.9829, test: 0.9820
norm of g = 0.3529
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0514, test: 0.0596
ACCURACY - train: 0.9850, test: 0.9824
norm of g = 0.3342
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0551, test: 0.0626
ACCURACY - train: 0.9821, test: 0.9804
norm of g = 0.3075
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0568, test: 0.0597
ACCURACY - train: 0.9813, test: 0.9816
norm of g = 0.3644
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0476, test: 0.0613
ACCURACY - train: 0.9850, test: 0.9813
norm of g = 0.3351
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0443, test: 0.0562
ACCURACY - train: 0.9879, test: 0.9839
norm of g = 0.3419
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0591, test: 0.0597
ACCURACY - train: 0.9833, test: 0.9821
norm of g = 0.4407
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0719, test: 0.0590
ACCURACY - train: 0.9763, test: 0.9821
norm of g = 0.3574
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0708, test: 0.0614
ACCURACY - train: 0.9783, test: 0.9825
norm of g = 0.3760
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0708, test: 0.0614
ACCURACY - train: 0.9783, test: 0.9825
norm of g = 0.3760
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0609, test: 0.0598
ACCURACY - train: 0.9858, test: 0.9820
norm of g = 0.2893
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0517, test: 0.0584
ACCURACY - train: 0.9883, test: 0.9830
norm of g = 0.3333
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0700, test: 0.0564
ACCURACY - train: 0.9825, test: 0.9834
norm of g = 0.3293
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0752, test: 0.0580
ACCURACY - train: 0.9783, test: 0.9829
norm of g = 0.3857
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0675, test: 0.0562
ACCURACY - train: 0.9808, test: 0.9834
norm of g = 0.2845
expanding trust region radius
gamma = 0.0928
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0651, test: 0.0569
ACCURACY - train: 0.9800, test: 0.9838
norm of g = 0.3050
gamma = 0.1001
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0651, test: 0.0660
ACCURACY - train: 0.9812, test: 0.9814
norm of g = 0.7109
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0651, test: 0.0660
ACCURACY - train: 0.9813, test: 0.9814
norm of g = 0.7109
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0665, test: 0.0598
ACCURACY - train: 0.9813, test: 0.9828
norm of g = 0.4201
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0580, test: 0.0579
ACCURACY - train: 0.9846, test: 0.9832
norm of g = 0.2641
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0578, test: 0.0575
ACCURACY - train: 0.9821, test: 0.9826
norm of g = 0.2441
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0592, test: 0.0565
ACCURACY - train: 0.9800, test: 0.9824
norm of g = 0.3979
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0579, test: 0.0573
ACCURACY - train: 0.9821, test: 0.9829
norm of g = 0.2219
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0592, test: 0.0580
ACCURACY - train: 0.9800, test: 0.9829
norm of g = 0.3451
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0567, test: 0.0653
ACCURACY - train: 0.9833, test: 0.9796
norm of g = 0.6304
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0509, test: 0.0605
ACCURACY - train: 0.9850, test: 0.9811
norm of g = 0.2754
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0581, test: 0.0593
ACCURACY - train: 0.9821, test: 0.9822
norm of g = 0.4891
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0737, test: 0.0598
ACCURACY - train: 0.9775, test: 0.9819
norm of g = 0.6557
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0793, test: 0.0600
ACCURACY - train: 0.9788, test: 0.9806
norm of g = 0.4303
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0630, test: 0.0588
ACCURACY - train: 0.9875, test: 0.9816
norm of g = 0.4063
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0516, test: 0.0588
ACCURACY - train: 0.9867, test: 0.9819
norm of g = 0.2396
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0493, test: 0.0572
ACCURACY - train: 0.9858, test: 0.9820
norm of g = 0.2717
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0522, test: 0.0564
ACCURACY - train: 0.9863, test: 0.9838
norm of g = 0.2491
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0609, test: 0.0543
ACCURACY - train: 0.9787, test: 0.9848
norm of g = 0.2655
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0615, test: 0.0571
ACCURACY - train: 0.9800, test: 0.9832
norm of g = 0.3343
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0570, test: 0.0571
ACCURACY - train: 0.9821, test: 0.9821
norm of g = 0.3992
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0737, test: 0.0689
ACCURACY - train: 0.9742, test: 0.9790
norm of g = 0.9681
gamma = 0.4756
weights are updated
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0543, test: 0.0560
ACCURACY - train: 0.9804, test: 0.9829
norm of g = 0.3241
expanding trust region radius
gamma = 0.5472
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0438, test: 0.0563
ACCURACY - train: 0.9883, test: 0.9829
norm of g = 0.3069
shrinking trust region radius
gamma = 0.5224
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0438, test: 0.0563
ACCURACY - train: 0.9883, test: 0.9829
norm of g = 0.3069
expanding trust region radius
gamma = 0.3452
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0470, test: 0.0564
ACCURACY - train: 0.9867, test: 0.9830
norm of g = 0.2289
gamma = 0.3565
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0631, test: 0.0600
ACCURACY - train: 0.9817, test: 0.9820
norm of g = 0.3882
gamma = 0.3826
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0605, test: 0.0570
ACCURACY - train: 0.9817, test: 0.9823
norm of g = 0.2792
gamma = 0.3851
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0560, test: 0.0584
ACCURACY - train: 0.9829, test: 0.9819
norm of g = 0.5602
gamma = 0.4027
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0542, test: 0.0552
ACCURACY - train: 0.9829, test: 0.9834
norm of g = 0.3219
expanding trust region radius
gamma = 0.3798
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0456, test: 0.0565
ACCURACY - train: 0.9879, test: 0.9831
norm of g = 0.3932
shrinking trust region radius
gamma = 0.4058
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0456, test: 0.0565
ACCURACY - train: 0.9879, test: 0.9831
norm of g = 0.3932
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0530, test: 0.0576
ACCURACY - train: 0.9825, test: 0.9824
norm of g = 0.2570
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0560, test: 0.0555
ACCURACY - train: 0.9854, test: 0.9829
norm of g = 0.3032
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0540, test: 0.0550
ACCURACY - train: 0.9858, test: 0.9833
norm of g = 0.2543
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0556, test: 0.0559
ACCURACY - train: 0.9817, test: 0.9813
norm of g = 0.4879
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0522, test: 0.0581
ACCURACY - train: 0.9858, test: 0.9824
norm of g = 0.4494
gamma = 0.0450
weights are updated
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0464, test: 0.0597
ACCURACY - train: 0.9833, test: 0.9818
norm of g = 0.4471
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0572, test: 0.0608
ACCURACY - train: 0.9825, test: 0.9808
norm of g = 0.6991
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0558, test: 0.0565
ACCURACY - train: 0.9817, test: 0.9831
norm of g = 0.2710
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0480, test: 0.0546
ACCURACY - train: 0.9850, test: 0.9829
norm of g = 0.3437
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0453, test: 0.0530
ACCURACY - train: 0.9863, test: 0.9827
norm of g = 0.2121
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0447, test: 0.0520
ACCURACY - train: 0.9858, test: 0.9833
norm of g = 0.2345
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0357, test: 0.0515
ACCURACY - train: 0.9888, test: 0.9842
norm of g = 0.1703
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0372, test: 0.0503
ACCURACY - train: 0.9896, test: 0.9841
norm of g = 0.2973
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0517, test: 0.0530
ACCURACY - train: 0.9842, test: 0.9835
norm of g = 0.4772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0647, test: 0.0570
ACCURACY - train: 0.9775, test: 0.9835
norm of g = 0.5261
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0612, test: 0.0544
ACCURACY - train: 0.9813, test: 0.9834
norm of g = 0.3319
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0523, test: 0.0548
ACCURACY - train: 0.9879, test: 0.9834
norm of g = 0.3833
gamma = 0.0906
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0446, test: 0.0522
ACCURACY - train: 0.9900, test: 0.9842
norm of g = 0.2871
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0596, test: 0.0518
ACCURACY - train: 0.9846, test: 0.9840
norm of g = 0.2965
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0679, test: 0.0525
ACCURACY - train: 0.9817, test: 0.9846
norm of g = 0.5183
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0628, test: 0.0517
ACCURACY - train: 0.9796, test: 0.9839
norm of g = 0.4503
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0603, test: 0.0587
ACCURACY - train: 0.9817, test: 0.9836
norm of g = 0.4690
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0552, test: 0.0553
ACCURACY - train: 0.9821, test: 0.9843
norm of g = 0.4261
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0555, test: 0.0538
ACCURACY - train: 0.9829, test: 0.9843
norm of g = 0.3444
gamma = 0.6856
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0491, test: 0.0547
ACCURACY - train: 0.9871, test: 0.9838
norm of g = 0.2393
gamma = 0.6192
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0485, test: 0.0529
ACCURACY - train: 0.9833, test: 0.9832
norm of g = 0.2383
gamma = 0.6434
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0479, test: 0.0522
ACCURACY - train: 0.9867, test: 0.9850
norm of g = 0.3766
gamma = 0.7075
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0471, test: 0.0543
ACCURACY - train: 0.9863, test: 0.9834
norm of g = 0.2665
gamma = 0.7399
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0498, test: 0.0546
ACCURACY - train: 0.9854, test: 0.9844
norm of g = 0.3786
gamma = 0.7061
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0417, test: 0.0519
ACCURACY - train: 0.9883, test: 0.9849
norm of g = 0.2652
gamma = 0.5987
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0438, test: 0.0574
ACCURACY - train: 0.9892, test: 0.9829
norm of g = 0.3960
gamma = 0.5979
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0500, test: 0.0543
ACCURACY - train: 0.9825, test: 0.9831
norm of g = 0.5205
gamma = 0.5897
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0628, test: 0.0526
ACCURACY - train: 0.9817, test: 0.9840
norm of g = 0.5538
reached to the max num iteration -- BREAK
20 - 100 - preconditioning -- 1
2018-06-28 08:20:48.207507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:02:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:20:48.486879: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3bcb4b0 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:20:48.487797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 1 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:03:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:20:48.748661: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3bcf990 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:20:48.749511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 2 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:82:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:20:49.014187: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x3bf3f00 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2018-06-28 08:20:49.015049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 3 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:83:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
2018-06-28 08:20:49.015351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 2
2018-06-28 08:20:49.015375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 0 and 3
2018-06-28 08:20:49.015407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 2
2018-06-28 08:20:49.015422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 1 and 3
2018-06-28 08:20:49.015435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 0
2018-06-28 08:20:49.015449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 2 and 1
2018-06-28 08:20:49.015681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 0
2018-06-28 08:20:49.015702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:847] Peer access not supported between device ordinals 3 and 1
2018-06-28 08:20:49.015792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 1 2 3 
2018-06-28 08:20:49.015803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y Y N N 
2018-06-28 08:20:49.015810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 1:   Y Y N N 
2018-06-28 08:20:49.015816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 2:   N N Y Y 
2018-06-28 08:20:49.015823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 3:   N N Y Y 
2018-06-28 08:20:49.015838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:02:00.0)
2018-06-28 08:20:49.015846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K20m, pci bus id: 0000:03:00.0)
2018-06-28 08:20:49.015853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K20m, pci bus id: 0000:82:00.0)
2018-06-28 08:20:49.015860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K20m, pci bus id: 0000:83:00.0)
Extracting ./data/train-images-idx3-ubyte.gz
Extracting ./data/train-labels-idx1-ubyte.gz
Extracting ./data/t10k-images-idx3-ubyte.gz
Extracting ./data/t10k-labels-idx1-ubyte.gz
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.3206, test: 2.3229
ACCURACY - train: 0.1183, test: 0.1177
norm of g = 0.4999
Backtracking line search satisfied for alpha = 1.0000
initial gamma = 3.7978
weights are updated
------------------------------------------------------------
iteration: 0
LOSS     - train: 2.2857, test: 2.2988
ACCURACY - train: 0.1117, test: 0.1022
norm of g = 0.7514
gamma = 0.5244
weights are updated
------------------------------------------------------------
iteration: 1
LOSS     - train: 2.2273, test: 2.2354
ACCURACY - train: 0.2467, test: 0.2289
norm of g = 0.4507
shrinking trust region radius
no need for safe gaurding
gamma = 1.1290
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 2
LOSS     - train: 2.2273, test: 2.2354
ACCURACY - train: 0.2467, test: 0.2289
norm of g = 0.4507
no need for safe gaurding
gamma = 3.1816
weights are updated
------------------------------------------------------------
iteration: 3
LOSS     - train: 2.0550, test: 2.0585
ACCURACY - train: 0.4700, test: 0.4643
norm of g = 0.8819
curvature condition did satisfy -- (s,y) was not added
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 4
LOSS     - train: 1.7640, test: 1.7509
ACCURACY - train: 0.5192, test: 0.5269
norm of g = 1.5331
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 5
LOSS     - train: 1.7640, test: 1.7509
ACCURACY - train: 0.5192, test: 0.5269
norm of g = 1.5331
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 6
LOSS     - train: 1.6058, test: 1.5836
ACCURACY - train: 0.6708, test: 0.6843
norm of g = 1.4697
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 7
LOSS     - train: 1.4356, test: 1.4347
ACCURACY - train: 0.7067, test: 0.7247
norm of g = 1.3010
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 8
LOSS     - train: 1.2907, test: 1.2748
ACCURACY - train: 0.7392, test: 0.7556
norm of g = 1.2448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 9
LOSS     - train: 1.1612, test: 1.1347
ACCURACY - train: 0.7408, test: 0.7625
norm of g = 1.3872
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 10
LOSS     - train: 1.0152, test: 1.0342
ACCURACY - train: 0.7667, test: 0.7657
norm of g = 1.9144
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 11
LOSS     - train: 0.9172, test: 0.9120
ACCURACY - train: 0.7508, test: 0.7752
norm of g = 1.5103
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 12
LOSS     - train: 0.9063, test: 0.8577
ACCURACY - train: 0.7483, test: 0.7620
norm of g = 2.5379
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 13
LOSS     - train: 0.7721, test: 0.7485
ACCURACY - train: 0.7833, test: 0.7953
norm of g = 1.8683
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 14
LOSS     - train: 0.7487, test: 0.7078
ACCURACY - train: 0.7825, test: 0.8009
norm of g = 2.2296
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 15
LOSS     - train: 0.6602, test: 0.6151
ACCURACY - train: 0.8025, test: 0.8259
norm of g = 2.0185
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 16
LOSS     - train: 0.6602, test: 0.6151
ACCURACY - train: 0.8025, test: 0.8259
norm of g = 2.0185
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 17
LOSS     - train: 0.6050, test: 0.5801
ACCURACY - train: 0.8433, test: 0.8459
norm of g = 1.0126
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 18
LOSS     - train: 0.5742, test: 0.5646
ACCURACY - train: 0.8500, test: 0.8535
norm of g = 0.7533
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 19
LOSS     - train: 0.5628, test: 0.5440
ACCURACY - train: 0.8417, test: 0.8533
norm of g = 1.0283
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 20
LOSS     - train: 0.5168, test: 0.5146
ACCURACY - train: 0.8658, test: 0.8612
norm of g = 0.5509
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 21
LOSS     - train: 0.5384, test: 0.4889
ACCURACY - train: 0.8542, test: 0.8661
norm of g = 0.8964
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 22
LOSS     - train: 0.5384, test: 0.4686
ACCURACY - train: 0.8500, test: 0.8693
norm of g = 0.8727
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 23
LOSS     - train: 0.5384, test: 0.4686
ACCURACY - train: 0.8500, test: 0.8693
norm of g = 0.8727
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 24
LOSS     - train: 0.5024, test: 0.4642
ACCURACY - train: 0.8558, test: 0.8698
norm of g = 0.8113
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 25
LOSS     - train: 0.5051, test: 0.4579
ACCURACY - train: 0.8575, test: 0.8721
norm of g = 0.8451
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 26
LOSS     - train: 0.4922, test: 0.4505
ACCURACY - train: 0.8625, test: 0.8742
norm of g = 0.6863
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 27
LOSS     - train: 0.4813, test: 0.4446
ACCURACY - train: 0.8625, test: 0.8725
norm of g = 1.1940
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 28
LOSS     - train: 0.4335, test: 0.4158
ACCURACY - train: 0.8800, test: 0.8862
norm of g = 0.7145
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 29
LOSS     - train: 0.3943, test: 0.3997
ACCURACY - train: 0.8858, test: 0.8877
norm of g = 1.2582
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 30
LOSS     - train: 0.3810, test: 0.3742
ACCURACY - train: 0.8875, test: 0.8952
norm of g = 0.9608
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 31
LOSS     - train: 0.3810, test: 0.3742
ACCURACY - train: 0.8875, test: 0.8952
norm of g = 0.9608
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 32
LOSS     - train: 0.3812, test: 0.3558
ACCURACY - train: 0.8858, test: 0.8992
norm of g = 0.7952
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 33
LOSS     - train: 0.3520, test: 0.3496
ACCURACY - train: 0.8967, test: 0.8999
norm of g = 0.7498
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 34
LOSS     - train: 0.3582, test: 0.3451
ACCURACY - train: 0.8967, test: 0.9017
norm of g = 0.8570
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 35
LOSS     - train: 0.3442, test: 0.3264
ACCURACY - train: 0.8925, test: 0.9076
norm of g = 0.7603
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 36
LOSS     - train: 0.3502, test: 0.3200
ACCURACY - train: 0.9025, test: 0.9055
norm of g = 1.4058
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 37
LOSS     - train: 0.3574, test: 0.3250
ACCURACY - train: 0.9092, test: 0.9049
norm of g = 1.4784
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 38
LOSS     - train: 0.3028, test: 0.2853
ACCURACY - train: 0.9142, test: 0.9175
norm of g = 0.6516
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 39
LOSS     - train: 0.2950, test: 0.2688
ACCURACY - train: 0.9192, test: 0.9243
norm of g = 0.8661
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 40
LOSS     - train: 0.2787, test: 0.2608
ACCURACY - train: 0.9175, test: 0.9229
norm of g = 0.8591
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 41
LOSS     - train: 0.2591, test: 0.2523
ACCURACY - train: 0.9192, test: 0.9258
norm of g = 0.9483
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 42
LOSS     - train: 0.2591, test: 0.2470
ACCURACY - train: 0.9217, test: 0.9267
norm of g = 1.0984
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 43
LOSS     - train: 0.2515, test: 0.2391
ACCURACY - train: 0.9267, test: 0.9300
norm of g = 1.3039
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 44
LOSS     - train: 0.2515, test: 0.2391
ACCURACY - train: 0.9267, test: 0.9300
norm of g = 1.3039
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 45
LOSS     - train: 0.2388, test: 0.2248
ACCURACY - train: 0.9283, test: 0.9344
norm of g = 0.4773
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 46
LOSS     - train: 0.2437, test: 0.2179
ACCURACY - train: 0.9217, test: 0.9357
norm of g = 0.5048
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 47
LOSS     - train: 0.2099, test: 0.2120
ACCURACY - train: 0.9450, test: 0.9386
norm of g = 0.5239
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 48
LOSS     - train: 0.1870, test: 0.2036
ACCURACY - train: 0.9492, test: 0.9410
norm of g = 0.4546
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 49
LOSS     - train: 0.1952, test: 0.2050
ACCURACY - train: 0.9425, test: 0.9395
norm of g = 0.8894
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 50
LOSS     - train: 0.2333, test: 0.2226
ACCURACY - train: 0.9250, test: 0.9325
norm of g = 1.2054
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 51
LOSS     - train: 0.2074, test: 0.1949
ACCURACY - train: 0.9417, test: 0.9444
norm of g = 0.6440
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 52
LOSS     - train: 0.1859, test: 0.1886
ACCURACY - train: 0.9433, test: 0.9466
norm of g = 0.6034
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 53
LOSS     - train: 0.1859, test: 0.1886
ACCURACY - train: 0.9433, test: 0.9466
norm of g = 0.6034
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 54
LOSS     - train: 0.1869, test: 0.1844
ACCURACY - train: 0.9425, test: 0.9466
norm of g = 0.6448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 55
LOSS     - train: 0.1590, test: 0.1824
ACCURACY - train: 0.9542, test: 0.9456
norm of g = 0.5841
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 56
LOSS     - train: 0.1893, test: 0.1829
ACCURACY - train: 0.9492, test: 0.9448
norm of g = 0.6565
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 57
LOSS     - train: 0.1988, test: 0.1771
ACCURACY - train: 0.9433, test: 0.9493
norm of g = 0.5518
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 58
LOSS     - train: 0.1864, test: 0.1730
ACCURACY - train: 0.9342, test: 0.9503
norm of g = 0.6013
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 59
LOSS     - train: 0.1959, test: 0.1727
ACCURACY - train: 0.9450, test: 0.9499
norm of g = 0.4733
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 60
LOSS     - train: 0.1828, test: 0.1706
ACCURACY - train: 0.9533, test: 0.9496
norm of g = 0.4860
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 61
LOSS     - train: 0.1874, test: 0.1722
ACCURACY - train: 0.9475, test: 0.9501
norm of g = 0.4847
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 62
LOSS     - train: 0.2000, test: 0.1656
ACCURACY - train: 0.9392, test: 0.9530
norm of g = 0.6740
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 63
LOSS     - train: 0.2000, test: 0.1656
ACCURACY - train: 0.9392, test: 0.9530
norm of g = 0.6740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 64
LOSS     - train: 0.2138, test: 0.1623
ACCURACY - train: 0.9375, test: 0.9526
norm of g = 0.5342
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 65
LOSS     - train: 0.1944, test: 0.1611
ACCURACY - train: 0.9450, test: 0.9531
norm of g = 0.5087
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 66
LOSS     - train: 0.1599, test: 0.1606
ACCURACY - train: 0.9517, test: 0.9542
norm of g = 0.5201
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 67
LOSS     - train: 0.1751, test: 0.1589
ACCURACY - train: 0.9408, test: 0.9561
norm of g = 0.5907
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 68
LOSS     - train: 0.1771, test: 0.1617
ACCURACY - train: 0.9475, test: 0.9522
norm of g = 0.4141
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 69
LOSS     - train: 0.1470, test: 0.1586
ACCURACY - train: 0.9608, test: 0.9548
norm of g = 0.4555
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 70
LOSS     - train: 0.1413, test: 0.1582
ACCURACY - train: 0.9667, test: 0.9545
norm of g = 0.5664
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 71
LOSS     - train: 0.1387, test: 0.1563
ACCURACY - train: 0.9642, test: 0.9536
norm of g = 0.7518
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 72
LOSS     - train: 0.1570, test: 0.1521
ACCURACY - train: 0.9567, test: 0.9564
norm of g = 0.4053
expanding trust region radius
gamma = 0.1466
weights are updated
------------------------------------------------------------
iteration: 73
LOSS     - train: 0.1553, test: 0.1499
ACCURACY - train: 0.9592, test: 0.9560
norm of g = 0.3364
gamma = 0.1490
weights are updated
------------------------------------------------------------
iteration: 74
LOSS     - train: 0.1619, test: 0.1619
ACCURACY - train: 0.9433, test: 0.9546
norm of g = 0.8204
shrinking trust region radius
gamma = 0.3000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 75
LOSS     - train: 0.1619, test: 0.1619
ACCURACY - train: 0.9433, test: 0.9546
norm of g = 0.8204
expanding trust region radius
gamma = 0.0923
weights are updated
------------------------------------------------------------
iteration: 76
LOSS     - train: 0.2033, test: 0.1519
ACCURACY - train: 0.9350, test: 0.9557
norm of g = 0.7477
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 77
LOSS     - train: 0.2033, test: 0.1519
ACCURACY - train: 0.9350, test: 0.9557
norm of g = 0.7477
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 78
LOSS     - train: 0.1801, test: 0.1475
ACCURACY - train: 0.9450, test: 0.9573
norm of g = 0.5480
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 79
LOSS     - train: 0.1628, test: 0.1446
ACCURACY - train: 0.9467, test: 0.9594
norm of g = 0.5823
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 80
LOSS     - train: 0.1743, test: 0.1454
ACCURACY - train: 0.9433, test: 0.9596
norm of g = 0.6545
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 81
LOSS     - train: 0.1530, test: 0.1469
ACCURACY - train: 0.9542, test: 0.9586
norm of g = 0.3797
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 82
LOSS     - train: 0.1571, test: 0.1454
ACCURACY - train: 0.9542, test: 0.9592
norm of g = 0.5917
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 83
LOSS     - train: 0.1675, test: 0.1426
ACCURACY - train: 0.9508, test: 0.9599
norm of g = 0.5915
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 84
LOSS     - train: 0.1429, test: 0.1392
ACCURACY - train: 0.9592, test: 0.9612
norm of g = 0.4784
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 85
LOSS     - train: 0.1292, test: 0.1386
ACCURACY - train: 0.9600, test: 0.9607
norm of g = 0.4992
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 86
LOSS     - train: 0.1419, test: 0.1386
ACCURACY - train: 0.9592, test: 0.9605
norm of g = 0.3688
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 87
LOSS     - train: 0.1394, test: 0.1379
ACCURACY - train: 0.9633, test: 0.9610
norm of g = 0.5740
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 88
LOSS     - train: 0.1400, test: 0.1451
ACCURACY - train: 0.9650, test: 0.9577
norm of g = 0.7656
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 89
LOSS     - train: 0.1383, test: 0.1434
ACCURACY - train: 0.9608, test: 0.9594
norm of g = 0.7624
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 90
LOSS     - train: 0.1631, test: 0.1432
ACCURACY - train: 0.9517, test: 0.9587
norm of g = 0.8473
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 91
LOSS     - train: 0.1817, test: 0.1332
ACCURACY - train: 0.9442, test: 0.9618
norm of g = 0.4693
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 92
LOSS     - train: 0.1704, test: 0.1411
ACCURACY - train: 0.9508, test: 0.9597
norm of g = 1.0467
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 93
LOSS     - train: 0.1264, test: 0.1302
ACCURACY - train: 0.9650, test: 0.9633
norm of g = 0.3920
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 94
LOSS     - train: 0.1372, test: 0.1309
ACCURACY - train: 0.9642, test: 0.9621
norm of g = 0.5541
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 95
LOSS     - train: 0.1329, test: 0.1271
ACCURACY - train: 0.9633, test: 0.9627
norm of g = 0.7153
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 96
LOSS     - train: 0.1179, test: 0.1288
ACCURACY - train: 0.9642, test: 0.9612
norm of g = 0.4987
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 97
LOSS     - train: 0.1353, test: 0.1291
ACCURACY - train: 0.9625, test: 0.9605
norm of g = 0.5046
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 98
LOSS     - train: 0.1308, test: 0.1268
ACCURACY - train: 0.9608, test: 0.9627
norm of g = 0.4671
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 99
LOSS     - train: 0.1062, test: 0.1255
ACCURACY - train: 0.9700, test: 0.9623
norm of g = 0.4785
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 100
LOSS     - train: 0.1148, test: 0.1254
ACCURACY - train: 0.9750, test: 0.9621
norm of g = 0.5338
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 101
LOSS     - train: 0.1305, test: 0.1187
ACCURACY - train: 0.9617, test: 0.9645
norm of g = 0.5305
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 102
LOSS     - train: 0.1248, test: 0.1191
ACCURACY - train: 0.9625, test: 0.9649
norm of g = 0.5439
gamma = 0.2683
weights are updated
------------------------------------------------------------
iteration: 103
LOSS     - train: 0.1193, test: 0.1186
ACCURACY - train: 0.9717, test: 0.9653
norm of g = 0.6482
gamma = 0.2188
weights are updated
------------------------------------------------------------
iteration: 104
LOSS     - train: 0.1423, test: 0.1252
ACCURACY - train: 0.9592, test: 0.9609
norm of g = 0.7541
gamma = 0.1474
weights are updated
------------------------------------------------------------
iteration: 105
LOSS     - train: 0.1279, test: 0.1271
ACCURACY - train: 0.9633, test: 0.9614
norm of g = 1.1350
gamma = 0.1051
weights are updated
------------------------------------------------------------
iteration: 106
LOSS     - train: 0.1009, test: 0.1149
ACCURACY - train: 0.9725, test: 0.9660
norm of g = 0.4730
gamma = 0.1449
weights are updated
------------------------------------------------------------
iteration: 107
LOSS     - train: 0.1245, test: 0.1206
ACCURACY - train: 0.9608, test: 0.9619
norm of g = 0.7722
gamma = 0.1608
weights are updated
------------------------------------------------------------
iteration: 108
LOSS     - train: 0.1176, test: 0.1274
ACCURACY - train: 0.9617, test: 0.9620
norm of g = 0.9081
gamma = 0.1870
weights are updated
------------------------------------------------------------
iteration: 109
LOSS     - train: 0.1016, test: 0.1175
ACCURACY - train: 0.9700, test: 0.9668
norm of g = 0.6309
gamma = 0.1750
weights are updated
------------------------------------------------------------
iteration: 110
LOSS     - train: 0.1160, test: 0.1177
ACCURACY - train: 0.9625, test: 0.9657
norm of g = 0.5811
gamma = 0.1932
weights are updated
------------------------------------------------------------
iteration: 111
LOSS     - train: 0.1160, test: 0.1161
ACCURACY - train: 0.9642, test: 0.9669
norm of g = 0.6387
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 112
LOSS     - train: 0.1054, test: 0.1109
ACCURACY - train: 0.9742, test: 0.9655
norm of g = 0.5542
gamma = 0.1255
weights are updated
------------------------------------------------------------
iteration: 113
LOSS     - train: 0.1347, test: 0.1123
ACCURACY - train: 0.9650, test: 0.9655
norm of g = 0.5924
gamma = 0.2203
weights are updated
------------------------------------------------------------
iteration: 114
LOSS     - train: 0.1222, test: 0.1164
ACCURACY - train: 0.9650, test: 0.9649
norm of g = 0.9247
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 115
LOSS     - train: 0.1028, test: 0.1147
ACCURACY - train: 0.9633, test: 0.9648
norm of g = 0.7650
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 116
LOSS     - train: 0.1045, test: 0.1106
ACCURACY - train: 0.9642, test: 0.9675
norm of g = 0.7850
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 117
LOSS     - train: 0.0839, test: 0.1054
ACCURACY - train: 0.9800, test: 0.9698
norm of g = 0.4344
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 118
LOSS     - train: 0.0839, test: 0.1149
ACCURACY - train: 0.9717, test: 0.9647
norm of g = 0.7276
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 119
LOSS     - train: 0.1036, test: 0.1066
ACCURACY - train: 0.9700, test: 0.9695
norm of g = 0.4696
gamma = 0.0113
weights are updated
------------------------------------------------------------
iteration: 120
LOSS     - train: 0.1094, test: 0.1046
ACCURACY - train: 0.9683, test: 0.9683
norm of g = 0.4827
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 121
LOSS     - train: 0.1094, test: 0.1046
ACCURACY - train: 0.9683, test: 0.9683
norm of g = 0.4827
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 122
LOSS     - train: 0.1067, test: 0.1017
ACCURACY - train: 0.9683, test: 0.9694
norm of g = 0.5074
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 123
LOSS     - train: 0.0952, test: 0.1002
ACCURACY - train: 0.9683, test: 0.9701
norm of g = 0.4681
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 124
LOSS     - train: 0.0818, test: 0.0988
ACCURACY - train: 0.9733, test: 0.9688
norm of g = 0.4795
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 125
LOSS     - train: 0.0935, test: 0.0974
ACCURACY - train: 0.9733, test: 0.9707
norm of g = 0.3151
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 126
LOSS     - train: 0.0977, test: 0.0969
ACCURACY - train: 0.9700, test: 0.9722
norm of g = 0.3377
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 127
LOSS     - train: 0.0875, test: 0.0976
ACCURACY - train: 0.9758, test: 0.9716
norm of g = 0.3592
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 128
LOSS     - train: 0.1059, test: 0.0973
ACCURACY - train: 0.9667, test: 0.9701
norm of g = 0.4634
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 129
LOSS     - train: 0.1344, test: 0.0987
ACCURACY - train: 0.9608, test: 0.9704
norm of g = 0.5772
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 130
LOSS     - train: 0.1299, test: 0.1103
ACCURACY - train: 0.9592, test: 0.9680
norm of g = 0.6738
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 131
LOSS     - train: 0.1560, test: 0.1291
ACCURACY - train: 0.9500, test: 0.9635
norm of g = 1.5149
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 132
LOSS     - train: 0.1391, test: 0.1132
ACCURACY - train: 0.9592, test: 0.9636
norm of g = 0.9607
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 133
LOSS     - train: 0.1041, test: 0.1081
ACCURACY - train: 0.9683, test: 0.9675
norm of g = 0.6903
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 134
LOSS     - train: 0.1052, test: 0.1049
ACCURACY - train: 0.9667, test: 0.9691
norm of g = 0.6643
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 135
LOSS     - train: 0.0958, test: 0.1043
ACCURACY - train: 0.9700, test: 0.9676
norm of g = 0.6907
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 136
LOSS     - train: 0.0958, test: 0.1043
ACCURACY - train: 0.9700, test: 0.9676
norm of g = 0.6907
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 137
LOSS     - train: 0.0861, test: 0.0937
ACCURACY - train: 0.9733, test: 0.9727
norm of g = 0.3642
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 138
LOSS     - train: 0.1083, test: 0.0929
ACCURACY - train: 0.9767, test: 0.9724
norm of g = 0.3616
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 139
LOSS     - train: 0.1370, test: 0.0911
ACCURACY - train: 0.9608, test: 0.9726
norm of g = 0.6412
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 140
LOSS     - train: 0.1126, test: 0.0889
ACCURACY - train: 0.9692, test: 0.9743
norm of g = 0.5611
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 141
LOSS     - train: 0.1137, test: 0.0918
ACCURACY - train: 0.9633, test: 0.9743
norm of g = 0.7629
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 142
LOSS     - train: 0.1229, test: 0.0894
ACCURACY - train: 0.9642, test: 0.9725
norm of g = 0.5041
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 143
LOSS     - train: 0.1187, test: 0.0887
ACCURACY - train: 0.9633, test: 0.9729
norm of g = 0.5970
gamma = 0.0205
weights are updated
------------------------------------------------------------
iteration: 144
LOSS     - train: 0.0982, test: 0.0899
ACCURACY - train: 0.9683, test: 0.9734
norm of g = 0.3745
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 145
LOSS     - train: 0.0954, test: 0.0932
ACCURACY - train: 0.9742, test: 0.9732
norm of g = 0.6284
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 146
LOSS     - train: 0.1050, test: 0.0889
ACCURACY - train: 0.9667, test: 0.9749
norm of g = 0.3972
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 147
LOSS     - train: 0.0928, test: 0.0876
ACCURACY - train: 0.9683, test: 0.9745
norm of g = 0.4090
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 148
LOSS     - train: 0.0868, test: 0.0878
ACCURACY - train: 0.9758, test: 0.9738
norm of g = 0.3195
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 149
LOSS     - train: 0.0961, test: 0.0865
ACCURACY - train: 0.9733, test: 0.9731
norm of g = 0.4398
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 150
LOSS     - train: 0.0826, test: 0.0879
ACCURACY - train: 0.9800, test: 0.9728
norm of g = 0.4005
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 151
LOSS     - train: 0.0849, test: 0.0900
ACCURACY - train: 0.9783, test: 0.9724
norm of g = 0.5620
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 152
LOSS     - train: 0.0915, test: 0.0888
ACCURACY - train: 0.9750, test: 0.9733
norm of g = 0.4263
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 153
LOSS     - train: 0.0975, test: 0.0931
ACCURACY - train: 0.9717, test: 0.9704
norm of g = 0.9096
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 154
LOSS     - train: 0.0843, test: 0.0879
ACCURACY - train: 0.9758, test: 0.9749
norm of g = 0.5790
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 155
LOSS     - train: 0.0902, test: 0.0922
ACCURACY - train: 0.9758, test: 0.9727
norm of g = 0.5310
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 156
LOSS     - train: 0.1083, test: 0.0924
ACCURACY - train: 0.9650, test: 0.9729
norm of g = 0.6328
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 157
LOSS     - train: 0.1113, test: 0.0970
ACCURACY - train: 0.9642, test: 0.9714
norm of g = 1.1834
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 158
LOSS     - train: 0.0848, test: 0.0858
ACCURACY - train: 0.9733, test: 0.9747
norm of g = 0.5246
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 159
LOSS     - train: 0.0812, test: 0.0888
ACCURACY - train: 0.9750, test: 0.9736
norm of g = 0.7245
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 160
LOSS     - train: 0.0681, test: 0.0885
ACCURACY - train: 0.9783, test: 0.9736
norm of g = 0.2994
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 161
LOSS     - train: 0.0860, test: 0.0867
ACCURACY - train: 0.9767, test: 0.9743
norm of g = 0.5020
gamma = 0.1352
weights are updated
------------------------------------------------------------
iteration: 162
LOSS     - train: 0.0938, test: 0.0839
ACCURACY - train: 0.9750, test: 0.9754
norm of g = 0.3938
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 163
LOSS     - train: 0.0843, test: 0.0836
ACCURACY - train: 0.9742, test: 0.9763
norm of g = 0.4605
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 164
LOSS     - train: 0.0908, test: 0.0820
ACCURACY - train: 0.9742, test: 0.9768
norm of g = 0.5906
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 165
LOSS     - train: 0.0804, test: 0.0811
ACCURACY - train: 0.9750, test: 0.9761
norm of g = 0.3659
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 166
LOSS     - train: 0.0936, test: 0.0845
ACCURACY - train: 0.9750, test: 0.9749
norm of g = 0.5323
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 167
LOSS     - train: 0.1042, test: 0.0827
ACCURACY - train: 0.9692, test: 0.9760
norm of g = 0.5768
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 168
LOSS     - train: 0.1122, test: 0.0800
ACCURACY - train: 0.9700, test: 0.9763
norm of g = 0.4710
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 169
LOSS     - train: 0.1023, test: 0.0794
ACCURACY - train: 0.9750, test: 0.9772
norm of g = 0.3681
gamma = 0.0303
weights are updated
------------------------------------------------------------
iteration: 170
LOSS     - train: 0.0782, test: 0.0802
ACCURACY - train: 0.9783, test: 0.9766
norm of g = 0.5925
shrinking trust region radius
gamma = 0.0195
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 171
LOSS     - train: 0.0782, test: 0.0802
ACCURACY - train: 0.9783, test: 0.9766
norm of g = 0.5925
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 172
LOSS     - train: 0.0867, test: 0.0791
ACCURACY - train: 0.9758, test: 0.9773
norm of g = 0.4081
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 173
LOSS     - train: 0.0857, test: 0.0792
ACCURACY - train: 0.9750, test: 0.9767
norm of g = 0.3238
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 174
LOSS     - train: 0.0729, test: 0.0798
ACCURACY - train: 0.9783, test: 0.9769
norm of g = 0.3428
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 175
LOSS     - train: 0.0705, test: 0.0767
ACCURACY - train: 0.9767, test: 0.9772
norm of g = 0.4627
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 176
LOSS     - train: 0.0671, test: 0.0762
ACCURACY - train: 0.9833, test: 0.9765
norm of g = 0.3632
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 177
LOSS     - train: 0.0773, test: 0.0752
ACCURACY - train: 0.9783, test: 0.9770
norm of g = 0.3233
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 178
LOSS     - train: 0.0717, test: 0.0758
ACCURACY - train: 0.9783, test: 0.9782
norm of g = 0.3178
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 179
LOSS     - train: 0.0798, test: 0.0758
ACCURACY - train: 0.9750, test: 0.9776
norm of g = 0.6143
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 180
LOSS     - train: 0.1120, test: 0.0808
ACCURACY - train: 0.9700, test: 0.9764
norm of g = 0.6073
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 181
LOSS     - train: 0.0931, test: 0.0759
ACCURACY - train: 0.9717, test: 0.9783
norm of g = 0.4376
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 182
LOSS     - train: 0.0807, test: 0.0732
ACCURACY - train: 0.9767, test: 0.9780
norm of g = 0.5512
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 183
LOSS     - train: 0.1075, test: 0.0896
ACCURACY - train: 0.9692, test: 0.9745
norm of g = 1.2427
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 184
LOSS     - train: 0.0845, test: 0.0992
ACCURACY - train: 0.9750, test: 0.9702
norm of g = 1.0511
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 185
LOSS     - train: 0.0845, test: 0.0848
ACCURACY - train: 0.9775, test: 0.9747
norm of g = 0.4895
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 186
LOSS     - train: 0.0823, test: 0.0780
ACCURACY - train: 0.9783, test: 0.9764
norm of g = 0.6098
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 187
LOSS     - train: 0.0823, test: 0.0780
ACCURACY - train: 0.9783, test: 0.9764
norm of g = 0.6098
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 188
LOSS     - train: 0.0732, test: 0.0738
ACCURACY - train: 0.9758, test: 0.9775
norm of g = 0.4110
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 189
LOSS     - train: 0.0660, test: 0.0742
ACCURACY - train: 0.9767, test: 0.9780
norm of g = 0.4411
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 190
LOSS     - train: 0.0715, test: 0.0742
ACCURACY - train: 0.9792, test: 0.9785
norm of g = 0.3089
gamma = 0.2543
weights are updated
------------------------------------------------------------
iteration: 191
LOSS     - train: 0.0665, test: 0.0738
ACCURACY - train: 0.9800, test: 0.9789
norm of g = 0.3965
gamma = 0.1353
weights are updated
------------------------------------------------------------
iteration: 192
LOSS     - train: 0.0617, test: 0.0729
ACCURACY - train: 0.9825, test: 0.9802
norm of g = 0.4275
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 193
LOSS     - train: 0.0713, test: 0.0731
ACCURACY - train: 0.9817, test: 0.9790
norm of g = 0.4541
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 194
LOSS     - train: 0.1005, test: 0.0735
ACCURACY - train: 0.9708, test: 0.9781
norm of g = 0.5520
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 195
LOSS     - train: 0.1112, test: 0.0709
ACCURACY - train: 0.9667, test: 0.9790
norm of g = 0.4248
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 196
LOSS     - train: 0.0886, test: 0.0703
ACCURACY - train: 0.9733, test: 0.9790
norm of g = 0.4240
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 197
LOSS     - train: 0.0655, test: 0.0704
ACCURACY - train: 0.9842, test: 0.9786
norm of g = 0.2873
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 198
LOSS     - train: 0.0773, test: 0.0730
ACCURACY - train: 0.9767, test: 0.9780
norm of g = 0.4146
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 199
LOSS     - train: 0.0702, test: 0.0696
ACCURACY - train: 0.9792, test: 0.9792
norm of g = 0.3701
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 200
LOSS     - train: 0.0590, test: 0.0693
ACCURACY - train: 0.9800, test: 0.9781
norm of g = 0.3139
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 201
LOSS     - train: 0.0769, test: 0.0729
ACCURACY - train: 0.9750, test: 0.9783
norm of g = 0.5386
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 202
LOSS     - train: 0.0793, test: 0.0730
ACCURACY - train: 0.9742, test: 0.9782
norm of g = 0.4521
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 203
LOSS     - train: 0.0546, test: 0.0729
ACCURACY - train: 0.9850, test: 0.9779
norm of g = 0.3183
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 204
LOSS     - train: 0.0646, test: 0.0744
ACCURACY - train: 0.9875, test: 0.9771
norm of g = 0.4586
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 205
LOSS     - train: 0.0730, test: 0.0704
ACCURACY - train: 0.9792, test: 0.9780
norm of g = 0.3892
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 206
LOSS     - train: 0.0650, test: 0.0711
ACCURACY - train: 0.9792, test: 0.9780
norm of g = 0.4009
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 207
LOSS     - train: 0.0603, test: 0.0702
ACCURACY - train: 0.9850, test: 0.9786
norm of g = 0.4321
gamma = 0.0169
weights are updated
------------------------------------------------------------
iteration: 208
LOSS     - train: 0.0859, test: 0.0815
ACCURACY - train: 0.9742, test: 0.9745
norm of g = 0.6331
shrinking trust region radius
gamma = 0.0261
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 209
LOSS     - train: 0.0859, test: 0.0815
ACCURACY - train: 0.9742, test: 0.9745
norm of g = 0.6331
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 210
LOSS     - train: 0.0778, test: 0.0766
ACCURACY - train: 0.9758, test: 0.9765
norm of g = 0.5918
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 211
LOSS     - train: 0.0605, test: 0.0689
ACCURACY - train: 0.9850, test: 0.9785
norm of g = 0.4457
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 212
LOSS     - train: 0.0732, test: 0.0700
ACCURACY - train: 0.9825, test: 0.9785
norm of g = 0.3645
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 213
LOSS     - train: 0.0619, test: 0.0718
ACCURACY - train: 0.9800, test: 0.9783
norm of g = 0.3406
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 214
LOSS     - train: 0.0550, test: 0.0710
ACCURACY - train: 0.9825, test: 0.9793
norm of g = 0.3512
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 215
LOSS     - train: 0.0599, test: 0.0722
ACCURACY - train: 0.9783, test: 0.9783
norm of g = 0.3934
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 216
LOSS     - train: 0.0567, test: 0.0701
ACCURACY - train: 0.9833, test: 0.9776
norm of g = 0.3725
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 217
LOSS     - train: 0.0597, test: 0.0687
ACCURACY - train: 0.9850, test: 0.9784
norm of g = 0.3643
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 218
LOSS     - train: 0.0823, test: 0.0702
ACCURACY - train: 0.9717, test: 0.9776
norm of g = 0.4469
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 219
LOSS     - train: 0.0728, test: 0.0709
ACCURACY - train: 0.9800, test: 0.9778
norm of g = 0.5731
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 220
LOSS     - train: 0.0580, test: 0.0732
ACCURACY - train: 0.9833, test: 0.9766
norm of g = 0.4207
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 221
LOSS     - train: 0.0563, test: 0.0644
ACCURACY - train: 0.9825, test: 0.9810
norm of g = 0.4934
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 222
LOSS     - train: 0.0457, test: 0.0665
ACCURACY - train: 0.9867, test: 0.9802
norm of g = 0.3448
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 223
LOSS     - train: 0.0457, test: 0.0675
ACCURACY - train: 0.9850, test: 0.9801
norm of g = 0.3728
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 224
LOSS     - train: 0.0647, test: 0.0683
ACCURACY - train: 0.9800, test: 0.9793
norm of g = 0.4322
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 225
LOSS     - train: 0.0634, test: 0.0679
ACCURACY - train: 0.9842, test: 0.9794
norm of g = 0.3304
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 226
LOSS     - train: 0.0648, test: 0.0666
ACCURACY - train: 0.9808, test: 0.9805
norm of g = 0.5468
gamma = 0.0104
weights are updated
------------------------------------------------------------
iteration: 227
LOSS     - train: 0.0566, test: 0.0651
ACCURACY - train: 0.9842, test: 0.9799
norm of g = 0.4467
gamma = 0.3762
weights are updated
------------------------------------------------------------
iteration: 228
LOSS     - train: 0.0462, test: 0.0635
ACCURACY - train: 0.9858, test: 0.9797
norm of g = 0.5047
gamma = 0.4323
weights are updated
------------------------------------------------------------
iteration: 229
LOSS     - train: 0.0515, test: 0.0634
ACCURACY - train: 0.9875, test: 0.9811
norm of g = 0.2961
gamma = 0.4830
weights are updated
------------------------------------------------------------
iteration: 230
LOSS     - train: 0.0583, test: 0.0650
ACCURACY - train: 0.9817, test: 0.9802
norm of g = 0.4439
gamma = 0.4993
weights are updated
------------------------------------------------------------
iteration: 231
LOSS     - train: 0.0514, test: 0.0669
ACCURACY - train: 0.9858, test: 0.9800
norm of g = 0.4766
gamma = 0.3252
weights are updated
------------------------------------------------------------
iteration: 232
LOSS     - train: 0.0648, test: 0.0643
ACCURACY - train: 0.9800, test: 0.9810
norm of g = 0.5010
gamma = 0.2959
weights are updated
------------------------------------------------------------
iteration: 233
LOSS     - train: 0.0859, test: 0.0642
ACCURACY - train: 0.9700, test: 0.9811
norm of g = 0.6312
gamma = 0.4121
weights are updated
------------------------------------------------------------
iteration: 234
LOSS     - train: 0.0753, test: 0.0674
ACCURACY - train: 0.9725, test: 0.9814
norm of g = 0.5096
gamma = 0.6240
weights are updated
------------------------------------------------------------
iteration: 235
LOSS     - train: 0.0824, test: 0.0678
ACCURACY - train: 0.9767, test: 0.9794
norm of g = 0.5437
gamma = 0.3164
weights are updated
------------------------------------------------------------
iteration: 236
LOSS     - train: 0.0765, test: 0.0671
ACCURACY - train: 0.9817, test: 0.9786
norm of g = 0.5571
gamma = 0.3679
weights are updated
------------------------------------------------------------
iteration: 237
LOSS     - train: 0.0569, test: 0.0700
ACCURACY - train: 0.9825, test: 0.9777
norm of g = 0.5094
gamma = 0.4564
weights are updated
------------------------------------------------------------
iteration: 238
LOSS     - train: 0.0578, test: 0.0623
ACCURACY - train: 0.9858, test: 0.9802
norm of g = 0.3356
expanding trust region radius
gamma = 0.4592
weights are updated
------------------------------------------------------------
iteration: 239
LOSS     - train: 0.0551, test: 0.0613
ACCURACY - train: 0.9858, test: 0.9809
norm of g = 0.3368
gamma = 0.4325
weights are updated
------------------------------------------------------------
iteration: 240
LOSS     - train: 0.0558, test: 0.0689
ACCURACY - train: 0.9875, test: 0.9790
norm of g = 0.5415
gamma = 0.4266
weights are updated
------------------------------------------------------------
iteration: 241
LOSS     - train: 0.0839, test: 0.0707
ACCURACY - train: 0.9783, test: 0.9786
norm of g = 0.6504
gamma = 0.4299
weights are updated
------------------------------------------------------------
iteration: 242
LOSS     - train: 0.0995, test: 0.0678
ACCURACY - train: 0.9708, test: 0.9795
norm of g = 0.8741
shrinking trust region radius
gamma = 0.5770
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 243
LOSS     - train: 0.0995, test: 0.0678
ACCURACY - train: 0.9708, test: 0.9795
norm of g = 0.8741
gamma = 0.5566
weights are updated
------------------------------------------------------------
iteration: 244
LOSS     - train: 0.0854, test: 0.0622
ACCURACY - train: 0.9733, test: 0.9815
norm of g = 0.6801
gamma = 0.5567
weights are updated
------------------------------------------------------------
iteration: 245
LOSS     - train: 0.0863, test: 0.0620
ACCURACY - train: 0.9700, test: 0.9808
norm of g = 0.6790
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 246
LOSS     - train: 0.0902, test: 0.0598
ACCURACY - train: 0.9717, test: 0.9808
norm of g = 0.5022
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 247
LOSS     - train: 0.0867, test: 0.0599
ACCURACY - train: 0.9725, test: 0.9817
norm of g = 0.6009
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 248
LOSS     - train: 0.0725, test: 0.0603
ACCURACY - train: 0.9792, test: 0.9813
norm of g = 0.3919
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 249
LOSS     - train: 0.0652, test: 0.0609
ACCURACY - train: 0.9792, test: 0.9820
norm of g = 0.5679
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 250
LOSS     - train: 0.0711, test: 0.0594
ACCURACY - train: 0.9808, test: 0.9816
norm of g = 0.3899
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 251
LOSS     - train: 0.0629, test: 0.0597
ACCURACY - train: 0.9800, test: 0.9816
norm of g = 0.3783
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 252
LOSS     - train: 0.0586, test: 0.0605
ACCURACY - train: 0.9858, test: 0.9813
norm of g = 0.2752
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 253
LOSS     - train: 0.0630, test: 0.0595
ACCURACY - train: 0.9833, test: 0.9810
norm of g = 0.3690
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 254
LOSS     - train: 0.0516, test: 0.0602
ACCURACY - train: 0.9842, test: 0.9808
norm of g = 0.2808
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 255
LOSS     - train: 0.0515, test: 0.0607
ACCURACY - train: 0.9875, test: 0.9800
norm of g = 0.3348
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 256
LOSS     - train: 0.0606, test: 0.0641
ACCURACY - train: 0.9875, test: 0.9816
norm of g = 0.4083
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 257
LOSS     - train: 0.0697, test: 0.0714
ACCURACY - train: 0.9808, test: 0.9768
norm of g = 0.9142
shrinking trust region radius
no need for safe gaurding
gamma = 1.0000
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 258
LOSS     - train: 0.0697, test: 0.0714
ACCURACY - train: 0.9808, test: 0.9768
norm of g = 0.9142
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 259
LOSS     - train: 0.0600, test: 0.0620
ACCURACY - train: 0.9800, test: 0.9802
norm of g = 0.5750
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 260
LOSS     - train: 0.0598, test: 0.0616
ACCURACY - train: 0.9825, test: 0.9806
norm of g = 0.3722
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 261
LOSS     - train: 0.0732, test: 0.0620
ACCURACY - train: 0.9767, test: 0.9811
norm of g = 0.5079
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 262
LOSS     - train: 0.0730, test: 0.0650
ACCURACY - train: 0.9758, test: 0.9801
norm of g = 0.8556
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 263
LOSS     - train: 0.0609, test: 0.0610
ACCURACY - train: 0.9842, test: 0.9818
norm of g = 0.6070
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 264
LOSS     - train: 0.0584, test: 0.0685
ACCURACY - train: 0.9850, test: 0.9803
norm of g = 0.6933
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 265
LOSS     - train: 0.0488, test: 0.0692
ACCURACY - train: 0.9825, test: 0.9788
norm of g = 0.4197
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 266
LOSS     - train: 0.0583, test: 0.0616
ACCURACY - train: 0.9825, test: 0.9808
norm of g = 0.4443
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 267
LOSS     - train: 0.0655, test: 0.0596
ACCURACY - train: 0.9833, test: 0.9816
norm of g = 0.3908
expanding trust region radius
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 268
LOSS     - train: 0.0570, test: 0.0585
ACCURACY - train: 0.9817, test: 0.9828
norm of g = 0.3936
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 269
LOSS     - train: 0.0597, test: 0.0652
ACCURACY - train: 0.9825, test: 0.9795
norm of g = 0.7385
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 270
LOSS     - train: 0.0523, test: 0.0692
ACCURACY - train: 0.9842, test: 0.9795
norm of g = 0.5675
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 271
LOSS     - train: 0.0675, test: 0.0639
ACCURACY - train: 0.9833, test: 0.9800
norm of g = 0.5484
gamma = 0.1277
weights are updated
------------------------------------------------------------
iteration: 272
LOSS     - train: 0.0804, test: 0.0649
ACCURACY - train: 0.9817, test: 0.9807
norm of g = 0.7439
shrinking trust region radius
gamma = 0.2780
------------------------------
No update in this iteration
------------------------------------------------------------
iteration: 273
LOSS     - train: 0.0804, test: 0.0649
ACCURACY - train: 0.9817, test: 0.9807
norm of g = 0.7439
gamma = 0.3937
weights are updated
------------------------------------------------------------
iteration: 274
LOSS     - train: 0.0891, test: 0.0588
ACCURACY - train: 0.9783, test: 0.9820
norm of g = 0.4734
expanding trust region radius
gamma = 0.0597
weights are updated
------------------------------------------------------------
iteration: 275
LOSS     - train: 0.0784, test: 0.0572
ACCURACY - train: 0.9758, test: 0.9827
norm of g = 0.3661
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 276
LOSS     - train: 0.0518, test: 0.0578
ACCURACY - train: 0.9808, test: 0.9824
norm of g = 0.4153
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 277
LOSS     - train: 0.0571, test: 0.0590
ACCURACY - train: 0.9875, test: 0.9818
norm of g = 0.3836
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 278
LOSS     - train: 0.0537, test: 0.0564
ACCURACY - train: 0.9883, test: 0.9826
norm of g = 0.3554
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 279
LOSS     - train: 0.0534, test: 0.0668
ACCURACY - train: 0.9825, test: 0.9789
norm of g = 0.6114
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 280
LOSS     - train: 0.0482, test: 0.0547
ACCURACY - train: 0.9850, test: 0.9832
norm of g = 0.4116
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 281
LOSS     - train: 0.0464, test: 0.0550
ACCURACY - train: 0.9867, test: 0.9821
norm of g = 0.2848
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 282
LOSS     - train: 0.0531, test: 0.0538
ACCURACY - train: 0.9875, test: 0.9831
norm of g = 0.3738
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 283
LOSS     - train: 0.0471, test: 0.0541
ACCURACY - train: 0.9875, test: 0.9839
norm of g = 0.2873
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 284
LOSS     - train: 0.0469, test: 0.0556
ACCURACY - train: 0.9850, test: 0.9826
norm of g = 0.4269
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 285
LOSS     - train: 0.0759, test: 0.0606
ACCURACY - train: 0.9792, test: 0.9814
norm of g = 0.6415
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 286
LOSS     - train: 0.0594, test: 0.0557
ACCURACY - train: 0.9817, test: 0.9831
norm of g = 0.3154
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 287
LOSS     - train: 0.0554, test: 0.0574
ACCURACY - train: 0.9867, test: 0.9826
norm of g = 0.4064
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 288
LOSS     - train: 0.0671, test: 0.0550
ACCURACY - train: 0.9800, test: 0.9833
norm of g = 0.5759
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 289
LOSS     - train: 0.0445, test: 0.0567
ACCURACY - train: 0.9900, test: 0.9828
norm of g = 0.3271
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 290
LOSS     - train: 0.0521, test: 0.0600
ACCURACY - train: 0.9833, test: 0.9825
norm of g = 0.4655
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 291
LOSS     - train: 0.0564, test: 0.0579
ACCURACY - train: 0.9825, test: 0.9829
norm of g = 0.6062
no need for safe gaurding
gamma = 1.0000
weights are updated
------------------------------------------------------------
iteration: 292
LOSS     - train: 0.0447, test: 0.0584
ACCURACY - train: 0.9875, test: 0.9806
norm of g = 0.3616
gamma = 0.5367
weights are updated
------------------------------------------------------------
iteration: 293
LOSS     - train: 0.0424, test: 0.0545
ACCURACY - train: 0.9833, test: 0.9828
norm of g = 0.3479
expanding trust region radius
gamma = 0.5279
weights are updated
------------------------------------------------------------
iteration: 294
LOSS     - train: 0.0473, test: 0.0550
ACCURACY - train: 0.9892, test: 0.9833
norm of g = 0.3126
gamma = 0.4187
weights are updated
------------------------------------------------------------
iteration: 295
LOSS     - train: 0.0385, test: 0.0612
ACCURACY - train: 0.9883, test: 0.9814
norm of g = 0.3628
gamma = 0.4558
weights are updated
------------------------------------------------------------
iteration: 296
LOSS     - train: 0.0459, test: 0.0621
ACCURACY - train: 0.9858, test: 0.9805
norm of g = 0.5985
gamma = 0.5620
weights are updated
------------------------------------------------------------
iteration: 297
LOSS     - train: 0.0517, test: 0.0698
ACCURACY - train: 0.9842, test: 0.9792
norm of g = 0.5612
gamma = 0.6749
weights are updated
------------------------------------------------------------
iteration: 298
LOSS     - train: 0.0936, test: 0.0763
ACCURACY - train: 0.9758, test: 0.9738
norm of g = 0.8895
gamma = 0.7286
weights are updated
------------------------------------------------------------
iteration: 299
LOSS     - train: 0.0923, test: 0.0732
ACCURACY - train: 0.9700, test: 0.9775
norm of g = 1.1157
gamma = 0.4776
weights are updated
------------------------------------------------------------
iteration: 300
LOSS     - train: 0.0788, test: 0.0836
ACCURACY - train: 0.9775, test: 0.9743
norm of g = 1.0417
reached to the max num iteration -- BREAK
